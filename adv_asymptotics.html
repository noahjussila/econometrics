<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Advanced Econometrics with Examples - 6&nbsp; Advanced Asymptotics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ols.html" rel="next">
<link href="./stochastic.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./estimators.html">Statistical Theory</a></li><li class="breadcrumb-item"><a href="./adv_asymptotics.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Asymptotics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Econometrics with Examples</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preliminaries</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Statistical Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Finite Sample Properties of Estimators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asymptotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Asymptotic Properties of Estimators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exp_fam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Exponential Families</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stochastic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Stochastic Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./adv_asymptotics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Asymptotics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The Classical Linear Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./endog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Endogeniety I: IV and 2SLS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Generalized Least Squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simul.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Endogeniety II: Simultaneity and Multiple Regressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Estimation Frameworks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./extremum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Extremum Estimators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Generalized Method of Moments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Maximum Likelihood Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Basic Microeconometrics and Time Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./binary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Binary Choice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./panel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Panel Data I: The Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Basic Time Series</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonpar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonparametrics I: Distribution and Density Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonpar_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Nonparametrics II: Functional Forms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./semipar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Semiparametrics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sieve.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Sieve Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./partial_id.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Partial Identification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./endog_nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Endogeniety III: Nonlinear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./weak_inst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Endogeniety IV: Weak Instruments</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Microeconometrics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete_choice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Discrete Choice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tobit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Tobit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Count Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Mixed and Multilevel Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./panel2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Panel Methods II</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Time Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Math Review</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Causal Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causal1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Potential Outcomes Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Matching Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rdd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Regression Discontinuity Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./did.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Difference in Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LATE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Non-Compliance and LATE</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hetero.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Heterogeneous Treatment Effects</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">More Statistical Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Bayesian Estimation I: Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Bayesian Estimation II: Computation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Bayesian Estimation III: Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelselection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./robust.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Robust Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./learning_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Statistical Learning Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Supervised Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Dimmension Reduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Unsupervised Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Text Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ML meets Causal Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#reviewing-more-probability-theory" id="toc-reviewing-more-probability-theory" class="nav-link active" data-scroll-target="#reviewing-more-probability-theory"><span class="header-section-number">6.1</span> Reviewing More Probability Theory</a></li>
  <li><a href="#convergence" id="toc-convergence" class="nav-link" data-scroll-target="#convergence"><span class="header-section-number">6.2</span> Convergence</a></li>
  <li><a href="#sec-dist" id="toc-sec-dist" class="nav-link" data-scroll-target="#sec-dist"><span class="header-section-number">6.3</span> Convergence in Distribution</a></li>
  <li><a href="#application-empirical-process-theory" id="toc-application-empirical-process-theory" class="nav-link" data-scroll-target="#application-empirical-process-theory"><span class="header-section-number">6.4</span> Application: Empirical Process Theory</a>
  <ul class="collapse">
  <li><a href="#glivenkocantelli-theorem" id="toc-glivenkocantelli-theorem" class="nav-link" data-scroll-target="#glivenkocantelli-theorem"><span class="header-section-number">6.4.1</span> Glivenko–Cantelli Theorem</a></li>
  <li><a href="#donskers-theorem" id="toc-donskers-theorem" class="nav-link" data-scroll-target="#donskers-theorem"><span class="header-section-number">6.4.2</span> Donsker’s Theorem</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing"><span class="header-section-number">6.4.3</span> Hypothesis Testing</a></li>
  </ul></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">6.5</span> Further Reading</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./estimators.html">Statistical Theory</a></li><li class="breadcrumb-item"><a href="./adv_asymptotics.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Asymptotics</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Asymptotics</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="#sec-asy" class="quarto-xref"><span class="quarto-unresolved-ref">sec-asy</span></a> provided a crash course in asymptotic statistics that can get you pretty far in econometrics. Still there are certain situations where we need a more abstract and general understanding of stochastic convergence. The purpose of this chapter is to give a painfully brief introduction to the convergence of random variables defined on metric spaces, and discuss some of the related applications.</p>
<section id="reviewing-more-probability-theory" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="reviewing-more-probability-theory"><span class="header-section-number">6.1</span> Reviewing More Probability Theory</h2>
<p>Given a probability space <span class="math inline">\((\mathcal X, \mathcal F, P)\)</span> and a set <span class="math inline">\(E\)</span> equipped with a sigma-algebra <span class="math inline">\(\mathcal E\)</span>, a random variable is some function <span class="math inline">\(X:\mathcal X\to E\)</span> such that <span class="math inline">\(X^{-1}(I) \in \mathcal F\)</span> for all <span class="math inline">\(I\in \mathcal E\)</span>. Until now, we’ve only dealt with the case <span class="math inline">\(E = \mathbb{R}\)</span> and <span class="math inline">\(\mathcal E = \mathcal B(\mathbb{R})\)</span>, so let’s look at random variables on other spaces. In particular, we’re interested in random variables defined on metric spaces.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.1 (Random Vectors)</strong></span> We’ve been interpreting a random vector <span class="math inline">\(\mathbf{X}= (X_1,\ldots,X_n)\)</span> as a collection of <span class="math inline">\(n\)</span> random scalars <span class="math inline">\(X_1:\mathcal X_1\to E_1,\ldots,X_n:\mathcal X_n\to E_n\)</span>. Alternatively, we could consider <span class="math inline">\(\mathbf{X}\)</span> to be a random variable mapping <span class="math inline">\(\mathcal X_1\times\cdots\times \mathcal X_n\)</span> to <span class="math inline">\(E^n\)</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> A special case of this is when we draw a sample of <span class="math inline">\(n\)</span> observations of <span class="math inline">\(X_i \overset{iid}{\sim}F_X\)</span>. If we execute <code>rnorm(10)</code>, it will return <span class="math inline">\(n\)</span> realizations of <span class="math inline">\(X:\mathbb{R}\to\mathbb{R}\)</span> which can also be interpreted as one realization of a random vector <span class="math inline">\(\mathbf{X}:\mathbb{R}^{10}\to\mathbb{R}^{10}\)</span>. Whether you think of the resulting data as 10 realizations of iid random variables or a single random vector will depend on the application. It’s usually easier to model problems with random vectors when random scalars aren’t iid. If we have <span class="math inline">\(X_1 \sim N(0,1)\)</span>, <span class="math inline">\(X_2 \sim N(1,2)\)</span>, and <span class="math inline">\(\text{Cov}\left(X_1, X_2\right) = 1\)</span>, then all the information about <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> can easily be summarized by <span class="math inline">\(\mathbf{X}= (X_1,X_2)\)</span> where <span class="math display">\[\mathbf{X}\sim N\left(\begin{bmatrix} 0\\ 1\end{bmatrix}, \begin{bmatrix} 1 &amp; 1\\ 1 &amp; 2\end{bmatrix}\right)\]</span></p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.2 (Random Matrices)</strong></span> We can combine random vectors into a single random matrix just like we combined random scalars into a random vector. For the sake of ease, we’ll only consider real valued random vectors here. Suppose we have <span class="math inline">\(k\)</span> random vectors <span class="math inline">\(\mathbf{X}_1,\ldots,\mathbf{X}_k\)</span>, each of length <span class="math inline">\(n\)</span>. We can form a <span class="math inline">\(n\times k\)</span> matrix using these vectors as column vectors. We’ll denote this random matrix with <span class="math inline">\(\mathbb{X}\)</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span class="math display">\[\mathbb{X}= \begin{bmatrix}\mathbf{X}_1 &amp; \cdots &amp;\mathbf{X}_k \end{bmatrix} =  \begin{bmatrix}X_{11} &amp; \cdots &amp;X_{k1} \\ \vdots &amp; \ddots &amp; \vdots\\ X_{1n} &amp; \cdots &amp;X_{kn} \end{bmatrix}\]</span> In this case, the random variable <span class="math inline">\(\mathbb{X}\)</span> takes on a value in the set of all <span class="math inline">\(n\times k\)</span> real matrices, <span class="math inline">\(\mathbb{R}^{n\times k}\)</span>. We could also consider <span class="math inline">\(\mathbb{X}\)</span> to be comprised of <span class="math inline">\(n\)</span> random vectors of length <span class="math inline">\(k\)</span>. <span class="math display">\[ \mathbb{X}= \begin{bmatrix}\mathbf{X}_1\\ \vdots \\ \mathbf{X}_k \end{bmatrix}.\]</span> This interpretation is particularly important when considering regression models where we observe <span class="math inline">\(n\)</span> realizations of <span class="math inline">\(k\)</span> regressors <span class="math inline">\(X_1,\ldots,X_k\)</span>.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A random object we’ve yet to talk about are stochastic processes. These will make for an excellent example in abstracting random variables beyond <span class="math inline">\(\mathbb{R}\)</span>.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.1</strong></span> Given a probability space <span class="math inline">\((\mathcal X, \mathcal F, P)\)</span>, suppose we have a collection of random variables <span class="math inline">\(\{X_t\}_{t\in T}\)</span> indexed by some set <span class="math inline">\(T\)</span> which take on values in the measurable space <span class="math inline">\((S, \mathcal S)\)</span>. The collection <span class="math inline">\(\{X_t\}_{t\in T}\)</span> is a <span style="color:red"><strong><em>stochastic process</em></strong></span>. We refer to <span class="math inline">\(S\)</span> as the <span style="color:red"><strong><em>state space</em></strong></span> and <span class="math inline">\(T\)</span> as the <span style="color:red"><strong><em>index set</em></strong></span>. If <span class="math inline">\(T = \mathbb N\)</span> then <span class="math inline">\(\{X_t\}_{t\in T}\)</span> is a <span style="color:red"><strong><em>discrete-time stochastic process</em></strong></span>. If <span class="math inline">\(T = \mathbb{R}^+\)</span> <span style="color:red"><strong><em>continuous-time stochastic process</em></strong></span></p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The index set is almost always denoted by <span class="math inline">\(T\)</span> because the main application of stochastic processes is modeling the evolution of random phenomena over time periods <span class="math inline">\(t\in T\)</span>. Each value <span class="math inline">\(t\in T\)</span> is mapped to a random variable <span class="math inline">\(X_t\)</span>, which takes on a realized value <span class="math inline">\(X_t(\omega)\in S\)</span> for some outcome <span class="math inline">\(\omega\in\mathcal X\)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Since <span class="math inline">\(X_t\)</span> is indexed by <span class="math inline">\(T\)</span>, we can actually think of a stochastic process as a function <span class="math inline">\(t\mapsto X_t\)</span>, and opt to write <span class="math inline">\(X(t)\)</span> or <span class="math inline">\(X(t,\omega)\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> This interpretation is how we’ll be able to define a stochastic process as a random variable.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.3 (Stochastic Processes as RVs)</strong></span> Given a state space <span class="math inline">\(S\)</span> and an index set <span class="math inline">\(T\)</span>, consider the set <span class="math inline">\(S^T\)</span> of all functions mapping <span class="math inline">\(T\)</span> to <span class="math inline">\(S\)</span>. A stochastic process <span class="math inline">\(\{X_t\}_{t\in T}\)</span> defined on the probability space <span class="math inline">\((\mathcal X, \mathcal F, P)\)</span> is a random variable <span class="math inline">\(X:\mathcal X\to S^T\)</span>. One realization of <span class="math inline">\(X(\omega)\in S^T\)</span> is a function from <span class="math inline">\(T\)</span> to <span class="math inline">\(S\)</span>. In the event that <span class="math inline">\(T =\mathbb N\)</span>, <span class="math inline">\(S^\mathbb N\)</span> is the set of sequences in <span class="math inline">\(S\)</span>, as a sequence in <span class="math inline">\(S\)</span> is just a function which assigns natural numbers to the elements of <span class="math inline">\(S\)</span>. This means that <span class="math inline">\(X:\mathcal X\to S^{\mathbb N}\)</span> is a random sequence. We often refer to realizations of stochastic processes as sample paths to emphasize the additional dimension given by <span class="math inline">\(T\)</span>.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.4 (Simple Random Walk)</strong></span> Suppose we have a sequence of iid random variables <span class="math inline">\(Y_1,Y_2,\ldots\)</span> defined on the sample space <span class="math inline">\(\{-1,1\}\)</span> such that <span class="math inline">\(\Pr(Y_t = 1) = p\)</span> and <span class="math inline">\(\Pr(Y_t = -1) = 1-p\)</span> for all <span class="math inline">\(t\)</span>. We can think of <span class="math inline">\(Y_t\)</span> as a modified Bernoulli random variable where a “failure” corresponds to the value <span class="math inline">\(-1\)</span> instead of <span class="math inline">\(0\)</span>.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> Using the sequence <span class="math inline">\(Y_t\)</span> we can define a new sequence of random variables <span class="math inline">\(X_t\)</span> as <span class="math display">\[ X_t = \sum_{i=1}^t Y_i.\]</span> The sequence <span class="math inline">\(X_n\)</span> is a random walk. The name is due to a thought experiment corresponding to <span class="math inline">\(Y_n\)</span> and <span class="math inline">\(X_n\)</span>. Suppose someone is standing at a reference point (the origin <span class="math inline">\(0\)</span>) at time <span class="math inline">\(t=0\)</span>. At <span class="math inline">\(t=1\)</span> they flip a coin. If the flip results in a head they will take one step forward, but if the flip results in a tail they will take a step backwards. This is repeated for <span class="math inline">\(t=2,3,\ldots\)</span>. The outcome of the coin flip at time <span class="math inline">\(t\)</span> corresponds to the random variable <span class="math inline">\(Y_t\)</span>. At any time <span class="math inline">\(t\)</span>, the person’s position relative to the reference points is given as <span class="math inline">\(X_t\)</span>. Instead of considering <span class="math inline">\(X_1,X_2,\ldots\)</span> to be a sequence of separate random variables, we can think of <span class="math inline">\(X=(X_1,X_2,\ldots)\)</span> to be a single random variable defined on the space <span class="math inline">\(\mathbb Z^{\mathbb N}\)</span>. Let’s look at one realized value of <span class="math inline">\(X\)</span> taking <span class="math inline">\(p = 1/2\)</span>,<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> in which case our random walk is symmetric.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-2_b604bd020d0dd929c0b97a5bfccf1f14">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>random_walk <span class="ot">&lt;-</span> <span class="cf">function</span>(n, dist, dist_params, t){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">step =</span> X) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">time =</span> <span class="fu">row_number</span>(),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">cumsum</span>(step),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> t</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">time =</span> <span class="dv">0</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="dv">0</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> t,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">.before =</span> <span class="dv">0</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>rredmacher <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p){</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p, p)))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">random_walk</span>(<span class="dv">20</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>), <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1" data-hash="adv_asymptotics_cache/html/fig-plot51_b623cf29183d6472b156e1eba22009fe">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>iter_num) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>time) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"step"</span>, <span class="st">"position"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Step Y_t"</span>, <span class="st">"Position X_t"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(time, <span class="at">transition_length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>() <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time, t"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot51" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot51-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot51-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot51-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: One simulated realization of a random walk
</figcaption>
</figure>
</div>
</div>
</div>
<p>Since this is just one realization, it’s analogous to illustrating a random variable with a standard normal distribution with a histogram of a single value generated by <code>rnorm(n = 1)</code>. Let’s look at 1,000 simulated realizations of our random walk <span class="math inline">\(X=(X_1,X_2,\ldots)\)</span>.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-4_6855b9b7014fce8bb64dcca6bbc138e4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(N, n, dist, dist_params){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span>  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(random_walk, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e3</span>, <span class="dv">20</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot52_273ae606b4930bfb85e8fc56d91f69f6">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">factor</span>(iter_num))) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Position"</span>) </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot52" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot52-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot52-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot52-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: 1,000 simulated realizations of the random walk.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can also investigate the individual terms of the random sequence <span class="math inline">\(X = (X_1,X_2,\ldots)\)</span> by treating them like their own random variables defined on <span class="math inline">\(\mathbb Z\)</span>. For 100,000 simulated realizations of <span class="math inline">\(X\)</span>, let’s look at the distribution of the realized values of <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_{10}\)</span>, <span class="math inline">\(X_{20}\)</span>, and <span class="math inline">\(X_{30}\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-6_978bfa3a7c2d6f241f6dbf0b28d1fa19">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e5</span>, <span class="dv">30</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot53_783c7e1e0b087e49d7cc204b292bbbb5">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, position) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fl">1e5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"t = 1"</span>, <span class="st">"t =10"</span>, <span class="st">"t = 20"</span>, <span class="st">"t = 30"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(position, freq)) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">xend =</span> position, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> freq)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>time) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"position"</span>, <span class="at">y =</span> <span class="st">"frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot53" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot53-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot53-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot53-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: Distribution of simulated positions at various times.
</figcaption>
</figure>
</div>
</div>
</div>
<p>It is no coincidence that as <span class="math inline">\(t\)</span> increases, the distribution of <span class="math inline">\(X_t\)</span> appears to resemble a normal distribution. To show this we’ll need to find the probability mass function of <span class="math inline">\(X_t\)</span> which gives <span class="math inline">\(\Pr(X_t = x)\)</span> for <span class="math inline">\(x\in\{-t,-t+1,\ldots,t-1,t\}\subset \mathbb Z\)</span>. First note that the probability that <span class="math inline">\(k\)</span> steps forward and <span class="math inline">\(t-k\)</span> steps backwards are taken follows a binomial distribution, since <span class="math inline">\(I(Y_i = 1)\sim \text{Ber}(p)\)</span>. <span class="math display">\[ \Pr(\textstyle\sum_{i=1}^t I(Y_i = 1)) = \binom{t}{k}p^k(1-p)^{t-k}\]</span> We can write the number of steps forward <span class="math inline">\(k\)</span> in position <span class="math inline">\(x\)</span> by noting that <span class="math inline">\(x = k - (t-k) = 2k-t,\)</span> so <span class="math inline">\(k = (t+x)/2\)</span>. <span class="math display">\[f_{X_t}(x \mid t, p) = \binom{t}{(t+x)/2}p^{(t+x)/2}(1-p)^{t-(t+x)/2}.\]</span> Since <span class="math inline">\(X_t\)</span> follows a variant of the binomial distribution, as <span class="math inline">\(t\to\infty\)</span> the normal approximation of the binomial distribution holds with increasing accuracy. The parameters of this normal distribution are given by the expected value and variance of <span class="math inline">\(X_t\)</span>. These are <span class="math display">\[\begin{align*}
\text{E}\left[X_t\right] &amp;= \text{E}\left[\sum_{i=1}^t Y_i\right] \\&amp;= \sum_{i=1}^t \text{E}\left[Y_i\right] &amp; (\text{E}\left[\cdot\right]\text{ linear})\\ &amp;= t\left[p\cdot 1 + (1-p)(-1) \right] &amp; (Y_i\text{ iid})\\ &amp; = t(2p-1)\\
\text{Var}\left(X_t\right) &amp;= \text{Var}\left(\sum_{i=1}^t Y_i\right)\\
        &amp; = \sum_{i=1}^t \text{Var}\left(Y_i\right) &amp; (Y_i\text{ iid})\\
        &amp; = t\left[\text{E}\left[Y_i^2\right] - \text{E}\left[Y_i\right]^2\right] \\
        &amp; = t[1 - (2p-1)^2] &amp; (Y_i^2 = 1)\\
        &amp; = 4tp(1-p)
\end{align*}\]</span> If <span class="math inline">\(p = 1/2\)</span> and <span class="math inline">\(t = 100\)</span>, we should expect that the distribution of <span class="math inline">\(X_t\)</span> resembles <span class="math inline">\(N(0,100)\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-8_d36bb37a38a7617a8934e80baa290e38">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e5</span>, <span class="dv">100</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">==</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot54_8e87097c72e646c526db07d921a3d55b">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(position)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">colour =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">binwidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> t<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>p <span class="sc">-</span> <span class="dv">1</span>), <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">*</span>t<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">x =</span> <span class="st">"Random Walk Position at t=100"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot54" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot54-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot54-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot54-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: Position of random walk at time t=100 for 100,000 simulations with a normal distribution with µ=0 and σ=10 overlaid.
</figcaption>
</figure>
</div>
</div>
</div>
<p>This entire examples happens to be just one very stylized example of a random walk. There exists numerous interesting extensions with valuable applications.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.5 (Wiener Process)</strong></span> The most famous random function is the the Wiener process. This continuous-time stochastic process plays a key role in physics as it’s a mathematical formalization of Brownian motion.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> Brownian motion refers to the behavior of particles that are continuously moving randomly about. For instance, gas molecules move rapidly about colliding with other molecules, resulting in seemingly random movement. Formally, the Weiner process <span class="math inline">\(W = \{W_t\}_{t\in \mathbb{R}^+}\)</span> is a random variable <span class="math inline">\(W:\mathcal X\to C( \mathbb{R}^+)\)</span> for some probability space <span class="math inline">\((\mathcal X, \mathcal F, P)\)</span> where <span class="math inline">\(C( \mathbb{R}^+)\)</span> is the set of all real continuous functions defined on the unit interval $ ^+$.process <span class="math inline">\(\{W_t\}_{t\in \mathbb{R}^+}\)</span> satisfies:</p>
<ol type="1">
<li><span class="math inline">\(W_0 = 0\)</span>. The process’ initial value at time <span class="math inline">\(t=0\)</span> is always <span class="math inline">\(0\)</span>.</li>
<li>For all <span class="math inline">\(t\in \mathbb{R}^+\)</span>, <span class="math inline">\(W_{t+u} - W_t \perp W_s\)</span> for <span class="math inline">\(u \ge 0\)</span> and <span class="math inline">\(s &lt; t\)</span>. The process has independent increments. In other words, the “movement” of the process between times <span class="math inline">\(t\)</span> and <span class="math inline">\(t+u\)</span> is independent of the processes location prior to <span class="math inline">\(t\)</span> (at time <span class="math inline">\(s\)</span>). Another way to think of this property is that the process is “memoryless” in the sense that future movement of the process only depends on its current position and not how it got to that position.</li>
<li>For all <span class="math inline">\(t\in \mathbb{R}^+\)</span>, <span class="math inline">\(W_{t+u}-W_t\sim N(0,u)\)</span> for <span class="math inline">\(u \ge 0\)</span>. This is equivalent to <span class="math inline">\(W_t - W_s \sim N(0,t-s)\)</span> for <span class="math inline">\(s\le t\)</span>, which can also be written as <span class="math inline">\(W_t-W_s\sim \sqrt{t-s}\cdot N(0,1)\)</span></li>
</ol>
<p>A fourth property that we’ve implicitly assumed by defining <span class="math inline">\(W\)</span> to be a <span class="math inline">\(C( \mathbb{R}^+)\)</span>-valued random variable is that <span class="math inline">\(W\)</span> is continuous. <em>A priori</em>, it isn’t obvious that there exists a process which satisfies all of these properties, but we will take its existence as given.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<p>One of the limitations of turning to simulations to illlustrate <span class="math inline">\(W\)</span> is that we aren’t able to graph a truly continuous (non-linear) function on a computer.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> You may be thinking” “well no duh, this is obvious! Why are you bringing up something so basic and trivial?” It’s worth emphasizing because this entire example is meant to illustrate a continuous stochastic process, which unfortunately we need to do by simulating a discrete analog. Suppose we have <span class="math inline">\(N\)</span> evenly spaced points in <span class="math inline">\([0,1]\)</span>, such that time increments are <span class="math inline">\(dt = 1/N\)</span>. We have <span class="math display">\[\begin{align*}
W_0 &amp; = 0,\\
W_j &amp; = W_{j-1} + dW_{j}, &amp; (j = 1,\ldots, N)\\
dW_j &amp; \overset{iid}{\sim}N(0, dt).
\end{align*}\]</span> We’ll set <span class="math inline">\(N = 1\times10^7\)</span>, which is such a large value that we’ll be able to just treat <span class="math inline">\(W\)</span> as if it was truly continuous. Let’s simulate a single realization of <span class="math inline">\(W\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-10_55b1925da6d419e30aaf91d78dfbfc49">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw one realization of wiener process</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   N = number of discrete points to calculate process at</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   T_max = maximum time value to calculate process at</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   s = parameter to iterate over if we want to draw multiple realizations</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>wiener <span class="ot">&lt;-</span> <span class="cf">function</span>(N, T_max, s){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> T_max<span class="sc">/</span>N</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">dW =</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> <span class="fu">sqrt</span>(dt)),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">seq</span>(dt, T_max, dt),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">cumsum</span>(dW)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">value =</span> <span class="dv">0</span>, <span class="at">time =</span> <span class="dv">0</span>, <span class="at">iter_num =</span> s, <span class="at">.before =</span> <span class="dv">0</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">wiener</span>(<span class="fl">1e5</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot55_3e5d2ef8e9f316a0fbf461b16395bad7">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">"Value of W at t"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot55" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot55-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot55-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot55-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.5: One realization of the Wiener process on the unit interval [0,1].
</figcaption>
</figure>
</div>
</div>
</div>
<p>Since <span class="math inline">\(W\)</span> is continuous it’s defined for all values in the interval <span class="math inline">\([0,1]\)</span>, so we can “zoom” in on increasingly small subsets of <span class="math inline">\([0,1]\)</span>, and <span class="math inline">\(W\)</span> will still be defined for all <span class="math inline">\(t\)</span>.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<div class="cell" data-layout-align="center" data-fig.asp="1" data-hash="adv_asymptotics_cache/html/fig-plot56_3835cc828477f5114a3e5b28134b5fd8">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>zoom_in <span class="ot">&lt;-</span> <span class="cf">function</span>(W, t){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(time <span class="sc">&lt;=</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_time =</span> t,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">zoom_factor =</span> <span class="dv">1</span><span class="sc">/</span>t</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(zoom_in, <span class="at">W =</span> results) <span class="sc">%&gt;%</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(zoom_factor) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view_follow</span>() <span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">"Value of W at t"</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">nframes =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot56" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot56-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot56-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot56-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.6: ``Zooming in’’ on the Wiener process.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that as we “zoom in” the sample path has the same jagged appearance of <span class="math inline">\(W\)</span> on all of <span class="math inline">\([0,1]\)</span>. This is because the Wiener process is closely linked to the idea of a fractal.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> Another interesting feature is that <span class="math inline">\(W\)</span> is nowhere differentiable despite being continuous on account of it being comprised of an infinite number of “kinks”.</p>
<p>Now that we’ve seen one sample path, let’s draw 100 realizations of <span class="math inline">\(W\)</span> to get a sense of the relative frequency of certain paths.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-13_fd78a3de2372ab2f1d598aac25ead5a2">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>draw_wiener <span class="ot">&lt;-</span> <span class="cf">function</span>(M, N, T_max){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(wiener, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener</span>(<span class="fl">1e2</span>, <span class="fl">1e4</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot57_039ca30ccf188a398cef27703bcf75a3">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot57" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot57-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot57-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot57-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.7: 1,000 simulated realizations of the Wiener process
</figcaption>
</figure>
</div>
</div>
</div>
<p>Another way to visualize these realizations is by looking at the distribution of the simulated values of <span class="math inline">\(W\)</span> at various values of <span class="math inline">\(t\)</span>. Since <span class="math inline">\(W_t - W_s \sim N(0, t-s)\)</span> and <span class="math inline">\(W_0 = 0\)</span>, we should expect that <span class="math display">\[W_t = W_t - 0  = W_t - W_0 \sim N(0,t-0) = N(0,t).\]</span></p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-15_4a170a0d8ea1a3b9d30e62dfc7a5a2e7">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw one realization of wiener process at times t (approximately)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>wiener_t <span class="ot">&lt;-</span> <span class="cf">function</span>(N, T_max, t, s){ </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">wiener</span>(N, T_max, s)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pick the values where W_t is calculated that are closest to the times of interest</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  t_filter <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand_grid</span>(<span class="at">given_t =</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dist =</span> <span class="fu">abs</span>(time <span class="sc">-</span> given_t)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(given_t) <span class="sc">%&gt;%</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dist <span class="sc">==</span> <span class="fu">min</span>(dist)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>()</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(time <span class="sc">%in%</span> t_filter) <span class="sc">%&gt;%</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>dW)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw M realizations of wiener process at vector of times t_vals</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>draw_wiener_t <span class="ot">&lt;-</span> <span class="cf">function</span>(M, t, T_max, N){</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(wiener_t, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max, <span class="at">t =</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(<span class="fl">1e5</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1" data-hash="adv_asymptotics_cache/html/fig-plot58_2a54b7ee77c92ea08ba65ab300fafb54">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> time, <span class="at">group =</span> time)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges2</span>(<span class="at">scale =</span> <span class="dv">5</span>, <span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">rel_min_height =</span> <span class="fl">0.007</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"W_t"</span>, <span class="at">y =</span> <span class="st">"Time t"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample Mean'</span> <span class="ot">=</span> <span class="fu">mean</span>(value),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample Variance'</span> <span class="ot">=</span> <span class="fu">var</span>(value)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>time) <span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">label=</span> <span class="st">"Var(W_t) = t"</span>) <span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label=</span> <span class="st">"E[W_t] = 0"</span>) <span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot58" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot58-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot58-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot58-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.8: The top panel shows the density of the Wiener process at 10 fixed times calculated using 100,000 simulations. The bottom panel shows the sample analogs of expectation and variance for the process calculated at the fixed times, along with the theoretical values for comparison.
</figcaption>
</figure>
</div>
</div>
</div>
<p>For further confirmation that <span class="math inline">\(W_t - W_s \sim N(0, t-s)\)</span>, let’s calculate the sample variance associated with our realizations of <span class="math inline">\(W_t - W_s\)</span> for all <span class="math inline">\(s,t\in[0.1, 0.2,\ldots,0.9,1]\)</span> satisfying <span class="math inline">\(s \le t\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-17_547ea0163e2a9e92842df183c3547151">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For a grid of time values, calculate var_st at each point {(s,t) ∈ t_grid² | s ≤ t} over M simulations</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(M, t_grid, T_max, N){</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define function to calculate variance</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  var_st <span class="ot">&lt;-</span> <span class="cf">function</span>(W, s, t){</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(t <span class="sc">==</span> s){</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(s,t)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(iter_num) <span class="sc">%&gt;%</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">diff =</span> value <span class="sc">-</span> <span class="fu">lag</span>(value, <span class="at">order_by =</span> time)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarize</span>(<span class="fu">var</span>(diff, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(output)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># draw M realizations of W at grid of times</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(M, t_grid, T_max, N)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply var_st to all combinations of times</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">unique</span>(W<span class="sc">$</span>time),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">unique</span>(W<span class="sc">$</span>time)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(s <span class="sc">&lt;=</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">var =</span> <span class="fu">var_st</span>(W, s, t))</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e5</span>, (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot59_3f4910d3bd26edd209067fa97f674a02">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(s,t, <span class="at">fill =</span> var)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">lwd =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(var,<span class="dv">3</span>)), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Var(W_t - W_s)"</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.line =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot59" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot59-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot59-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot59-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.9: The sample variance associated with W_t - W_s calculated using 100,000 simulations.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We have <span class="math inline">\(\widehat{\text{Var}}(W_t-W_s) \approx t-s\)</span> as anticipated! Finally, we can provide visual evidence that <span class="math inline">\(W_{t+u} - W_t \perp W_s\)</span> for <span class="math inline">\(u \ge 0\)</span> and <span class="math inline">\(s &lt; t\)</span>. We’ll let <span class="math inline">\(t = 0.3\)</span>, <span class="math inline">\(u=0.1\)</span>, and <span class="math inline">\(s = 0.2\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-19_e24a241bcea5e12f85a7f9399151055d">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(<span class="fl">1e5</span>, (<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot595_dee1e3844ec9cbefbf15fe83c02a88a9">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.4</span>] <span class="sc">-</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.3</span>],</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.2</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"W_4 - W_3"</span>, <span class="at">y =</span> <span class="st">"W_2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot595" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot595-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot595-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot595-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.10: 100,000 realized values of (W_4 - W_3) plotted against the corresponding 100,000 realized values of W_2.
</figcaption>
</figure>
</div>
</div>
</div>
<p>From this figure, the two random variables certainly appear to be independent.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Wiener process is just one instance of a stochastic process that “looks like” a normal distribution at specific points <span class="math inline">\(t\in T\)</span>. These types of processes are so special that they are simply known as Gaussian.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.2</strong></span> Let <span class="math inline">\(\{X_t\}_{t\in T}\)</span> be a stochastic process over the state space <span class="math inline">\(\mathbb{R}\)</span>. The process is a <span style="color:red"><strong><em>Gaussian process</em></strong></span> if for any finite set of indices <span class="math inline">\(t_1,\ldots,t_k\in T\)</span>, the random vector <span class="math inline">\(\mathbf{X}= (X_{t_1},\ldots, X_{t_k})\)</span> is distributed according to a multivariate normal distribution.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The defining properties of the Wiener process immediately establish it as a Gaussian process. To find the explicit normal distribution referenced in the definition of a Gaussian process we need to calculate the covariance of <span class="math inline">\(W_t\)</span> and <span class="math inline">\(W_s\)</span>. <span class="math display">\[\begin{align*}
\text{Cov}\left(W_t,W_s\right) &amp;= \begin{cases} \text{Cov}\left(W_t-0, W_s\right) &amp; t &gt; s\\ \text{Cov}\left(W_t, W_s + 0\right) &amp; s\le t \end{cases} \\&amp;= \begin{cases} \text{Cov}\left(W_t-W_s+W_s, W_s\right) &amp; t &gt; s\\ \text{Cov}\left(W_t, W_s + W_t- W_t\right) &amp; s\le t\end{cases}\\
&amp;= \begin{cases} \text{Cov}\left(W_t-W_s, W_s\right)+\text{Cov}\left(W_s,W_s\right) &amp; t &gt; s\\ \text{Cov}\left(W_t, W_s-W_t\right) + \text{Cov}\left(W_t,W_t\right)&amp; s\le t \end{cases}\\
&amp; = \begin{cases} 0 + \text{Var}\left(W_s\right) &amp; t &gt; s\\ 0 + \text{Var}\left(W_t\right)&amp; s\le t \end{cases} &amp; (\text{independent increments})\\
&amp; = \begin{cases} s &amp; t &gt; s\\ t&amp; s\le t \end{cases}\\
&amp; = \min\{s,t\}
\end{align*}\]</span> Therefore, for any <span class="math inline">\(\mathbf W = (W_{t_1},\ldots, W_{t_k})\)</span> where <span class="math inline">\(t_1,\ldots,t_k \in [0,T]\)</span> we have <span class="math display">\[\begin{align*}
\mathbf W &amp;\sim N(\mathbf{0},\boldsymbol{\Sigma}),\\
\boldsymbol{\Sigma}_{j\ell}&amp;=\begin{cases}t_j &amp; j = \ell \\ \min\{t_j,t_{\ell}\} &amp; \text{otherwise} \end{cases}.
\end{align*}\]</span></p>
<p>Let’s look at another example of a Gaussian process by tweaking the Wiener process.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.6 (Brownian Bridge)</strong></span> A process closely related to the Wiener Process is a Brownian bridge. For all intents and purposes, a Brownian bridge is a Wiener-like process which “bridges” two points <span class="math inline">\(a,b\in \mathbb{R}\)</span> on on the interval <span class="math inline">\([0,T]\)</span>. The simplest form of the Brownian bridge has <span class="math inline">\(a=b=0\)</span>, and is defined via conditioning as <span class="math display">\[ B(t)  = (W(t) \mid W(T) = 0)\]</span> for <span class="math inline">\(t\in [0,T]\)</span>. This is often called the “standard” Brownian bridge, and often has <span class="math inline">\(T=1\)</span>. We can construct this process by defining <span class="math inline">\(B(t)\)</span> as <span class="math display">\[B(t) = W(t) - \frac{t}{T}W(T).\]</span> To bridge a general choice of <span class="math inline">\(a,b\in\mathbb{R}\)</span>, we’ll start by connecting the two points with a straight line parameterized by <span class="math inline">\(t\in[0,T]\)</span>, <span class="math inline">\((1-t/T)a+(t/T)b\)</span>. To modify this line, we’ll add the standard Brownian bridge <span class="math inline">\(B(t)\)</span>.</p>
<p><span class="math display">\[\begin{align*}
B(t\mid a,b) &amp;= \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + B(t)\\
&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W(t) - \frac{t}{T}W(T)
\end{align*}\]</span></p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-21_3c918483ffd939bb064b8edbfe7f6331">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>brownian_bridge <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">T_max =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, s){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Start by drawing standard Wiener process on [0,T]</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">wiener</span>(N, T_max, <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># define B(t) using W(t)</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> (<span class="dv">1</span> <span class="sc">-</span> time<span class="sc">/</span>T_max)<span class="sc">*</span>a <span class="sc">+</span> (time<span class="sc">/</span>T_max)<span class="sc">*</span>b <span class="sc">+</span> value <span class="sc">-</span> (time<span class="sc">/</span>T_max)<span class="sc">*</span><span class="fu">last</span>(value, <span class="at">order_by =</span> time),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> s</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>draw_brownian_bridge <span class="ot">&lt;-</span> <span class="cf">function</span>(n, N, <span class="at">T_max =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>){</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n <span class="sc">%&gt;%</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(brownian_bridge, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max, <span class="at">a =</span> a, <span class="at">b =</span> b) <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_brownian_bridge</span>(<span class="fl">7e3</span>, <span class="fl">1e4</span>, <span class="at">T_max =</span> <span class="dv">2</span>, <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot5952_3653d32fa3e986d1b3fe87451c2e3b25">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(iter_num <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">linewidth =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot5952" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot5952-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot5952-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot5952-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.11: 100 realizations of the standard Brownian bridge
</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s consider the random variable given by the Brownian bridge takes on at a specific point in time <span class="math inline">\(t\in[t_1,t_2]\)</span> which we will write as <span class="math inline">\(B_{t\mid a,b, t_1, t_2}\)</span>. We can derive the distribution of this random variable using properties of the normal distribution and <span class="math inline">\(W_t\sim N(0,t)\)</span>.</p>
<p><span class="math display">\[\begin{align*}
B_{t\mid a,b}&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W(t) - \frac{t}{T}W(T) \\
&amp; \sim \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t) - \frac{t}{T}N(0,T)\\
&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t) - N(0,t^2/T)\\
&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t(T - t)/T)\\
&amp; = N\left( \left(1-\frac{t}{T}\right)a + \frac{t}{T}b, \left(\frac{t(T-t)}{T}\right)\right)
\end{align*}\]</span></p>
<p>To calculate the covariance of the Brownian bridge at two points, we first need to calculate the covariance</p>
<p><span class="math display">\[\begin{align*}
\text{Cov}\left(B_{t\mid a,b}, B_{s\mid a,b}\right) &amp;= \text{Cov}\left(\left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W_t - \frac{t}{T}W_T, \left(1-\frac{s}{T}\right)a + \frac{s}{T}b + W_s - \frac{s}{T}W_T\right)\\
&amp; = \text{Cov}\left(W_t - \frac{t}{T}W_T, W_s - \frac{s}{T}W_T\right) \\
&amp; = \text{Cov}\left(W_t, W_s\right) - \frac{s}{T}\text{Cov}\left(W_t, W_T\right) - \frac{t}{T}\text{Cov}\left(W_T, W_s\right) + \frac{st}{T^2}\text{Cov}\left(W_T, W_T\right)\\
&amp; = \min\{t,s\} - \frac{s}{T}\min\{t, T\} - \frac{t}{T}\min\{s, T\} + \frac{st}{T^2}\text{Var}\left(W_T\right)\\
&amp; = \min\{t,s\} - \frac{st}{T} - \frac{st}{T} - \frac{stT}{T^2}\\
&amp; = \min\{t,s\} - \frac{st}{T}
\end{align*}\]</span></p>
<p>If we combine these two calculations, we can conclude that for any <span class="math inline">\(t_1,\ldots,t_k\in [0,T]\)</span> we have <span class="math display">\[\begin{align*}
\mathbf W &amp;\sim N(\boldsymbol{\mu},\boldsymbol{\Sigma}),\\
\boldsymbol{\mu}_j &amp;= \left(1-\frac{t}{T}\right)a + \frac{t}{T}b,\\
\boldsymbol{\Sigma}_{j\ell}&amp;=\begin{cases}\frac{t_j(T-t_j)}{T} &amp; j = \ell \\ \min\{t_j,t_{\ell}\} - \frac{t_jt_\ell}{T} &amp; \text{otherwise} \end{cases},
\end{align*}\]</span> making <span class="math inline">\(B(t\mid a,b)\)</span> a Gaussian process. The Brownian bridge is an important tool and can be generalized to arbitrary intervals <span class="math inline">\([t_1,t_2]\subseteq [0,T]\)</span>. For details see pages 82-86 of <span class="citation" data-cites="glasserman2004monte">Glasserman (<a href="#ref-glasserman2004monte" role="doc-biblioref">2004</a>)</span>.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One last example of a stochastic process is especially important in econometrics and is much easier to think of as a random function than more traditional examples of stochastic processes which are typically given as an indexed collection of random variables.</p>
<div id="exm-rf" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.7 (A Random Function)</strong></span> Imagine we observe an iid random sample <span class="math inline">\(\mathbf{X}= (X_1,\ldots, X_n)\)</span> where <span class="math inline">\(X_i\overset{iid}{\sim}N(\mu,\sigma^2)\)</span>, and we want to measure the distance a number <span class="math inline">\(t\in\mathbb{R}\)</span> is from the sample <span class="math inline">\(\mathbf{X}\)</span>. One way to do this is with the Euclidean metric. If <span class="math inline">\(\mathbf e\)</span> is the unit vector of length <span class="math inline">\(n\)</span> then the distance between <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(t\)</span> is <span class="math display">\[ \left\lVert\mathbf{X}- t\cdot\mathbf e\right\rVert_2 = \left(\textstyle\sum_{i=1}^n(X_i - t)^2\right)^{1/2}.\]</span> If we define <span class="math inline">\(Q_t = \left\lVert\mathbf{X}- t\cdot\mathbf e\right\rVert_2\)</span>, then <span class="math inline">\(Q = \{Q_t\}_{t\in\mathbb{R}}\)</span> is a stochastic process which maps <span class="math inline">\(\mathbb{R}\)</span> to functions in the space <span class="math inline">\(\mathbb{R}^\mathbb{R}\)</span> (the set of all single variable real functions). Let’s look at 100 simulated values of the process <span class="math inline">\(Q\)</span> where <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma^2 = 1\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-23_263eea0ad292554feb3a3da1b3ce8fe6">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define random function Q_t</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, t){</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">sum</span>((sample<span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># draw n values and calculate Q_t on a given domain</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(f, domain, n, dist, dist_params, s){</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> domain, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q =</span> <span class="fu">map_dbl</span>(domain, f, <span class="at">sample =</span> X),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> n</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># draw N realizations of Q_t on the domain</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(N, f, domain, n, dist, dist_params){</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">f =</span> f, <span class="at">domain =</span> domain, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot510_0a8f67c47828a6f11d30c6585a89eb8e">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot510" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot510-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot510-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot510-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.12: 100 realizations of an aggregated distance of a real number from a random sample calculated using the Euclidean metric.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In each case the realized value of <span class="math inline">\(Q\)</span> is a parabola which happens to be continuously differentiable, so <span class="math inline">\(Q:\mathbb{R}\to C^2(\mathbb{R})\)</span>. We could also define <span class="math inline">\(Q\)</span> using the the norm <span class="math inline">\(\left\lVert\cdot\right\rVert_1\)</span> (giving taxi-cab metric) or <span class="math inline">\(\left\lVert\cdot\right\rVert_\infty\)</span> (giving the supremum metric). <span class="math display">\[\begin{align*}
\left\lVert\mathbf{X}- t\cdot\mathbf e\right\rVert_1 &amp;= \left(\textstyle\sum_{i=1}^n\left\lvert X_i - t\right\rvert\right)\\
\left\lVert\mathbf{X}- t\cdot\mathbf e\right\rVert_\infty &amp; = \max_{i}\left\lvert X_i-t\right\rvert
\end{align*}\]</span></p>
<p>In both these cases, the realized value of <span class="math inline">\(Q\)</span> will not be differentiable on all of <span class="math inline">\(\mathbb{R}\)</span> since <span class="math inline">\(\left\lvert x_i - t\right\rvert\)</span> is not differentiable at the point <span class="math inline">\(t=x_i\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-25_0748248f1e87a5e0e5fb5890f7098a9c">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample,t){</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(sample<span class="sc">-</span>t))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot511_8b68f0bf370f21fa5ed92ae058df8146">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot511" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot511-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot511-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot511-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.13: 100 realizations of an aggregated distance of a real number from a random sample calculated using the taxi-cab metric. While the realization of the stochastic process appears smooth, it has slight kinks at which it is not differentiable.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-27_0d6e5e5146777a98f88676477d306ad0">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample,t){</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">abs</span>(sample<span class="sc">-</span>t))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot512_dd385fa9954f2d0468c17e22a59f5e11">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot512" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot512-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot512-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot512-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.14: 100 realizations of an aggregated distance of a real number from a random sample calculated using the supremum metric.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="convergence" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="convergence"><span class="header-section-number">6.2</span> Convergence</h2>
<p>Like any sequence of random variables, a sequence of stochastic processes can converge in a number of ways. A sequence of stochastic processes is just a probabilistic version of a sequence of functions. As such, we can retrofit concepts such as pointwise convergence, uniform convergence, and equicontinuity to apply to stochastic processes. The notation around stochastic processes is cumbersome to begin with, but introducing an index to sequence them makes things even messier. We’ll stick to writing a stochastic process <span class="math inline">\(\{X\}_{t\in T}\)</span> as <span class="math inline">\(X(t)\)</span>, and will denote a sequence of stochastic processes <span class="math inline">\(\{X_t(t), X_2(t), \ldots\}\)</span> as <span class="math inline">\(X_n(t)\)</span>.</p>
<div id="exm-rf2" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.8</strong></span> Return to <a href="#exm-rf" class="quarto-xref">Example&nbsp;<span class="quarto-unresolved-ref">exm-rf</span></a> where we defined <span class="math display">\[Q(t) = \left(\textstyle\sum_{i=1}^n(X_i - t)^2\right)^{1/2} \]</span> for <span class="math inline">\(X_i\overset{iid}{\sim}N(\mu,\sigma^2)\)</span> and a sample size of <span class="math inline">\(n\)</span>. If we let <span class="math inline">\(n\)</span> vary, we have a sequence <span class="math inline">\(Q_n(t)\)</span> indexed by <span class="math inline">\(n\)</span>. We’ll modify the process <span class="math inline">\(Q_n(t)\)</span> by dividing by <span class="math inline">\(n\)</span> and eliminating the square root, such that <span class="math inline">\(Q_n(t)\)</span> is the average distance between <span class="math inline">\(t\)</span> and <span class="math inline">\(X_i\)</span>. <span class="math display">\[\begin{align*}
Q_1(t) &amp;= \left((X_1 - t)^2\right)^{1/2} = X_1-t\\
Q_2(t) &amp; = \frac{1}{2}\left((X_1 - t)^2 + (X_2 - t)^2\right)\\
&amp;\vdots\\
Q_n(t) &amp; = \frac{1}{n} \textstyle\sum_{i=1}^n(X_i - t)^2\\
\vdots
\end{align*}\]</span> The key question is how does the behavior of <span class="math inline">\(Q_n(t)\)</span> change as <span class="math inline">\(n\to\infty\)</span>? Let’s repeat the same simulation as we did in <a href="#exm-rf" class="quarto-xref">Example&nbsp;<span class="quarto-unresolved-ref">exm-rf</span></a>, but do so for increasingly large sample sizes <span class="math inline">\(n\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-29_7f32adeb4698ce1265675dcbe5cf24d3">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, t, n){</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sample[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">sum</span>((X<span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(X)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># perform simulation over varying sample sizes given by vector n_vals</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(f, domain, sample, n){</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> domain,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> n,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q =</span> <span class="fu">map_dbl</span>(domain, f, <span class="at">sample =</span> sample, <span class="at">n =</span> n)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(n_vals, f, domain, n, dist, dist_params){</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> n_vals <span class="sc">%&gt;%</span> </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">f =</span> f, <span class="at">domain =</span> domain, <span class="at">sample =</span> X) <span class="sc">%&gt;%</span> </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="dv">10</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="dv">100</span>), obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="fl">1e3</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot513_1d9adfa88f2df4003da38032708ceba7">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(sample_size) <span class="sc">+</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Q'</span>, <span class="at">x =</span> <span class="st">'t'</span>) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>}, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Sample Size: {closest_state}'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot513" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot513-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot513-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot513-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.15: 100 realizations of the process at various sample sizes.
</figcaption>
</figure>
</div>
</div>
</div>
<p>As the sample size increases, it appears that the stochastic process approaches the deterministic function <span class="math inline">\(f(x) = x^2 + 1\)</span>.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Instead of focusing just on stochastic processes, we’ll generalize the definition of convergence in probability to any random variable defined on a metric space.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.3</strong></span> Suppose <span class="math inline">\(X_n\)</span> is a sequence of random variables defined on a metric space <span class="math inline">\(E\)</span> (equipped with a metric <span class="math inline">\(d:E\times E\to[0,\infty]\)</span>). The sequence <span class="math inline">\(X_n\)</span> <span style="color:red"><strong><em>converges in probability</em></strong></span> to a random variable <span class="math inline">\(X\)</span> (defined on the same metric space) if <span class="math display">\[ \lim_{n\to\infty}\Pr\left(d(X,X_n) &gt; \varepsilon \right) = 0.\]</span></p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.9</strong></span> If <span class="math inline">\(X_n\)</span> is a sequence of random variables defined on <span class="math inline">\(\mathbb{R}\)</span> equipped with the Euclidean metric <span class="math inline">\(d(x,y) = \left\lvert x-y\right\rvert\)</span>, then the generalized definition of convergence in probability reduces <span class="math display">\[ \lim_{n\to\infty}\Pr\left(\left\lvert X-X_n\right\rvert &gt; \varepsilon \right) = 0.\]</span></p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This “new” definition of convergence in probability allows us to define convergence in probability of stochastic processes. If <span class="math inline">\(X_n(t)\)</span> is a sequence of stochastic processes which map the sample space <span class="math inline">\(\mathcal X\)</span> to the space of functions <span class="math inline">\(S^T\)</span>, then we can define <span class="math inline">\(X_n(t)\overset{p}{\to}X\)</span> as long as <span class="math inline">\(S^T\)</span> is a metric space. The most familiar such space of functions is the set of real-valued continuous functions on a closed interval <span class="math inline">\([a,b]\)</span>, <span class="math inline">\(C([a,b])\)</span>. The standard metric on this space is the supremum/uniform metric defined as <span class="math display">\[ d(f,g) = \left\lVert f-g\right\rVert_\infty = \sup_{x\in[a,b]}\left\lvert f(x) - g(x)\right\rvert.\]</span> If a sequence of (deterministic) <span class="math inline">\(\{f_n\}\)</span> in the space <span class="math inline">\(C([a,b])\)</span> converges with respect to the supremum metric, then the sequence of real functions converges uniformly (hence the alternate name of “uniform” metric). Uniform convergence is one of the most important concepts in real analysis because it plays nicely with operations like integration and differentiation (opposed to pointwise convergence). The probabilistic extension of uniform convergence of stochastic processes arises when considering convergence in probability with respect to the supremum metric.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.4</strong></span> Suppose <span class="math inline">\(X_n(t)\)</span> is a sequence of stochastic processes defined on the set <span class="math inline">\(C(E)\)</span>, where <span class="math inline">\(E\subseteq \mathbb{R}\)</span>, equipped with the metric <span class="math inline">\(d(f,g) = \left\lVert f-g\right\rVert_\infty\)</span>. We say that <span class="math inline">\(X_n\)</span> <span style="color:red"><strong><em>converges in probability uniformly</em></strong></span> to a stochastic process <span class="math inline">\(X\)</span> (defined on the same metric space) if <span class="math display">\[ \lim_{n\to\infty}\Pr\left(\sup_{t\in E}\left\lvert X_n(t) - X(t)\right\rvert &gt; \varepsilon \right) = 0.\]</span></p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The definition of uniform convergence in probability may look intimidating, but it’s nothing more then a special case of convergence in probability that arises from looking at a metric space comprised of functions.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One definition that is relevant to the convergence of stochastic processes is related to continuity. Recall that a function <span class="math inline">\(f:X\to Y\)</span>, defined on two metric spaces with respective metrics <span class="math inline">\(d_X\)</span> and <span class="math inline">\(d_Y,\)</span> is continuous at a point <span class="math inline">\(x_0\in X\)</span> if for all <span class="math inline">\(\varepsilon &gt; 0\)</span> there exists a <span class="math inline">\(\delta_{x_0} &gt; 0\)</span> such that <span class="math display">\[d_Y(f(x_0), f(x)) &lt; \varepsilon \]</span> for all <span class="math inline">\(x\in X\)</span> satisfying <span class="math inline">\(d_X(x_0,x) &lt; \delta_{x_0}\)</span>. In the event that a function is continuous at every point in some subset <span class="math inline">\(E\subseteq X\)</span>, then <span class="math inline">\(f\)</span> is continuous on <span class="math inline">\(E\)</span>. It’s important to realize that the value <span class="math inline">\(\delta_{x_0}\)</span> in the definition of continuity may depend on the point <span class="math inline">\(x_0\)</span>, hence the subscript. Even if <span class="math inline">\(f\)</span> is continuous on <span class="math inline">\(E\)</span>, <span class="math inline">\(d_X(x_0',x) &lt; \delta_{x_0}\)</span> <em>does not</em> imply that <span class="math inline">\(d_Y(f(x_0'), f(x)) &lt; \varepsilon\)</span> for some <span class="math inline">\(x_0'\in E\)</span>. If we require that there is one “silver-bullet” <span class="math inline">\(\delta\)</span> that works for all points on <span class="math inline">\(E\)</span>, then we say <span class="math inline">\(f\)</span> is uniformly continuous on <span class="math inline">\(E\)</span>. In other words, for all <span class="math inline">\(\varepsilon &gt; 0\)</span>, there exists a single <span class="math inline">\(\delta\)</span> such that <span class="math display">\[d_Y(f(x_0), f(x)) &lt; \varepsilon\]</span> whenever <span class="math inline">\(d_X(x_0,x) &lt; \delta\)</span> <em>for all</em> <span class="math inline">\(x_0\in E\)</span>. This is a much stronger form of continuity called uniform continuity, and it can also be written as <span class="math display">\[ \sup_{d(x,x_0) &lt; \delta} d_Y(f(x_0), f(x)) &lt; \varepsilon.\]</span> If <span class="math inline">\(d_Y(f(x_0), f(x)) &lt; \varepsilon\)</span> for the “largest” such value of <span class="math inline">\(d_Y(f(x_0), f(x))\)</span> where <span class="math inline">\(d(x,x_0) &lt; \delta\)</span>, then it must hold for all <span class="math inline">\(d_Y(f(x_0), f(x))\)</span> satisfying <span class="math inline">\(d(x,x_0) &lt; \delta\)</span>.<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If we think about uniform continuity in the context of sequences of functions <span class="math inline">\(\{f_n\}\)</span> where <span class="math inline">\(f_n:X\to Y\)</span>, we can introduce a form of continuity even stronger than uniform continuity. Suppose we have a sequence of uniformly continuous functions <span class="math inline">\(\{f_n\}\)</span>. For each <span class="math inline">\(f_n\)</span>, we have some <span class="math inline">\(\delta_n\)</span> such that <span class="math inline">\(d_X(x_0, x) &lt; \delta_n\)</span> implies that <span class="math inline">\(d_Y(f_n(x_0), f(x))&lt;\varepsilon\)</span> for all <span class="math inline">\(x_0 \in E\)</span>. In general, for two functions <span class="math inline">\(f_i\)</span> and <span class="math inline">\(f_j\)</span> (which are in the sequence <span class="math inline">\(\{f_n\}\)</span>), <span class="math inline">\(\delta_i\neq\delta_j\)</span>. All the functions in the sequence may be uniformly continuous, but their uniform continuity is not related to other elements in anyway. What would happen if we required this though? In other words, what if we were to require that there is a single <span class="math inline">\(\delta\)</span> that is independent of <span class="math inline">\(n\)</span> that works across all <span class="math inline">\(f_n\)</span>? This would be like uniform continuity on steroids, and in fact has a name. A group of functions <span class="math inline">\(\mathcal F\)</span> (in our case our interest is when <span class="math inline">\(\mathcal F\)</span> is a sequence of functions) is (uniformly) equicontinuous if for all <span class="math inline">\(\varepsilon &gt;0\)</span> there exists a <span class="math inline">\(\delta &gt;0\)</span> such that <span class="math inline">\(d_X(x_0, x) &lt; \delta\)</span> implies <span class="math inline">\(d_Y(f(x_0),f(x)) &lt; \varepsilon\)</span> <em>for all</em> <span class="math inline">\(f\in \mathcal F\)</span> and <em>all</em> <span class="math inline">\(x_0\in E\)</span>. Another way of saying this is that <span class="math display">\[\begin{align*}
\sup_{d(x,x_0) &lt; \delta} d_Y(f(x_0), f(x)) &amp;&lt; \varepsilon &amp; (\forall f\in \mathcal F)
\end{align*}\]</span> To be even more succinct, we can write this in terms of the choice of <span class="math inline">\(f\)</span> which gives the “largest” value of <span class="math inline">\(\sup_{d(x,x_0) &lt; \delta} d_Y(f(x_0), f(x))\)</span>, as this would imply it holds for all <span class="math inline">\(f\in \mathcal F\)</span>. <span class="math display">\[\begin{align*}
\sup_{f\in\mathcal F}\sup_{d(x,x_0) &lt; \delta} d_Y(f(x_0), f(x)) &amp;&lt; \varepsilon
\end{align*}\]</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; We want to develop a probabilistic version of equicontinuity in the context of stochastic processes. To makes things easier, we’ll only concern ourselves with processes defined on real continuous functions defined on <span class="math inline">\(E\subseteq \mathbb R\)</span>.<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a> If our process <span class="math inline">\(X_n(t)\)</span> is indexed by <span class="math inline">\(n\)</span>, then the probabilistic extension of uniform continuity would look like something like <span class="math display">\[\Pr\left(\sup_{\left\lvert s-t\right\rvert &lt; \delta} \left\lvert X_n(t)-X_n(s)\right\rvert &gt; \eta \right) &lt; \varepsilon\]</span> for all <span class="math inline">\(\eta,\varepsilon &gt; 0\)</span>. To ensure this holds for all <span class="math inline">\(X_n\)</span>, we take the supremum over <span class="math inline">\(n\)</span></p>
<p><span class="math display">\[\sup_{n}\Pr\left(\sup_{\left\lvert s-t\right\rvert &lt; \delta} \left\lvert X_n(t)-X_n(s)\right\rvert &gt; \eta \right) &lt; \varepsilon.\]</span> Since we’re considering the asymptotics of <span class="math inline">\(\{X_n\}\)</span> we’d like this inequality to hold as <span class="math inline">\(n\to\infty\)</span> which gives the condition</p>
<p><span class="math display">\[\limsup_{n\to\infty}\Pr\left(\sup_{\left\lvert s-t\right\rvert &lt; \delta} \left\lvert X_n(t)-X_n(s)\right\rvert &gt; \eta \right) &lt; \varepsilon.\]</span></p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.5</strong></span> Suppose <span class="math inline">\(X_n(t)\)</span> is a sequence of stochastic processes defined on the set <span class="math inline">\(C(E)\)</span>, where <span class="math inline">\(E\subseteq \mathbb{R}\)</span>. We say that this collection of stochastic processes is <span style="color:red"><strong><em>stochastically equicontinuous</em></strong></span> if</p>
<p><span class="math display">\[\limsup_{n\to\infty}\Pr\left(\sup_{\left\lvert s-t\right\rvert &lt; \delta} \left\lvert X_n(t)-X_n(s)\right\rvert &gt; \eta \right) &lt; \varepsilon.\]</span></p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Informally, stochastic equicontinuity ensures that if <span class="math inline">\(t\)</span> and <span class="math inline">\(s\)</span> are close, then the probability that <span class="math inline">\(X_n(s)\)</span> and <span class="math inline">\(X_n(t)\)</span> are close is very high as <span class="math inline">\(n\to\infty\)</span>. As one might expect from the grotesque definition, proving a sequence of random functions exhibits stochastic equicontinuity can be quite tricky. <span class="citation" data-cites="andrews1994empirical">Andrews (<a href="#ref-andrews1994empirical" role="doc-biblioref">1994</a>)</span> provides several conditions which imply stochastic continuity that are more readily verified.</p>
</section>
<section id="sec-dist" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-dist"><span class="header-section-number">6.3</span> Convergence in Distribution</h2>
<p>A sequence of real-valued random variables <span class="math inline">\(X_n\)</span> converges in distribution to <span class="math inline">\(X\)</span> if <span class="math inline">\(\lim_{n\to\infty}F_{n}(x) = F_X(x)\)</span>. This form of convergence is what the various forms of the CLT were concerned with, and it’s also the type of convergence that underpins statistical inference by allowing us to derive the asymptotic distribution of test statistics. It stands to reason then that if convergence in distribution is so important, it should be generalized to stochastic processes. While it can be, it will look a bit different, and this is why you sometimes hear people refer to convergence in distribution as “weak convergence”. This is due to the term “(cumulative) distribution function” being specific to real-valued random variables. It’s worth digging a bit deeper on the measure theory behind this.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If <span class="math inline">\((\mathcal X, \mathcal F, P)\)</span> is a probability space and <span class="math inline">\(X:\mathcal X\to E\)</span> is a random variable defined on the measurable space <span class="math inline">\((E, \mathcal E)\)</span>, then we can define a special measure on <span class="math inline">\((E, \mathcal E)\)</span> using the probability measure <span class="math inline">\(P:\mathcal F\to[0,1]\)</span>. We do this by composing <span class="math inline">\(P\)</span> and <span class="math inline">\(X^{-1}\)</span> to get what is called the “law” of <span class="math inline">\(X\)</span>, written as <span class="math display">\[\mathcal L(X) = P\circ X^{-1}.\]</span> Since <span class="math inline">\(X\)</span> is a random variable, <span class="math inline">\(X^{-1}(A)\in \mathcal F\)</span> for all <span class="math inline">\(A\in \mathcal E\)</span>, so we know that <span class="math inline">\(P\)</span> is defined for all <span class="math inline">\(X^{-1}(A)\)</span>, i.e <span class="math inline">\(\mathcal L(X)\)</span> is defined on all of <span class="math inline">\(\mathcal E\)</span>. The law of <span class="math inline">\(X\)</span> evaluated at <span class="math inline">\(A\in\mathcal E\)</span>, <span class="math inline">\(P\circ X^{-1}(A)\)</span>, tells us “what is the probability that <span class="math inline">\(X\)</span> takes on a value in the set <span class="math inline">\(A\)</span>?” We can define the law of <span class="math inline">\(X\)</span> <em>for any</em> random variable. In the event that <span class="math inline">\(E = \mathbb{R}\)</span> and <span class="math inline">\(\mathcal E = \mathcal B(\mathbb{R})\)</span>, making <span class="math inline">\(X\)</span> a real-valued random variable, then we can use the law of <span class="math inline">\(X\)</span> to define the familiar distribution function as follows: <span class="math display">\[ P\circ X^{-1}((-\infty,x]) = P(X\in (-\infty, x]) = P(X\le x) = F_X(x).\]</span> Generalizing convergence in distribution to random variables defined on arbitrary metric spaces really means defining convergence in laws (which is synonymous with “weak convergence”). The mathematical details of this are interesting, but fairly rigorous. <span class="citation" data-cites="billingsley2008probability">Billingsley (<a href="#ref-billingsley2008probability" role="doc-biblioref">2008</a>)</span>, which is one of the <em>de facto</em> references for probability theory, only scratches the surface of convergence in laws, instead treating it in it’s own book (<span class="citation" data-cites="billingsleycon">Billingsley (<a href="#ref-billingsleycon" role="doc-biblioref">2013</a>)</span>). For this reason, it’s better to just cover the basics.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The first step in defining weak convergence for random functions is with a useful results that gives several equivalent formulations for convergence in distribution for real variables. We’ll provide only one of these equivalences.</p>
<div id="lem-" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 6.1 (Portmanteau Lemma)</strong></span> Suppose <span class="math inline">\(X_n\)</span> is a sequence of real-valued random variables. We have <span class="math inline">\(X_n\overset{d}{\to}X\)</span> <em>if and only if</em> <span class="math inline">\(\text{E}\left[f(X_n)\right]\to\text{E}\left[f(X)\right]\)</span> for all bounded continuous functions <span class="math inline">\(f\)</span>.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The proof is not particularly important.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a> What is, is that we can retrofit this definition of weak convergence for random variables defined on any metric space.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.6</strong></span> Suppose <span class="math inline">\(X_n\)</span> is a sequence of random variables defined on a metric space <span class="math inline">\(E\)</span>. We say that <span class="math inline">\(X_n\)</span> <span style="color:red"><strong><em>converges weakly</em></strong></span> to a random variable <span class="math inline">\(X\)</span> if <span class="math inline">\(\text{E}\left[f(X_n)\right]\to\text{E}\left[f(X)\right]\)</span> for all bounded and continuous functions <span class="math inline">\(f:E\to\mathbb{R}\)</span>. To be consistent with existing notation, this will be written as <span class="math inline">\(X_n\overset{d}{\to}X\)</span>.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; So now what? We have a definition of weak convergence we can apply to random functions in <span class="math inline">\(C(E)\)</span> for <span class="math inline">\(E\subseteq \mathbb{R}\)</span>, but how do we even begin to apply this definition to show that <span class="math inline">\(X_n \overset{d}{\to}X\)</span>?! It turns out, if we use stochastic equicontinuity, we can break the problem into much smaller parts that we know how to solve. Recall that one of the easiest ways to understand the Wiener process <span class="math inline">\(W\)</span> was looking at the real-valued random variables <span class="math inline">\(\{W(t_1), W(t_2), \ldots, W(t_k)\}\)</span> at fixed times <span class="math inline">\(t_1,t_2,\ldots,t_k\)</span>. What happens if this collection of real-valued random variables <span class="math inline">\((W(t_1), W(t_2),\ldots, W(t_k))\)</span>, which forms a random vector, converges in distribution? Could we then conclude that the entire process <span class="math inline">\(W\)</span> converges in distribution? <em>Maybe</em>! In typical real analysis fashion, we need to impose a property related to convergence and continuity to iron out some wacky edge cases that could mess things up. It just so happens that the property we need is stochastic equicontinuity. This gives rise to a useful characterization of weak convergence of random functions, the proof of which can be found in Chapter 7 of <span class="citation" data-cites="billingsleycon">Billingsley (<a href="#ref-billingsleycon" role="doc-biblioref">2013</a>)</span>.</p>
<div id="thm-spconv" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.1</strong></span> Suppose <span class="math inline">\(X_n(t)\)</span> is a sequence of stochastic processes defined on the set <span class="math inline">\(C(E)\)</span>, where <span class="math inline">\(E\subseteq \mathbb{R}\)</span>, equipped with the metric <span class="math inline">\(d(f,g) = \left\lVert f-g\right\rVert_\infty\)</span>. We have <span class="math inline">\(X_n\overset{d}{\to}X\)</span> <em>if and only if</em> the two following conditions holds:</p>
<ol type="1">
<li>For every finite set of points <span class="math inline">\(t_1,\ldots, t_k\in E\)</span> the random vector <span class="math inline">\((X_n(t_1),\ldots,X_n(t_k))\)</span> converges in distribution to the random vector <span class="math inline">\((X(t_1),\ldots X(t_k))\)</span>. <span class="math display">\[ (X_n(t_1),\ldots,X_n(t_k))\overset{d}{\to}(X(t_1),\ldots X(t_k))\]</span></li>
<li>There exists a finite partition of <span class="math inline">\(E =\cup_{j=1}^J E_j\)</span> such that <span class="math inline">\(X_n\)</span> is stochastically equicontinuous on <span class="math inline">\(E_j\)</span> for all <span class="math inline">\(j=1,\ldots,J\)</span>.</li>
</ol>
</div>
</section>
<section id="application-empirical-process-theory" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="application-empirical-process-theory"><span class="header-section-number">6.4</span> Application: Empirical Process Theory</h2>
<p>A great deal of the asymptotic theory dealing with stochastic processes was developed in the context of one <em>very</em> important stochastic process. This particular process happens to be one of the most important estimators in statistics, and is used to estimate the cumulative distribution function of a random variable.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.7</strong></span> Let <span class="math inline">\(\mathcal F\)</span> be the set of all distribution functions of a real-valued random variable defined on <span class="math inline">\(\mathcal X\)</span>, and <span class="math inline">\((X_1,\ldots,X_n)\)</span> be a set of iid real-valued random variables defined on <span class="math inline">\(\mathcal X\)</span>.<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a> If The <span style="color:red"><strong><em>empirical (cumulative) distribution function (ecdf)</em></strong></span> <span class="math inline">\(\hat F:\mathcal X\to\mathcal F\)</span> is an estimator defined as <span class="math display">\[\hat F_X(x) = \frac{1}{n}\sum_{i=1}^nI[X_i \le x].\]</span> This estimator can be generalized to an iid sample of real-valued random vectors as follows:</p>
<p><span class="math display">\[ \hat F_{\mathbf{X}}(\mathbf{x}) = \frac{1}{n}\sum_{i=1}^nI[X_{i,k} \le x_k\ \forall k]\]</span></p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; To estimate the probability of <span class="math inline">\(\Pr(X\le x) = \hat F_X(x)\)</span> at a given point <span class="math inline">\(x\in\mathcal X\)</span>, the estimator <span class="math inline">\(\hat F\)</span> just counts the number of realized values of <span class="math inline">\(X_i\)</span> which are less than <span class="math inline">\(X\)</span>. This proportion is often called the <em>empirical probability</em>, and is the sample-counterpart to the true probability.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.10</strong></span> Let’s draw a sample of <span class="math inline">\(n=100\)</span> from <span class="math inline">\(X\overset{iid}{\sim}N(0,1)\)</span>, calculate <span class="math inline">\(\hat F_X(0)\)</span>, and then compare <span class="math inline">\(F_X\)</span> and <span class="math inline">\(\hat F_X\)</span> with a figure.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-31_670e84e9db1aba88633bac50bab760f6">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define "function factory" to create estimator F_X(x) given X = sample</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>emp_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(sample){</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(sample <span class="sc">&lt;</span> x) <span class="sc">/</span> n)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">Vectorize</span>(output))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>F_hat <span class="ot">&lt;-</span> <span class="fu">emp_cdf</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">F_hat</span>(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.47</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot5135_ab02334df43881920298e577e6e76c78">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Empirical Distribution</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">F_hat</span>(x),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Actual Distribution</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">pnorm</span>(x)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>x) <span class="sc">%&gt;%</span> </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"Pr(X &lt; x)"</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot5135" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot5135-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot5135-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot5135-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.16: iii
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The empirical distribution function is one of the most important estimators in statistics (right up there with sample mean), which is why there is an entire field of research dedicated to it (along with generalizations) called empirical process theory. Before introducing the highlights of empirical process theory, let’s consider <span class="math inline">\(\hat F\)</span> evaluated at some fixed value <span class="math inline">\(x_0\in \mathcal X\)</span>. This gives an estimator <span class="math inline">\(\hat F_X(x_0):\mathcal X\to[0,1]\)</span> which is fairly easy to analyze.</p>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.2 (Pointwise Properties of the ECDF)</strong></span> Suppose <span class="math inline">\(\mathbf{X}= (X_1,\ldots, X_n)\)</span> is an iid sequence of real-valued random variables defined on <span class="math inline">\(\mathcal X\)</span>. <em>For a fixed</em> value <span class="math inline">\(x_0\in \mathcal X\)</span>, the estimator <span class="math inline">\(\hat F_X(x_0):\mathcal X\to[0,1]\)</span> exhibits the following properties:</p>
<ol type="1">
<li><span class="math inline">\(\hat F_X(x_0)\)</span> is an unbiased estimator for <span class="math inline">\(F_X(x_0)\)</span> and has a variance of <span class="math inline">\(\frac{1}{n} F_X(x_0)(1-F_X(x_0)\)</span>;</li>
<li><span class="math inline">\(\hat F_X(x_0)\)</span> is a consistent estimator for <span class="math inline">\(F_X(x_0)\)</span>;</li>
<li><span class="math inline">\(\sqrt{n}\left[\hat F_X(x_0) - F_X(x_0)\right]\overset{d}{\to}N(0, F_X(x_0)(1-F_X(x_0)))\)</span>.</li>
</ol>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We have <span class="math inline">\(I[X_i \le x] \overset{iid}{\sim}\text{Bernoulli}(F_X(x_0))\)</span>, so the sum of these <span class="math inline">\(n\)</span> of these indicator functions is a binomial random variable which we will denote as <span class="math inline">\(Y\)</span>. <span class="math display">\[Y=\sum_{i=1}^nI[X_i \le x] \sim \text{Ber}(n, F_X(x_0))\]</span> This makes the estimator <span class="math inline">\(\hat F_X(x_0)= Y/n\)</span> a scaled version of the binomial distribution, a fact which we can use to prove the claimed properties.</p>
<ol type="1">
<li><p>The estimator’s unbiasedness follows from the expectation of the binomial random variable <span class="math inline">\(Y\)</span>. <span class="math display">\[\text{E}\left[\hat F_X(x_0)\right] = \text{E}\left[Y/n\right] = \frac{1}{n}\text{E}\left[Y\right] = \frac{1}{n}\left[nF_X(x_0)\right]=F_X(x_0)\]</span> The variance follows from a similar calculation. <span class="math display">\[\text{Var}\left(\hat F_X(x_0)\right) = \text{Var}\left(Y/n\right) = \frac{1}{n^2}\text{Var}\left(Y\right) = \frac{1}{n^2}\left[nF_X(x_0)(1-F_X(x_0))\right]=\frac{1}{n} F_X(x_0)(1-F_X(x_0).\]</span></p></li>
<li><p>The estimator <span class="math inline">\(\hat F_X(x_0)\)</span> is the sample average of idd random bernoulli variables <span class="math inline">\(I[X_i \le x]\)</span>, so by the LLN we have <span class="math display">\[\hat F_X(x_0) = \frac{1}{n}\sum_{i=1}^n I[X_i \le x] \overset{p}{\to}\text{E}\left[I[X_i \le x]\right] = F_X(x_0) .\]</span></p></li>
<li><p>One way to show this is by applying Slutsky’s theorem to the normal approximation of the binomial distribution.</p></li>
</ol>
<p><span class="math display">\[\begin{align*}
&amp; Y  \sim \text{Ber}(n, F_X(x_0))\\
\implies &amp; Y\overset{d}{\to}N(nF_X(x_0), F_X(x_0)(1-F_X(x_0))\\
\implies &amp; \frac{1}{n}Y \overset{d}{\to}N\left(F_X(x_0), \frac{1}{n}F_X(x_0)(1-F_X(x_0)\right)\\
\implies &amp; \hat F_X(x_0) \overset{d}{\to}N\left(F_X(x_0), \frac{1}{n}F_X(x_0)(1-F_X(x_0)\right)\\
\implies &amp; \sqrt{n}\left[\hat F_X(x_0) - F_X(x_0)\right]\overset{d}{\to}N(0, F_X(x_0)(1-F_X(x_0)))
\end{align*}\]</span> Another way of showing this is directly applying the CLT to <span class="math inline">\(\hat F_X(x_0)\)</span>, which is a sample average of Bernoulli random variables.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One place we rely on <span class="math inline">\(\hat F_X(x_0)\)</span> being a “good” estimator is when performing Monte Carlo simulations.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.11 (Simulations and Hypothesis Tests)</strong></span> In <a href="#sec-testing" class="quarto-xref"><span class="quarto-unresolved-ref">sec-testing</span></a> we relied on Monte Carlo simulations to approximate the probability of committing a type I or type II error. This actually relies on the empirical CDF evaluated at a point! Suppose <span class="math inline">\(H_0:\mu  \le \mu_0\)</span> and <span class="math inline">\(H_1: \mu &gt; \mu_0\)</span>, where <span class="math inline">\(X_i \overset{iid}{\sim}N(0,1)\)</span> for a sample size of <span class="math inline">\(n=1000\)</span>, <span class="math inline">\(\mu = 0\)</span>, and <span class="math inline">\(\mu_0 = 0\)</span>. We can test this using the decision rule <span class="math inline">\(\delta(\mathbf{X}) = I[T(\mathbf{X}) \ge 1.645]\)</span> where the decision space is <span class="math inline">\(\mathcal A = \{0,1\}\)</span>. We have <span class="math display">\[ \Pr(\text{correct decision}) = \Pr(\delta(\mathbf{X}) = 0) = \Pr(T(\mathbf{X}) &lt; 1.645) = F_T(1.645),\]</span> so we can estimate the probability we make the correct decision using <span class="math inline">\(\hat F_T(1.645)\)</span>. If we simulate <span class="math inline">\(N\)</span> decisions (uppercase <span class="math inline">\(N\)</span> here, as <span class="math inline">\(n\)</span> is the sample size used to calculate our test statistic) then <span class="math display">\[ \hat F_T(1.645) = \frac{1}{N}\sum_{k=1}^NI[T(\mathbf{X}) &lt; 1.645] \]</span> for simulations <span class="math inline">\(k=1,\ldots,N\)</span>. We will set <span class="math inline">\(N = 1000\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-33_ae5a8b34a89b1a02f259ca5d4931e04b">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>T_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(X, mu_0){</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(X)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> (<span class="fu">mean</span>(X)<span class="sc">-</span>mu_0)<span class="sc">/</span>(<span class="fu">sd</span>(X)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(mu_0, n, dist, dist_params, t){</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> t, </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">T_stat =</span> <span class="fu">T_stat</span>(X, mu_0)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(x, N, mu_0, n, dist, dist_params, s){</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">mu_0 =</span> mu_0, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">ecdf_x =</span> <span class="fu">mean</span>(T_stat <span class="sc">&lt;</span> x)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">iter_num =</span> s)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="dv">100-1</span>), <span class="fl">1e3</span>, <span class="dv">0</span>, <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>ecdf_x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.949</code></pre>
</div>
</div>
<p>Our estimate is close to the true value of <span class="math inline">\(0.95\)</span>! Now let’s repeat this <span class="math inline">\(M=10,000\)</span> times to get <span class="math inline">\(10,000\)</span> simulated values of <span class="math inline">\(\hat F_T(1.645)\)</span>.<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a></p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-34_2ee4c90c1e68c212c7f0ca7394deea77">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>outer_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(M, x, N, mu_0, n, dist, dist_params){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a> output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">map</span>(sim, <span class="at">x =</span> x, <span class="at">N =</span> N, <span class="at">mu_0 =</span> mu_0, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">bind_rows</span>()</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(output)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">outer_sim</span>(<span class="fl">1e4</span>, <span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="dv">100-1</span>), <span class="fl">1e3</span>, <span class="dv">0</span>, <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In theory, we have <span class="math display">\[\begin{align*}
\text{E}\left[\hat F_T(1.645)\right] &amp;= F_T(1.645) = 0.95,\\
\text{Var}\left(\hat F_T(1.645)\right) &amp; = \frac{1}{N}\cdot F_T(1.645)\cdot\left[1-F_T(1.645)\right] = \frac{0.95(1-0.95)}{1000} = 4.75\times 10^{-5},
\end{align*}\]</span> so we should see the sample mean and sample variance of our estimates come close to these values.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-35_58a69f86fa49339981db9b062ec4e14c">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(ecdf_x),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">variance =</span> <span class="fu">var</span>(ecdf_x)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
   mean  variance
  &lt;dbl&gt;     &lt;dbl&gt;
1 0.950 0.0000474</code></pre>
</div>
</div>
<p>Finally, we should see these estimates (approximately) follow a normal distribution.</p>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot514_9d44c6ce5145e39021783f22566ffc9d">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ecdf_x)) <span class="sc">+</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">2e-3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.95</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>( (<span class="fl">0.95</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.95</span>)<span class="sc">/</span><span class="dv">1000</span> )), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Empricial CDF evaluated at 1.645"</span>, <span class="at">y =</span> <span class="st">"Probability Density"</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot514" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot514-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot514-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot514-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.17: Histogram of simulated values along with the asymptotic distribution given in Theorem 5.2.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.12 (Simulations with Consistent Estimators)</strong></span> In <a href="#exm-lln1" class="quarto-xref">Example&nbsp;<span class="quarto-unresolved-ref">exm-lln1</span></a> we actually used the empirical CDF evaluated at a point to show that <span class="math inline">\(\bar X\overset{p}{\to}\mu\)</span>, it was just hidden behind the vague wording “observed probability”. Using the full definition of convergence in probability, the LLN states <span class="math display">\[ \lim_{n\to\infty} \Pr\left(\left\lvert\bar X -\mu\right\rvert &gt; \varepsilon\right) = 0.\]</span> Let’s fix <span class="math inline">\(n = 100\)</span> and <span class="math inline">\(\varepsilon = 0.1\)</span>, and draw <span class="math inline">\(n\)</span> observations of <span class="math inline">\(X\sim F_X\)</span> to calculate <span class="math inline">\(\bar X\)</span>. If we repeat this <span class="math inline">\(N\)</span> times we have <span class="math inline">\(N\)</span> realized values of <span class="math inline">\(\bar X\)</span>, giving <span class="math inline">\(N\)</span> realized values of <span class="math inline">\(\left\lvert\bar X -\mu\right\rvert &gt; \varepsilon\)</span>. We can now estimate the probability that <span class="math inline">\(\Pr\left(\left\lvert\bar X -\mu\right\rvert &gt; \varepsilon\right)\)</span>.</p>
<p><span class="math display">\[\begin{align*}
\hat{\Pr}\left(\left\lvert\bar X -\mu\right\rvert &gt; \varepsilon\right) &amp;= 1 - \hat{\Pr}\left(\left\lvert\bar X -\mu\right\rvert \le \varepsilon\right) = 1 - \hat{F}_{\left\lvert\bar X-\mu\right\rvert}(\varepsilon) = 1 - \frac{1}{N}\sum_{i = 1}^N I\left[\left\lvert\bar X -\mu\right\rvert \le \varepsilon\right].
\end{align*}\]</span></p>
<p>Let’s do this for <span class="math inline">\(N = 1,000\)</span> and <span class="math inline">\(X\sim N(0,1)\)</span>.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-37_4d7498ee33cd8870d0589893284a5873">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>draw_X_bar <span class="ot">&lt;-</span> <span class="cf">function</span>(n, dist, dist_params, t){</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">mean</span>(X),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> t,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> n</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>F_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(N, epsilon, mu, n, dist, dist_params){</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(draw_X_bar, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate =</span> <span class="fu">sum</span>(<span class="fu">abs</span>(estimate <span class="sc">-</span> mu) <span class="sc">&lt;=</span> epsilon) <span class="sc">/</span> N,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">sample_size =</span> N,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">e =</span> epsilon,</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="fu">F_hat</span>(<span class="fl">1e3</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  estimate sample_size     e
     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
1    0.676        1000   0.1</code></pre>
</div>
</div>
<p>How does this compare to the true value <span class="math inline">\(\hat{F}_{\left\lvert\bar X-\mu\right\rvert}(\varepsilon)\)</span>? We have <span class="math display">\[\begin{align*}
\hat{F}_{\left\lvert\bar X-\mu\right\rvert}(\varepsilon) &amp; = \Pr(\left\lvert\bar X -\mu\right\rvert \le \varepsilon)\\
&amp; = \Pr(\bar X \in [\mu - \varepsilon, \mu + \varepsilon])
&amp; = \Pr(\bar X \le \mu + \varepsilon) - \Pr(\bar X \le \mu - \varepsilon).
\end{align*}\]</span> Since <span class="math inline">\(\bar X \sim N(\mu, \sigma/\sqrt{n})\)</span>, this can be readily calculated.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-38_94e35e253ed8c13551cba046ec598114">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6826895</code></pre>
</div>
</div>
<p>Our estimate for these particular values of <span class="math inline">\(n\)</span> and <span class="math inline">\(\varepsilon\)</span> is spot-on. Going back to <a href="#exm-lln1" class="quarto-xref">Example&nbsp;<span class="quarto-unresolved-ref">exm-lln1</span></a>, we repeat this process for increasingly values of <span class="math inline">\(n\)</span> to show <span class="math inline">\(\Pr\left(\left\lvert\bar X -\mu\right\rvert &gt; \varepsilon\right)\)</span>. This must hold for any <span class="math inline">\(\varepsilon &gt; 0\)</span>, so it’s also helpful to confirm this trend holds for a handful of <span class="math inline">\(\varepsilon\)</span> values.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With the key properties of estimator <span class="math inline">\(\hat F_X(x_0):\mathcal X\to[0,1]\)</span>, let’s now shift gears and consider the empirical distribution function <span class="math inline">\(\hat F:\mathcal X\to \mathcal F\)</span> as an estimator of a random function in the space <span class="math inline">\(\mathcal F\)</span>.</p>
<section id="glivenkocantelli-theorem" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="glivenkocantelli-theorem"><span class="header-section-number">6.4.1</span> Glivenko–Cantelli Theorem</h3>
<p>The first property we’ll establish is consistency. Since the space of distribution functions <span class="math inline">\(\mathcal F\)</span> is comprised entirely by bounded functions, the <em>de facto</em> metric <span class="math inline">\(d(F,G)=\left\lVert F-G\right\rVert_\infty\)</span> is well defined. By Definition 5.2, <span class="math inline">\(\hat F_X\overset{p}{\to}F_X\)</span> if <span class="math display">\[ \lim_{n\to\infty}\Pr\left(\left\lVert\hat F_X-F_X\right\rVert_\infty &gt; \varepsilon \right) = 0\]</span> for all <span class="math inline">\(\varepsilon &gt; 0\)</span>. In other words, we want to show that <span class="math display">\[ \left\lVert\hat F_X-F_X\right\rVert_\infty \overset{p}{\to}0 .\]</span></p>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.3 (Glivenko–Cantelli)</strong></span> The empirical distribution function <span class="math inline">\(\hat F_X:\mathcal X\to[0,1]\)</span> satisfies <span class="math display">\[ \left\lVert\hat F_X-F_X\right\rVert_\infty \overset{as}{\to} 0 \]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>In the event that <span class="math inline">\(X\)</span> is a discrete random variable, then</p>
</div>
<div id="cor-" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 6.1</strong></span> The empirical distribution function <span class="math inline">\(\hat F_X:\mathcal X\to[0,1]\)</span> is a consistent estimator for <span class="math inline">\(F_X\)</span>.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.13</strong></span> To illustrate that <span class="math inline">\(\hat F_X\)</span> is a consistent estimator for <span class="math inline">\(F_X\)</span>, the first thing we need to do is get a sense of what <span class="math inline">\(\left\lVert\hat F_X-F_X\right\rVert_\infty\)</span> “looks like”. For the entirety of this example, we’ll just assume that <span class="math inline">\(X_i\sim N(0,1)\)</span>. To calculate <span class="math inline">\(\left\lVert\hat F_X-F_X\right\rVert_\infty\)</span>, we need to find the supremum of <span class="math inline">\(\left\lvert\hat F_X(x)-F_X(x)\right\rvert\)</span> over the set <span class="math inline">\(\mathcal X = \mathbb{R}\)</span>. This is not only impossible because the supremum may not be attained, but also because we cannot compute an uncountably infinite number of values. Instead, we’ll take a discretized version of the problem as an approximation. If we calculate <span class="math inline">\(\left\lVert\hat F_X-F_X\right\rVert_\infty\)</span> at <span class="math inline">\(J\)</span> values <span class="math inline">\(\{x_1,\ldots,x_J\}\subseteq \mathbb{R}\)</span>, then we can use the approximation <span class="math display">\[\left\lVert\hat F_X-F_X\right\rVert_\infty\approx \max_{x_1,\ldots,x_j} \left\lvert\hat F_X(x)-F_X(x)\right\rvert\]</span> for a large value of <span class="math inline">\(J\)</span>. To see this approximation in action, we’ll draw <span class="math inline">\(n=1,000\)</span> values of <span class="math inline">\(X_i\)</span> to calculate <span class="math inline">\(\hat F_X\)</span> on the discrete domain of the <span class="math inline">\(J=100,000\)</span> evenly spaced points between <span class="math inline">\(-4\)</span> and <span class="math inline">\(4\)</span>.<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a></p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-39_afb423365bd34e0a664cd27a8a064a91">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>F_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(t, X){</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(X <span class="sc">&lt;</span> t)<span class="sc">/</span><span class="fu">length</span>(X)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>norm <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X){</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># given dist, define quantile function</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  qdist <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    rnorm <span class="sc">%&gt;%</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">substitute</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_replace</span>(<span class="st">"r"</span>, <span class="st">"q"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">do.call</span>(<span class="fu">list</span>(x))</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define upper and lower bound of domain using qdist </span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">qdist</span>(<span class="dv">0</span>) <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span>){</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">=</span> <span class="fu">qdist</span>(<span class="fl">1e-7</span>)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">=</span> <span class="fu">qdist</span>(<span class="dv">0</span>)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">qdist</span>(<span class="dv">1</span>) <span class="sc">==</span> <span class="cn">Inf</span>){</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">=</span> <span class="fu">qdist</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">1e-7</span>)</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">=</span> <span class="fu">qdist</span>(<span class="dv">1</span>)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># discretize domain into N points</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  domain <span class="ot">&lt;-</span> <span class="fu">seq</span>(lower, upper, <span class="at">length =</span> N)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    domain,</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_hat =</span> <span class="fu">map_dbl</span>(domain, F_hat, <span class="at">X =</span> X),</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_0 =</span> <span class="fu">pnorm</span>(domain)</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">difference =</span> F_hat <span class="sc">-</span> F_0,</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">distance =</span> <span class="fu">abs</span>(F_hat <span class="sc">-</span> F_0)</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  norm <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">max</span>(distance)) <span class="sc">%&gt;%</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  attained_at <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(distance <span class="sc">==</span> <span class="fu">max</span>(distance)) <span class="sc">%&gt;%</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(domain) <span class="sc">%&gt;%</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"norm"</span> <span class="ot">=</span> norm,</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"norm_attained_at"</span> <span class="ot">=</span> attained_at,</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span> <span class="ot">=</span> df</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">norm</span>(<span class="fl">1e6</span>, <span class="fu">rnorm</span>(<span class="fl">1e3</span>))</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$norm
[1] 0.03877185

$norm_attained_at
[1] -0.3847046</code></pre>
</div>
</div>
<p>Now let’s visualize what this looks like by comparing <span class="math inline">\(\hat F_X\)</span> and <span class="math inline">\(F_X\)</span>, along with showing the values of <span class="math inline">\(\left\lvert\hat F_X(x)-F_X(x)\right\rvert\)</span> that we took the maximum of.</p>
<div class="cell" data-layout-align="center" data-fig.asp="1.2" data-hash="adv_asymptotics_cache/html/fig-plot515_071f41a6a1de634d8ef28eb1be6012f8">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> results<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Empirical Distribution, F_hat</span><span class="st">`</span> <span class="ot">=</span> F_hat,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Actual Distribution, F</span><span class="st">`</span> <span class="ot">=</span> F_0</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>distance, <span class="sc">-</span>difference) <span class="sc">%&gt;%</span> </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>domain) <span class="sc">%&gt;%</span> </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(domain, value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"t"</span>, <span class="at">y =</span> <span class="st">"Pr(X &lt; t)"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> results<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(domain, difference)) <span class="sc">+</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"t"</span>, <span class="at">y =</span> <span class="st">"F - F_hat"</span>) <span class="sc">+</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> results<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(domain, distance)) <span class="sc">+</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> results<span class="sc">$</span>norm_attained_at, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> results<span class="sc">$</span>norm_attained_at, <span class="at">yend =</span> results<span class="sc">$</span>norm),</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> results<span class="sc">$</span>norm_attained_at, <span class="at">y  =</span>results<span class="sc">$</span>norm, <span class="at">xend =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">yend =</span> results<span class="sc">$</span>norm),</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"t"</span>, <span class="at">y =</span> <span class="st">"|F - F_hat|"</span>) <span class="sc">+</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, plot3, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot515" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot515-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot515-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot515-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.18: test
</figcaption>
</figure>
</div>
</div>
</div>
<p>We’ll now repeat this process <em>many</em> times, letting sample size grow for each drawn sample.</p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-41_4e2b2a80a4d657f2c72485ea61753e62">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X, k){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> X[<span class="dv">1</span><span class="sc">:</span>k]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">norm_val =</span> <span class="fu">norm</span>(N, sample)<span class="sc">$</span>norm,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> k</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(n_vals, N, dist, dist_params, s){</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(<span class="fu">max</span>(n_vals), dist_params))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> n_vals <span class="sc">%&gt;%</span> </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">N =</span> N, <span class="at">X =</span> X) <span class="sc">%&gt;%</span> </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">iter_num =</span> s)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>outer_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(M, n_vals, N, dist, dist_params){</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(sim, <span class="at">n_vals =</span> n_vals, <span class="at">N =</span> N, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">outer_sim</span>(<span class="fl">1e4</span>, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">1e3</span>, <span class="at">length =</span> <span class="dv">20</span>), <span class="fl">1e2</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we plot the results of our simulation, we see that as <span class="math inline">\(n\to\infty\)</span>, it appears that the proportion of lines “far away” from zero shrinks. In other words, the probability that <span class="math inline">\(\left\lVert\hat F_X-F_X\right\rVert_\infty &gt;  \varepsilon\)</span> shrinks as <span class="math inline">\(n\to\infty\)</span>.</p>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot516_3d20e6d39f6b45c6796ed709cddd233e">
<details class="code-fold">
<summary>Show code which generates figure.</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sample_size, norm_val)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">linewidth =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Size, n"</span>, <span class="at">y =</span> <span class="st">"sup|F - F_hat|"</span>) <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot516" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot516-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot516-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot516-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.19: Approximate values of the norm of the difference between the empirical distribution and true distribution calculated for 10,000 simulations.
</figcaption>
</figure>
</div>
</div>
</div>
<p>But we’re not done yet! We can go a step further here by estimating the probability that <span class="math inline">\(\left\lVert\hat F_X-F_X\right\rVert_\infty &gt;  \varepsilon\)</span> by estimating the empirical distribution function of <span class="math inline">\(\left\lVert\hat F_X-F_X\right\rVert_\infty\)</span> at the point <span class="math inline">\(\varepsilon\)</span>!</p>
<p><span class="math display">\[\begin{align*}
\widehat\Pr\left(\left\lVert\hat F_X-F_X\right\rVert_\infty &gt;  \varepsilon \right) &amp;= 1 - \widehat\Pr\left(\left\lVert\hat F_X-F_X\right\rVert_\infty \le  \varepsilon \right) = 1 - \hat F_{\left\lVert\hat F_X-F_X\right\rVert_\infty}(\varepsilon)
\end{align*}\]</span></p>
<p>This amounts to finding the proportion of lines which fall outside the interval <span class="math inline">\([0,\varepsilon)\)</span> for a particular sample size. Since this probability should approach zero for all <span class="math inline">\(\varepsilon &gt;0\)</span>, we’ll estimate these probabilities at a handful of values of <span class="math inline">\(\varepsilon\)</span>.</p>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot517_70ce82ba6aa67bd5aa2eb59c4a937d2e">
<details class="code-fold">
<summary>Show code which generates figure.</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">e =</span> (<span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample_size, e) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">prob =</span> <span class="fu">mean</span>(norm_val <span class="sc">&gt;</span> e)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sample_size, prob, <span class="at">color =</span> <span class="fu">as.factor</span>(e))) <span class="sc">+</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"ε"</span>, <span class="at">y =</span> <span class="st">"Pr(Norm &gt; ε)"</span>, <span class="at">x =</span> <span class="st">"Sample Size, n"</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot517" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot517-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot517-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot517-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.20: The empirical probability that the norm in question is “far” from zero shrinks as sample size grows.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="donskers-theorem" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="donskers-theorem"><span class="header-section-number">6.4.2</span> Donsker’s Theorem</h3>
<p><a href="#sec-dist" class="quarto-xref"><span class="quarto-unresolved-ref">sec-dist</span></a> explored what it meant for a stochastic process to converge in distribution. If the process <span class="math inline">\(\hat F_X\)</span> is so important, it stands to reason that people have established whether or not <span class="math inline">\(\hat F_x\)</span> converges weakly. It in fact does, and this is the content of Donsker’s Theorem which is also known as the “functional” central limit theorem or the invariance principle.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; To arrive at the result, let’s start with the simple setting of <span class="math inline">\(X\overset{iid}{\sim}\text{Uni}(0,1)\)</span> and apply <a href="#thm-spconv" class="quarto-xref">Theorem&nbsp;<span class="quarto-unresolved-ref">thm-spconv</span></a> to <span class="math inline">\(\sqrt{n}(\hat F_X - F_X)\)</span>. For ease we will denote this process as <span class="math inline">\(s_n\)</span> and simplify its expression. <span class="math display">\[\begin{align*}
S_n(t) &amp;= \sqrt{n}(\hat F_X(t) - F_X(t))\\
&amp;= \sqrt{n}\left(\frac{1}{n}\sum_{i=1}^n 1[X_i\le t] - t\right) &amp; (F_X(t) = t)\\
&amp; =  \sqrt{n}\left(\frac{1}{n}\sum_{i=1}^n 1[X_i\le t] - \frac{1}{n}\sum_{i=1}^n t\right) &amp; \left(\frac{1}{n}\sum_{i=1}^n t = t\right)\\
&amp; = \frac{1}{\sqrt n}\sum_{i=1}^n\left(1[X_i\le t] - t\right)\\
&amp; = \frac{1}{\sqrt n}\sum_{i=1}^nU_i(t) &amp; (U_i(t) = 1[X_i\le t] - t).
\end{align*}\]</span> Let <span class="math inline">\(t_1,\ldots,t_k\)</span> be an arbitrary set of points in <span class="math inline">\([0,1]\)</span>. We can verify that the first condition of <a href="#thm-spconv" class="quarto-xref">Theorem&nbsp;<span class="quarto-unresolved-ref">thm-spconv</span></a> is met by applying the multivariate CLT to <span class="math inline">\((U_i(t_1),\ldots,U_i(t_k))\)</span>.<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a> For any <span class="math inline">\(t_\ell\)</span> we have <span class="math display">\[\begin{align*}
\text{E}\left[U_i(t_\ell)\right] = \text{E}\left[1[X_i\le t_\ell] - t_\ell\right] = \text{E}\left[1[X_i\le t_\ell]\right] - t_\ell = \Pr(X_i\le t_\ell) - t_i = t_\ell - t_\ell = 0.
\end{align*}\]</span> For any two <span class="math inline">\(t_\ell,t_j\)</span> in our arbitrary set of points in <span class="math inline">\([0,1]\)</span> we have <span class="math display">\[\begin{align*}
\text{Var}\left(\begin{bmatrix}U_i(t_\ell)\\U_i(t_j) \end{bmatrix}\right) &amp; = \text{E}\left[\left(\begin{bmatrix}U_i(t_\ell)\\U_i(t_j) \end{bmatrix} -\text{E}\left[\begin{bmatrix}U_i(t_\ell)\\U_i(t_j) \end{bmatrix}\right]\right)\left(\begin{bmatrix}U_i(t_\ell)\\U_i(t_j) \end{bmatrix} -\text{E}\left[\begin{bmatrix}U_i(t_\ell)\\U_i(t_j) \end{bmatrix}\right]\right)'\right]\\
&amp; = \text{E}\left[\begin{bmatrix}U_i(t_\ell)\\U_i(t_j) \end{bmatrix}\begin{bmatrix}U_i(t_\ell)\\U_i(t_j) \end{bmatrix}'\right] &amp; (\text{E}\left[U_i(t)\right] = 0\ \forall t\in [0,1])\\
&amp; = \begin{bmatrix} \text{E}\left[U_i(t_\ell)^2\right] &amp;\text{E}\left[U_i(t_\ell)U_i(t_j)\right] \\ \text{E}\left[U_i(t_\ell)U_i(t_j)\right]&amp; \text{E}\left[U_i(t_j)^2\right] \end{bmatrix}\\
\end{align*}\]</span></p>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-44_1270775e715c2a1fb29b27f0f0f3f407">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>emp_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, n){</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(sample[<span class="dv">1</span><span class="sc">:</span>n] <span class="sc">&lt;</span> x) <span class="sc">/</span> n)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">Vectorize</span>(output))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, n, domain){</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> domain, </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_hat =</span> <span class="fu">emp_cdf</span>(sample, n)(domain),</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> n</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(n_vals, domain, sample_size, dist, dist_params){</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(sample_size, dist_params))</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> n_vals <span class="sc">%&gt;%</span> </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">sample =</span> X, <span class="at">domain =</span> domain) <span class="sc">%&gt;%</span> </span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">F_true =</span> <span class="fu">punif</span>(x),</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">scaled_centered =</span> <span class="fu">sqrt</span>(n)<span class="sc">*</span>(F_hat <span class="sc">-</span> F_true)</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="dv">10</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="dv">100</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="fl">1e3</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">*</span><span class="fl">1e4</span>), <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="fl">1e3</span>), <span class="fl">1e5</span>, runif, <span class="fu">list</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot518_b9318aeb7978431b3c82d8fab335f8cf">
<details class="code-fold">
<summary>Show code which generates figure.</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results  <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Actual Distribution</span><span class="st">`</span> <span class="ot">=</span> F_true,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Empirical Distribution</span><span class="st">`</span> <span class="ot">=</span> F_hat</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(x,n)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"scaled_centered"</span>, <span class="st">"Scaled Difference, √n(F_hat - F_0)"</span>, <span class="st">"Distribution"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, value, <span class="at">color =</span> name)) <span class="sc">+</span> </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(n) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Sample Size: {closest_state}'</span>) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="hypothesis-testing" class="level3" data-number="6.4.3">
<h3 data-number="6.4.3" class="anchored" data-anchor-id="hypothesis-testing"><span class="header-section-number">6.4.3</span> Hypothesis Testing</h3>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-46_254627f14c1617c0f726d65c557286ba">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>emp_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(sample){</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(sample <span class="sc">&lt;</span> x) <span class="sc">/</span> n)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">Vectorize</span>(output))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(domain, n, dist, dist_params, t){</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> domain,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">emp_cdf</span>(X)(domain) <span class="sc">-</span> <span class="fu">punif</span>(domain))),</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> t</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">norm =</span> <span class="fu">max</span>(value))</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(N, domain, n, dist, dist_params){</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">domain =</span> domain, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e3</span>, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="fl">1e3</span>), <span class="fl">1e3</span>, runif, <span class="fu">list</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.7" data-hash="adv_asymptotics_cache/html/fig-plot519_23ea0dc6e818a9b8683a375fb9872f4c">
<details class="code-fold">
<summary>Show code which generates figure.</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>norms <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    iter_num, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> norm</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"norm"</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, value)) <span class="sc">+</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> norms, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num, <span class="at">transition_length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"|√n(F_hat - F_0)|"</span>) </span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot519" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot519-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="adv_asymptotics_files/figure-html/fig-plot519-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot519-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.21: 10
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-48_614cc8525321c8c1a62c532d0ed8f544">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    iter_num,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    norm</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(norm)) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">15</span>)  <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="adv_asymptotics_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-49_cbe3d0ae6867ad48adf2369b10cb37d3">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>pkolg <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x <span class="sc">&lt;=</span> <span class="dv">0</span>){</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">1-2</span><span class="sc">*</span><span class="fu">sum</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>((<span class="dv">1</span><span class="sc">:</span>k)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span>k)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="adv_asymptotics_cache/html/unnamed-chunk-50_06cd7b09d6c61d4aecbec9c59dce2811">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">sort</span>(x)) <span class="sc">-</span> (<span class="dv">0</span> <span class="sc">:</span> (n<span class="dv">-1</span>)) <span class="sc">/</span> n</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(x2, <span class="dv">1</span><span class="sc">/</span>n <span class="sc">-</span> x2))</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x, <span class="st">"pnorm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  x
D = 0.13302, p-value = 0.05808
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>D</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1330247</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pkolg</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>D)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05807679</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>kolg_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, dist){</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>https://github.com/SurajGupta/r-source/blob/master/src/library/stats/src/ks.c</p>
<p>https://github.com/SurajGupta/r-source/blob/master/src/library/stats/R/ks.test.R</p>
<p><span class="math display">\[\begin{align*}
F_D(x) &amp;= 1 - 2\sum_{k=1}^\infty(-1)^{k-1}\exp(-2k^2x^2)\\
f_D(x) &amp; = 8\sum_{k=1}^\infty(-1)^{k-1}xk^2\exp(-2k^2x^2)
\end{align*}\]</span></p>
</section>
</section>
<section id="further-reading" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="further-reading"><span class="header-section-number">6.5</span> Further Reading</h2>
<p><span class="citation" data-cites="newey1991uniform">Newey (<a href="#ref-newey1991uniform" role="doc-biblioref">1991</a>)</span>, <span class="citation" data-cites="hansen2022probability">Hansen (<a href="#ref-hansen2022probability" role="doc-biblioref">2022</a>)</span> chapter 18, <span class="citation" data-cites="billingsleycon">Billingsley (<a href="#ref-billingsleycon" role="doc-biblioref">2013</a>)</span>, <span class="citation" data-cites="billingsley2008probability">Billingsley (<a href="#ref-billingsley2008probability" role="doc-biblioref">2008</a>)</span>, <span class="citation" data-cites="pollard2012convergence">Pollard (<a href="#ref-pollard2012convergence" role="doc-biblioref">2012</a>)</span>, <span class="citation" data-cites="durbin1973distribution">Durbin (<a href="#ref-durbin1973distribution" role="doc-biblioref">1973</a>)</span></p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-andrews1994empirical" class="csl-entry" role="listitem">
Andrews, Donald WK. 1994. <span>“Empirical Process Methods in Econometrics.”</span> <em>Handbook of Econometrics</em> 4: 2247–94.
</div>
<div id="ref-billingsley2008probability" class="csl-entry" role="listitem">
Billingsley, Patrick. 2008. <em>Probability and Measure</em>. John Wiley &amp; Sons.
</div>
<div id="ref-billingsleycon" class="csl-entry" role="listitem">
———. 2013. <em>Convergence of Probability Measures</em>. John Wiley &amp; Sons.
</div>
<div id="ref-durbin1973distribution" class="csl-entry" role="listitem">
Durbin, James. 1973. <em>Distribution Theory for Tests Based on the Sample Distribution Function</em>. SIAM.
</div>
<div id="ref-glasserman2004monte" class="csl-entry" role="listitem">
Glasserman, Paul. 2004. <em>Monte Carlo Methods in Financial Engineering</em>. Vol. 53. Springer.
</div>
<div id="ref-hansen2022probability" class="csl-entry" role="listitem">
Hansen, Bruce E. 2022. <em>Probability and Statistics for Economists</em>. Princeton University Press.
</div>
<div id="ref-newey1991uniform" class="csl-entry" role="listitem">
Newey, Whitney K. 1991. <span>“Uniform Convergence in Probability and Stochastic Equicontinuity.”</span> <em>Econometrica: Journal of the Econometric Society</em>, 1161–67.
</div>
<div id="ref-pollard2012convergence" class="csl-entry" role="listitem">
Pollard, David. 2012. <em>Convergence of Stochastic Processes</em>. Springer Science &amp; Business Media.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>We’re brushing over how products of sets play with sigma-algebras here, but the underlying math isn’t trivial.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This notation is not standard, but eliminates a great deal of ambiguity when working with random matrices and vectors.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>We usually suppress the argument of a random variable, but in this case it’s helpful to illustrate the additional time dimension.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>In general, the process of translating a function of two arguments to a function that takes on values in a space of functions is called “currying”. For example, define <span class="math inline">\(f:\mathbb{R}^2\to \mathbb{R}\)</span> as <span class="math inline">\(f(x,y)=x+y\)</span>. We can write this as <span class="math inline">\((g(x))(y)\)</span> where <span class="math inline">\(g:\mathbb{R}\to \mathbb{R}^{\mathbb{R}}\)</span>. If we fix an input like <span class="math inline">\(x=2\)</span>, we have <span class="math inline">\((g(2))(y)=2+y\)</span>, which is an element of <span class="math inline">\(\mathbb{R}^{\mathbb{R}}\)</span> since <span class="math inline">\(g(2):\mathbb{R}\to \mathbb{R}\)</span>. This works for general sets since the set of functions from <span class="math inline">\(X\times Y\)</span> to <span class="math inline">\(Z\)</span>, written as <span class="math inline">\(Z^{X\times Y}\)</span>, is isomorphic to the set <span class="math inline">\((Z^Y)^X\)</span>. <span class="math display">\[Z^{X\times Y}\cong (Z^Y)^X\]</span><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The distribution corresponding to this random variable is known as the Rademacher distribution.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Rather, the first 20 terms of the random sequence.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>An interesting feature of this figure is that it emphasizes the combinatorial nature of a random walk. At time <span class="math inline">\(t=20\)</span> we’ve flipped the coin 20 times, with each flip having 2 outcomes. This means there are <span class="math inline">\(2^{20}\)</span> possible paths the random walk can take.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The term “Brownian motion” is often used in place of “Wiener process”.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>See Section 37 of <span class="citation" data-cites="billingsley2008probability">Billingsley (<a href="#ref-billingsley2008probability" role="doc-biblioref">2008</a>)</span> for a proof.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>If we wanted to graph <span class="math inline">\(f(x) = \sqrt x\)</span> on <span class="math inline">\([0,1]\)</span>, we would need to evaluate <span class="math inline">\(f(x)\)</span> at many points in <span class="math inline">\([0,1]\)</span> and then plot the results. <em>Technically</em> we’re approximating the graph of <span class="math inline">\(f(x)\)</span> via linear interpolation between the points at which we evaluated <span class="math inline">\(f\)</span> using <code>geom_line()</code>. It just happens that it’s easy to pick such a sufficiently large number of points to evaluate <span class="math inline">\(f\)</span> at that we get the desired graph of <span class="math inline">\(f\)</span>.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Of course as we look at smaller and smaller intervals, the number of discrete points used to visualize the process will shrink, so the path may not appear quite as “jagged”.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>Reference to john cook article<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>Sometimes the definition is given for separable metric spaces (also known as Polish spaces). This additional assumption gives some convenient topological properties.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>I’m using “largest” loosely here because it’s possible that this value isn’t attained which is why we use the supremum.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>The definition is readily extended to a general stochastic process.<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>It’s actually almost immediate from the definition of integration with respect to a measure.<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>This is not at all a technical approach to defining this space. For a rigorous approach, look up “Skorokhod space”.<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>The nesting of simulations may be a little confusing here. We’re drawing <span class="math inline">\(n\)</span> realizations of <span class="math inline">\(X_i\)</span> to calculate one value of <span class="math inline">\(T(\mathbf{X})\)</span>. We then repeat this <span class="math inline">\(N\)</span> times to get <span class="math inline">\(N\)</span> values of <span class="math inline">\(T(\mathbf{X})\)</span> to calculate one value of <span class="math inline">\(\hat F_T(1.645)\)</span>, so we’ve drawn <span class="math inline">\(n*N\)</span> values of <span class="math inline">\(X_i\)</span>. Now we want to repeat <em>all of this</em> <span class="math inline">\(M\)</span> times to get <span class="math inline">\(M\)</span> values of <span class="math inline">\(\hat F_T(1.645)\)</span>, so we’ve drawn <span class="math inline">\(n\times N\times M\)</span> values of <span class="math inline">\(X_i\)</span>!<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>Since $(X_i ) $, our discrete approximation doesn’t lose much accuracy from clipping the tails of the sample space.<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>We’ll simply generalize the proof of Theorem 5.2<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stochastic.html" class="pagination-link" aria-label="Stochastic Processes">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Stochastic Processes</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ols.html" class="pagination-link" aria-label="The Classical Linear Model">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The Classical Linear Model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb62" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>\DeclareMathOperator{\plim}{plim}</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>\DeclareMathOperator{\argmin}{argmin}</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>\DeclareMathOperator{\argmax}{argmax}</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>\newcommand{\var}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{Var}\left(#1\right)}</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>\newcommand{\avar}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{Avar}\left(#1\right)}</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>\newcommand{\E}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{E}\left<span class="co">[</span><span class="ot">#1\right</span><span class="co">]</span>}</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>\newcommand{\cov}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{Cov}\left(#1\right)}</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>\newcommand{\mse}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{MSE}\left(#1\right)}</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>\newcommand{\se}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{se}\left(#1\right)}</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>\newcommand{\limfunc}{lim} </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>\newcommand{\X}{\mathbf{X}}</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>\newcommand{\Xm}{\mathbb{X}}</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>\newcommand{\EER}{\bar{\thet}_\text{EE}}</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>\newcommand{\NLS}{\hat{\bet}_\text{NLLS}}</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>\newcommand{\z}{\mathbf{z}}</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>\newcommand{\rr}{\mathbf{r}}</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>\newcommand{\C}{\mathbf{C}}</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>\newcommand{\Pe}{\mathbf{P}}</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>\newcommand{\y}{\mathbf{y}}</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>\newcommand{\Y}{\mathbf{Y}}</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>\newcommand{\uu}{\mathbf{u}}</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>\newcommand{\e}{\mathbf{e}}</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>\newcommand{\D}{\mathbf{D}}</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>\newcommand{\x}{\mathbf{x}}</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>\newcommand{\xm}{\mathbb{x}}</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>\newcommand{\Zm}{\mathbb{Z}}</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>\newcommand{\Wm}{\mathbb{W}}</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>\newcommand{\Hm}{\mathbb{H}}</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>\newcommand{\W}{\mathbf{W}}</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>\newcommand{\Z}{\mathbf{Z}}</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>\newcommand{\Hess}{\mathbf{H}(\mathbf{\Z\mid\thet})}</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>\newcommand{\Score}{\mathbf{S}(\mathbf{\Z\mid\thet})}</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>\newcommand{\A}{\mathbf{A}}</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>\newcommand{\h}{\mathbf{h}}</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>\newcommand{\Q}{\mathbf{Q}}</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>\newcommand{\F}{\mathbf{F}}</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>\newcommand{\G}{\mathbf{G}}</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>\newcommand{\I}{\mathbf{I}}</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>\renewcommand{\D}{\mathbf{D}}</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>\renewcommand{\C}{\mathbf{C}}</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>\newcommand{\zer}{\mathbf{0}}</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>\newcommand{\OLS}{\hat{\boldsymbol\beta}_\text{OLS} }</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>\newcommand{\OLSOV}{\hat{\boldsymbol\beta}_\text{OLS,OV} }</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>\newcommand{\OLSME}{\hat{\boldsymbol\beta}_\text{OLS,ME} }</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>\newcommand{\EE}{\hat{\boldsymbol\theta}_\text{EX} }</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>\newcommand{\ME}{\hat{\boldsymbol\theta}_\text{M} }</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>\newcommand{\MDE}{\hat{\boldsymbol\theta}_\text{MDE} }</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>\newcommand{\IV}{\hat{\boldsymbol\beta}_\text{IV} }</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>\newcommand{\TSLS}{\hat{\boldsymbol\beta}_\text{2SLS} }</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>\newcommand{\thet}{\boldsymbol{\theta}}</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>\newcommand{\et}{\boldsymbol{\eta}}</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>\newcommand{\R}{\mathbb{R}}</span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>\newcommand{\Sig}{\boldsymbol{\Sigma}}</span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>\newcommand{\ep}{\boldsymbol{\varepsilon}}</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>\newcommand{\Omeg}{\boldsymbol{\Omega}}</span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a>\newcommand{\Thet}{\boldsymbol{\Theta}}</span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a>\newcommand{\bet}{\boldsymbol{\beta}}</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>\newcommand{\rk}{rank}</span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a>\newcommand{\tsum}{\sum}</span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a>\newcommand{\tr}{tr}</span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a>\newcommand{\norm}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\left\lVert#1\right\rVert}</span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a>\newcommand{\abs}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\left\lvert#1\right\rvert}</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>\newcommand{\ms}{\overset{ms}{\to}}</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a>\newcommand{\pto}{\overset{p}{\to}}</span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a>\newcommand{\iid}{\overset{iid}{\sim}}</span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a>\newcommand{\dto}{\overset{d}{\to}}</span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>\newcommand{\asim}{\overset{a}{\sim}}</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a><span class="fu"># Advanced Asymptotics</span></span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb62-78"><a href="#cb62-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-84"><a href="#cb62-84" aria-hidden="true" tabindex="-1"></a>@sec-asy provided a crash course in asymptotic statistics that can get you pretty far in econometrics. Still there are certain situations where we need a more abstract and general understanding of stochastic convergence. The purpose of this chapter is to give a painfully brief introduction to the convergence of random variables defined on metric spaces, and discuss some of the related applications. </span>
<span id="cb62-85"><a href="#cb62-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-86"><a href="#cb62-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reviewing More Probability Theory</span></span>
<span id="cb62-87"><a href="#cb62-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-88"><a href="#cb62-88" aria-hidden="true" tabindex="-1"></a>Given a probability space $(\mathcal X, \mathcal F, P)$ and a set $E$ equipped with a sigma-algebra $\mathcal E$, a random variable is some function $X:\mathcal X\to E$ such that $X^{-1}(I) \in \mathcal F$ for all $I\in \mathcal E$. Until now, we've only dealt with the case $E = \R$ and $\mathcal E = \mathcal B(\R)$, so let's look at random variables on other spaces. In particular, we're interested in random variables defined on metric spaces. </span>
<span id="cb62-89"><a href="#cb62-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-90"><a href="#cb62-90" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-91"><a href="#cb62-91" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random Vectors</span></span>
<span id="cb62-92"><a href="#cb62-92" aria-hidden="true" tabindex="-1"></a>We've been interpreting a random vector $\X = (X_1,\ldots,X_n)$ as a collection of $n$ random scalars $X_1:\mathcal X_1\to E_1,\ldots,X_n:\mathcal X_n\to E_n$. Alternatively, we could consider $\X$ to be a random variable mapping $\mathcal X_1\times\cdots\times \mathcal X_n$ to $E^n$.^<span class="co">[</span><span class="ot">We're brushing over how products of sets play with sigma-algebras here, but the underlying math isn't trivial.</span><span class="co">]</span> A special case of this is when we draw a sample of $n$ observations of $X_i \iid F_X$. If we execute ```rnorm(10)```, it will return $n$ realizations of $X:\R\to\R$ which can also be interpreted as one realization of a random vector $\X:\R^{10}\to\R^{10}$. Whether you think of the resulting data as 10 realizations of iid random variables or a single random vector will depend on the application. It's usually easier to model problems with random vectors when random scalars aren't iid. If we have $X_1 \sim N(0,1)$, $X_2 \sim N(1,2)$, and $\cov{X_1, X_2} = 1$, then all the information about $X_1$ and $X_2$ can easily be summarized by $\X = (X_1,X_2)$ where $$\X \sim N\left(\begin{bmatrix} 0<span class="sc">\\</span> 1\end{bmatrix}, \begin{bmatrix} 1 &amp; 1<span class="sc">\\</span> 1 &amp; 2\end{bmatrix}\right)$$</span>
<span id="cb62-93"><a href="#cb62-93" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-94"><a href="#cb62-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-95"><a href="#cb62-95" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-96"><a href="#cb62-96" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random Matrices</span></span>
<span id="cb62-97"><a href="#cb62-97" aria-hidden="true" tabindex="-1"></a>We can combine random vectors into a single random matrix just like we combined random scalars into a random vector. For the sake of ease, we'll only consider real valued random vectors here. Suppose we have $k$ random vectors $\X_1,\ldots,\X_k$, each of length $n$. We can form a $n\times k$ matrix using these vectors as column vectors. We'll denote this random matrix with $\Xm$.^<span class="co">[</span><span class="ot">This notation is not standard, but eliminates a great deal of ambiguity when working with random matrices and vectors.</span><span class="co">]</span> </span>
<span id="cb62-98"><a href="#cb62-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-99"><a href="#cb62-99" aria-hidden="true" tabindex="-1"></a>$$\Xm = \begin{bmatrix}\X_1 &amp; \cdots &amp;\X_k \end{bmatrix} =  \begin{bmatrix}X_{11} &amp; \cdots &amp;X_{k1} <span class="sc">\\</span> \vdots &amp; \ddots &amp; \vdots<span class="sc">\\</span> X_{1n} &amp; \cdots &amp;X_{kn} \end{bmatrix}$$ In this case, the random variable $\Xm$ takes on a value in the set of all $n\times k$ real matrices, $\R^{n\times k}$. We could also consider $\Xm$ to be comprised of $n$ random vectors of length $k$. </span>
<span id="cb62-100"><a href="#cb62-100" aria-hidden="true" tabindex="-1"></a>$$ \Xm = \begin{bmatrix}\X_1<span class="sc">\\</span> \vdots <span class="sc">\\</span> \X_k \end{bmatrix}.$$ This interpretation is particularly important when considering regression models where we observe $n$ realizations of $k$ regressors $X_1,\ldots,X_k$.</span>
<span id="cb62-101"><a href="#cb62-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-102"><a href="#cb62-102" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-103"><a href="#cb62-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-104"><a href="#cb62-104" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A random object we've yet to talk about are stochastic processes. These will make for an excellent example in abstracting random variables beyond $\R$.</span></span>
<span id="cb62-105"><a href="#cb62-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-106"><a href="#cb62-106" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb62-107"><a href="#cb62-107" aria-hidden="true" tabindex="-1"></a>Given a probability space $(\mathcal X, \mathcal F, P)$, suppose we have a collection of random variables $<span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in T}$ indexed by some set $T$ which take on values in the measurable space $(S, \mathcal S)$. The collection $\{X_t\}_{t\in T}$ is a [***stochastic process***]{style="color:red"}. We refer to $S$ as the [***state space***]{style="color:red"} and $T$ as the [***index set***]{style="color:red"}. If $T = \mathbb N$ then $\{X_t\}_{t\in T}$ is a <span class="co">[</span><span class="ot">***discrete-time stochastic process***</span><span class="co">]</span>{style="color:red"}. If $T = \R^+$ <span class="co">[</span><span class="ot">***continuous-time stochastic process***</span><span class="co">]</span>{style="color:red"}</span>
<span id="cb62-108"><a href="#cb62-108" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-109"><a href="#cb62-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-110"><a href="#cb62-110" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The index set is almost always denoted by $T$ because the main application of stochastic processes is modeling the evolution of random phenomena over time periods $t\in T$. Each value $t\in T$ is mapped to a random variable $X_t$, which takes on a realized value $X_t(\omega)\in S$ for some outcome $\omega\in\mathcal X$.^[We usually suppress the argument of a random variable, but in this case it's helpful to illustrate the additional time dimension.] Since $X_t$ is indexed by $T$, we can actually think of a stochastic process as a function $t\mapsto X_t$, and opt to write $X(t)$ or $X(t,\omega)$.^[In general, the process of translating a function of two arguments to a function that takes on values in a space of functions is called "currying". For example, define $f:\R^2\to \R$ as $f(x,y)=x+y$. We can write this as $(g(x))(y)$ where $g:\R\to \R^{\R}$. If we fix an input like $x=2$, we have $(g(2))(y)=2+y$, which is an element of $\R^{\R}$ since $g(2):\R\to \R$. This works for general sets since the set of functions from $X\times Y$ to $Z$, written as $Z^{X\times Y}$, is isomorphic to the set $(Z^Y)^X$. $$Z^{X\times Y}\cong (Z^Y)^X$$] This interpretation is how we'll be able to define a stochastic process as a random variable.</span></span>
<span id="cb62-111"><a href="#cb62-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-112"><a href="#cb62-112" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-113"><a href="#cb62-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stochastic Processes as RVs</span></span>
<span id="cb62-114"><a href="#cb62-114" aria-hidden="true" tabindex="-1"></a>Given a state space $S$ and an index set $T$, consider the set $S^T$ of all functions mapping $T$ to $S$. A stochastic process $<span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in T}$ defined on the probability space $(\mathcal X, \mathcal F, P)$ is a random variable $X:\mathcal X\to S^T$. One realization of $X(\omega)\in S^T$ is a function from $T$ to $S$. In the event that $T =\mathbb N$, $S^\mathbb N$ is the set of sequences in $S$, as a sequence in $S$ is just a function which assigns natural numbers to the elements of $S$. This means that $X:\mathcal X\to S^{\mathbb N}$ is a random sequence. We often refer to realizations of stochastic processes as sample paths to emphasize the additional dimension given by $T$.</span>
<span id="cb62-115"><a href="#cb62-115" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-116"><a href="#cb62-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-117"><a href="#cb62-117" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-118"><a href="#cb62-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple Random Walk</span></span>
<span id="cb62-119"><a href="#cb62-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-120"><a href="#cb62-120" aria-hidden="true" tabindex="-1"></a>Suppose we have a sequence of iid random variables $Y_1,Y_2,\ldots$ defined on the sample space $<span class="sc">\{</span>-1,1<span class="sc">\}</span>$ such that $\Pr(Y_t = 1) = p$ and $\Pr(Y_t = -1) = 1-p$ for all $t$. We can think of $Y_t$ as a modified Bernoulli random variable where a "failure" corresponds to the value $-1$ instead of $0$.^<span class="co">[</span><span class="ot">The distribution corresponding to this random variable is known as the Rademacher distribution.</span><span class="co">]</span> Using the sequence $Y_t$ we can define a new sequence of random variables $X_t$ as </span>
<span id="cb62-121"><a href="#cb62-121" aria-hidden="true" tabindex="-1"></a>$$ X_t = \sum_{i=1}^t Y_i.$$ The sequence $X_n$ is a random walk. The name is due to a thought experiment corresponding to $Y_n$ and $X_n$. Suppose someone is standing at a reference point (the origin $0$) at time $t=0$. At $t=1$ they flip a coin. If the flip results in a head they will take one step forward, but if the flip results in a tail they will take a step backwards. This is repeated for $t=2,3,\ldots$. The outcome of the coin flip at time $t$ corresponds to the random variable $Y_t$. At any time $t$, the person's position relative to the reference points is given as $X_t$. Instead of considering $X_1,X_2,\ldots$ to be a sequence of separate random variables, we can think of $X=(X_1,X_2,\ldots)$ to be a single random variable defined on the space $\mathbb Z^{\mathbb N}$. Let's look at one realized value of $X$ taking $p = 1/2$,^<span class="co">[</span><span class="ot">Rather, the first 20 terms of the random sequence.</span><span class="co">]</span> in which case our random walk is symmetric.</span>
<span id="cb62-122"><a href="#cb62-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-125"><a href="#cb62-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-126"><a href="#cb62-126" aria-hidden="true" tabindex="-1"></a>random_walk <span class="ot">&lt;-</span> <span class="cf">function</span>(n, dist, dist_params, t){</span>
<span id="cb62-127"><a href="#cb62-127" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb62-128"><a href="#cb62-128" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">step =</span> X) <span class="sc">%&gt;%</span></span>
<span id="cb62-129"><a href="#cb62-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb62-130"><a href="#cb62-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">time =</span> <span class="fu">row_number</span>(),</span>
<span id="cb62-131"><a href="#cb62-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">cumsum</span>(step),</span>
<span id="cb62-132"><a href="#cb62-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> t</span>
<span id="cb62-133"><a href="#cb62-133" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb62-134"><a href="#cb62-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(</span>
<span id="cb62-135"><a href="#cb62-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">time =</span> <span class="dv">0</span>,</span>
<span id="cb62-136"><a href="#cb62-136" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="dv">0</span>,</span>
<span id="cb62-137"><a href="#cb62-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> t,</span>
<span id="cb62-138"><a href="#cb62-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">.before =</span> <span class="dv">0</span></span>
<span id="cb62-139"><a href="#cb62-139" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-140"><a href="#cb62-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-141"><a href="#cb62-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-142"><a href="#cb62-142" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-143"><a href="#cb62-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-144"><a href="#cb62-144" aria-hidden="true" tabindex="-1"></a>rredmacher <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p){</span>
<span id="cb62-145"><a href="#cb62-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p, p)))</span>
<span id="cb62-146"><a href="#cb62-146" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-147"><a href="#cb62-147" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">random_walk</span>(<span class="dv">20</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>), <span class="dv">1</span>)</span>
<span id="cb62-148"><a href="#cb62-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-149"><a href="#cb62-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-152"><a href="#cb62-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-153"><a href="#cb62-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-154"><a href="#cb62-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-155"><a href="#cb62-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot51</span></span>
<span id="cb62-156"><a href="#cb62-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb62-157"><a href="#cb62-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-158"><a href="#cb62-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-159"><a href="#cb62-159" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "One simulated realization of a random walk"</span></span>
<span id="cb62-160"><a href="#cb62-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-161"><a href="#cb62-161" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb62-162"><a href="#cb62-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>iter_num) <span class="sc">%&gt;%</span> </span>
<span id="cb62-163"><a href="#cb62-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>time) <span class="sc">%&gt;%</span> </span>
<span id="cb62-164"><a href="#cb62-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"step"</span>, <span class="st">"position"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Step Y_t"</span>, <span class="st">"Position X_t"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-165"><a href="#cb62-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb62-166"><a href="#cb62-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb62-167"><a href="#cb62-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb62-168"><a href="#cb62-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-169"><a href="#cb62-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb62-170"><a href="#cb62-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(time, <span class="at">transition_length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb62-171"><a href="#cb62-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>() <span class="sc">+</span></span>
<span id="cb62-172"><a href="#cb62-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time, t"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb62-173"><a href="#cb62-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-174"><a href="#cb62-174" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb62-175"><a href="#cb62-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-176"><a href="#cb62-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-177"><a href="#cb62-177" aria-hidden="true" tabindex="-1"></a>Since this is just one realization, it's analogous to illustrating a random variable with a standard normal distribution with a histogram of a single value generated by <span class="in">`rnorm(n = 1)`</span>. Let's look at 1,000 simulated realizations of our random walk $X=(X_1,X_2,\ldots)$.^<span class="co">[</span><span class="ot">An interesting feature of this figure is that it emphasizes the combinatorial nature of a random walk. At time $t=20$ we've flipped the coin 20 times, with each flip having 2 outcomes. This means there are $2^{20}$ possible paths the random walk can take.</span><span class="co">]</span> </span>
<span id="cb62-178"><a href="#cb62-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-179"><a href="#cb62-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-182"><a href="#cb62-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-183"><a href="#cb62-183" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(N, n, dist, dist_params){</span>
<span id="cb62-184"><a href="#cb62-184" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span>  </span>
<span id="cb62-185"><a href="#cb62-185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(random_walk, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb62-186"><a href="#cb62-186" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb62-187"><a href="#cb62-187" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-188"><a href="#cb62-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-189"><a href="#cb62-189" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-190"><a href="#cb62-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-191"><a href="#cb62-191" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e3</span>, <span class="dv">20</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>))</span>
<span id="cb62-192"><a href="#cb62-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-193"><a href="#cb62-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-196"><a href="#cb62-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-197"><a href="#cb62-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-198"><a href="#cb62-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-199"><a href="#cb62-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot52</span></span>
<span id="cb62-200"><a href="#cb62-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-201"><a href="#cb62-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-202"><a href="#cb62-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-203"><a href="#cb62-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1,000 simulated realizations of the random walk."</span></span>
<span id="cb62-204"><a href="#cb62-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-205"><a href="#cb62-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-206"><a href="#cb62-206" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb62-207"><a href="#cb62-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb62-208"><a href="#cb62-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">factor</span>(iter_num))) <span class="sc">+</span></span>
<span id="cb62-209"><a href="#cb62-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-210"><a href="#cb62-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb62-211"><a href="#cb62-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb62-212"><a href="#cb62-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Position"</span>) </span>
<span id="cb62-213"><a href="#cb62-213" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-214"><a href="#cb62-214" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb62-215"><a href="#cb62-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-216"><a href="#cb62-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-217"><a href="#cb62-217" aria-hidden="true" tabindex="-1"></a>We can also investigate the individual terms of the random sequence $X = (X_1,X_2,\ldots)$ by treating them like their own random variables defined on $\mathbb Z$. For 100,000 simulated realizations of $X$, let's look at the distribution of the realized values of $X_1$, $X_{10}$, $X_{20}$, and $X_{30}$.</span>
<span id="cb62-218"><a href="#cb62-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-221"><a href="#cb62-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-222"><a href="#cb62-222" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e5</span>, <span class="dv">30</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-223"><a href="#cb62-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>))</span>
<span id="cb62-224"><a href="#cb62-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-225"><a href="#cb62-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-226"><a href="#cb62-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-229"><a href="#cb62-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-230"><a href="#cb62-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-231"><a href="#cb62-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot53</span></span>
<span id="cb62-232"><a href="#cb62-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-233"><a href="#cb62-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-234"><a href="#cb62-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-235"><a href="#cb62-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of simulated positions at various times."</span></span>
<span id="cb62-236"><a href="#cb62-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-237"><a href="#cb62-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-238"><a href="#cb62-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-239"><a href="#cb62-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-240"><a href="#cb62-240" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-241"><a href="#cb62-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, position) <span class="sc">%&gt;%</span> </span>
<span id="cb62-242"><a href="#cb62-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fl">1e5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-243"><a href="#cb62-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"t = 1"</span>, <span class="st">"t =10"</span>, <span class="st">"t = 20"</span>, <span class="st">"t = 30"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-244"><a href="#cb62-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(position, freq)) <span class="sc">+</span></span>
<span id="cb62-245"><a href="#cb62-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-246"><a href="#cb62-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">xend =</span> position, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> freq)) <span class="sc">+</span></span>
<span id="cb62-247"><a href="#cb62-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>time) <span class="sc">+</span></span>
<span id="cb62-248"><a href="#cb62-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-249"><a href="#cb62-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"position"</span>, <span class="at">y =</span> <span class="st">"frequency"</span>)</span>
<span id="cb62-250"><a href="#cb62-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-251"><a href="#cb62-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-252"><a href="#cb62-252" aria-hidden="true" tabindex="-1"></a>It is no coincidence that as $t$ increases, the distribution of $X_t$ appears to resemble a normal distribution. To show this we'll need to find the probability mass function of $X_t$ which gives $\Pr(X_t = x)$ for $x\in<span class="sc">\{</span>-t,-t+1,\ldots,t-1,t<span class="sc">\}</span>\subset \mathbb Z$. First note that the probability that $k$ steps forward and $t-k$ steps backwards are taken follows a binomial distribution, since $I(Y_i = 1)\sim \text{Ber}(p)$. </span>
<span id="cb62-253"><a href="#cb62-253" aria-hidden="true" tabindex="-1"></a>$$ \Pr(\textstyle\sum_{i=1}^t I(Y_i = 1)) = \binom{t}{k}p^k(1-p)^{t-k}$$</span>
<span id="cb62-254"><a href="#cb62-254" aria-hidden="true" tabindex="-1"></a>We can write the number of steps forward $k$ in position $x$ by noting that $x = k - (t-k) = 2k-t,$ so $k = (t+x)/2$.</span>
<span id="cb62-255"><a href="#cb62-255" aria-hidden="true" tabindex="-1"></a>$$f_{X_t}(x \mid t, p) = \binom{t}{(t+x)/2}p^{(t+x)/2}(1-p)^{t-(t+x)/2}.$$</span>
<span id="cb62-256"><a href="#cb62-256" aria-hidden="true" tabindex="-1"></a>Since $X_t$ follows a variant of the binomial distribution, as $t\to\infty$ the normal approximation of the binomial distribution holds with increasing accuracy. The parameters of this normal distribution are given by the expected value and variance of $X_t$. These are</span>
<span id="cb62-257"><a href="#cb62-257" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-258"><a href="#cb62-258" aria-hidden="true" tabindex="-1"></a>\E{X_t} &amp;= \E{\sum_{i=1}^t Y_i} <span class="sc">\\</span>&amp;= \sum_{i=1}^t \E{Y_i} &amp; (\E{\cdot}\text{ linear})<span class="sc">\\</span> &amp;= t\left<span class="co">[</span><span class="ot">p\cdot 1 + (1-p)(-1) \right</span><span class="co">]</span> &amp; (Y_i\text{ iid})<span class="sc">\\</span> &amp; = t(2p-1)<span class="sc">\\</span></span>
<span id="cb62-259"><a href="#cb62-259" aria-hidden="true" tabindex="-1"></a>\var{X_t} &amp;= \var{\sum_{i=1}^t Y_i}<span class="sc">\\</span></span>
<span id="cb62-260"><a href="#cb62-260" aria-hidden="true" tabindex="-1"></a>        &amp; = \sum_{i=1}^t \var{Y_i} &amp; (Y_i\text{ iid})<span class="sc">\\</span></span>
<span id="cb62-261"><a href="#cb62-261" aria-hidden="true" tabindex="-1"></a>        &amp; = t\left<span class="co">[</span><span class="ot">\E{Y_i^2} - \E{Y_i}^2\right</span><span class="co">]</span> <span class="sc">\\</span> </span>
<span id="cb62-262"><a href="#cb62-262" aria-hidden="true" tabindex="-1"></a>        &amp; = t<span class="co">[</span><span class="ot">1 - (2p-1)^2</span><span class="co">]</span> &amp; (Y_i^2 = 1)<span class="sc">\\</span></span>
<span id="cb62-263"><a href="#cb62-263" aria-hidden="true" tabindex="-1"></a>        &amp; = 4tp(1-p)</span>
<span id="cb62-264"><a href="#cb62-264" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-265"><a href="#cb62-265" aria-hidden="true" tabindex="-1"></a>If $p = 1/2$ and $t = 100$, we should expect that the distribution of $X_t$ resembles $N(0,100)$. </span>
<span id="cb62-266"><a href="#cb62-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-269"><a href="#cb62-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-270"><a href="#cb62-270" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e5</span>, <span class="dv">100</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-271"><a href="#cb62-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb62-272"><a href="#cb62-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-273"><a href="#cb62-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-276"><a href="#cb62-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-277"><a href="#cb62-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-278"><a href="#cb62-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot54</span></span>
<span id="cb62-279"><a href="#cb62-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-280"><a href="#cb62-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-281"><a href="#cb62-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-282"><a href="#cb62-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Position of random walk at time t=100 for 100,000 simulations with a normal distribution with µ=0 and σ=10 overlaid."</span></span>
<span id="cb62-283"><a href="#cb62-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-284"><a href="#cb62-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-285"><a href="#cb62-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-286"><a href="#cb62-286" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb62-287"><a href="#cb62-287" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb62-288"><a href="#cb62-288" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-289"><a href="#cb62-289" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-290"><a href="#cb62-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(position)) <span class="sc">+</span></span>
<span id="cb62-291"><a href="#cb62-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">colour =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">binwidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb62-292"><a href="#cb62-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-293"><a href="#cb62-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> t<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>p <span class="sc">-</span> <span class="dv">1</span>), <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">*</span>t<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb62-294"><a href="#cb62-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">x =</span> <span class="st">"Random Walk Position at t=100"</span>)</span>
<span id="cb62-295"><a href="#cb62-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-296"><a href="#cb62-296" aria-hidden="true" tabindex="-1"></a>This entire examples happens to be just one very stylized example of a random walk. There exists numerous interesting extensions with valuable applications.</span>
<span id="cb62-297"><a href="#cb62-297" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-298"><a href="#cb62-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-299"><a href="#cb62-299" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-300"><a href="#cb62-300" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wiener Process</span></span>
<span id="cb62-301"><a href="#cb62-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-302"><a href="#cb62-302" aria-hidden="true" tabindex="-1"></a>The most famous random function is the the Wiener process. This continuous-time stochastic process plays a key role in physics as it's a mathematical formalization of Brownian motion.^<span class="co">[</span><span class="ot">The term "Brownian motion" is often used in place of "Wiener process".</span><span class="co">]</span> Brownian motion refers to the behavior of particles that are continuously moving randomly about. For instance, gas molecules move rapidly about colliding with other molecules, resulting in seemingly random movement. Formally, the Weiner process $W = <span class="sc">\{</span>W_t<span class="sc">\}</span>_{t\in \R^+}$ is a random variable $W:\mathcal X\to C( \R^+)$ for some probability space $(\mathcal X, \mathcal F, P)$ where $C( \R^+)$ is the set of all real continuous functions defined on the unit interval $ \R^+$.\The process $\{W_t\}_{t\in \R^+}$ satisfies:</span>
<span id="cb62-303"><a href="#cb62-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-304"><a href="#cb62-304" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$W_0 = 0$. The process' initial value at time $t=0$ is always $0$.</span>
<span id="cb62-305"><a href="#cb62-305" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>For all $t\in \R^+$, $W_{t+u} - W_t \perp W_s$ for $u \ge 0$ and $s &lt; t$. The process has independent increments. In other words, the "movement" of the process between times $t$ and $t+u$ is independent of the processes location prior to $t$ (at time $s$). Another way to think of this property is that the process is "memoryless" in the sense that future movement of the process only depends on its current position and not how it got to that position.</span>
<span id="cb62-306"><a href="#cb62-306" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>For all $t\in \R^+$, $W_{t+u}-W_t\sim N(0,u)$ for $u \ge 0$. This is equivalent to $W_t - W_s \sim N(0,t-s)$ for $s\le t$, which can also be written as $W_t-W_s\sim \sqrt{t-s}\cdot N(0,1)$</span>
<span id="cb62-307"><a href="#cb62-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-308"><a href="#cb62-308" aria-hidden="true" tabindex="-1"></a>A fourth property that we've implicitly assumed by defining $W$ to be a $C( \R^+)$-valued random variable is that $W$ is continuous. *A priori*, it isn't obvious that there exists a process which satisfies all of these properties, but we will take its existence as given.^<span class="co">[</span><span class="ot">See Section 37 of @billingsley2008probability for a proof.</span><span class="co">]</span> </span>
<span id="cb62-309"><a href="#cb62-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-310"><a href="#cb62-310" aria-hidden="true" tabindex="-1"></a>One of the limitations of turning to simulations to illlustrate $W$ is that we aren't able to graph a truly continuous (non-linear) function on a computer.^<span class="co">[</span><span class="ot">If we wanted to graph $f(x) = \sqrt x$ on $[0,1]$, we would need to evaluate $f(x)$ at many points in $[0,1]$ and then plot the results. *Technically* we're approximating the graph of $f(x)$ via linear interpolation between the points at which we evaluated $f$ using `geom_line()`. It just happens that it's easy to pick such a sufficiently large number of points to evaluate $f$ at that we get the desired graph of $f$.</span><span class="co">]</span> You may be thinking" "well no duh, this is obvious! Why are you bringing up something so basic and trivial?" It's worth emphasizing because this entire example is meant to illustrate a continuous stochastic process, which unfortunately we need to do by simulating a discrete analog. Suppose we have $N$ evenly spaced points in $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$, such that time increments are $dt = 1/N$. We have </span>
<span id="cb62-311"><a href="#cb62-311" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-312"><a href="#cb62-312" aria-hidden="true" tabindex="-1"></a>W_0 &amp; = 0,<span class="sc">\\</span></span>
<span id="cb62-313"><a href="#cb62-313" aria-hidden="true" tabindex="-1"></a>W_j &amp; = W_{j-1} + dW_{j}, &amp; (j = 1,\ldots, N)<span class="sc">\\</span></span>
<span id="cb62-314"><a href="#cb62-314" aria-hidden="true" tabindex="-1"></a>dW_j &amp; \iid N(0, dt).</span>
<span id="cb62-315"><a href="#cb62-315" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-316"><a href="#cb62-316" aria-hidden="true" tabindex="-1"></a>We'll set $N = 1\times10^7$, which is such a large value that we'll be able to just treat $W$ as if it was truly continuous. Let's simulate a single realization of $W$.</span>
<span id="cb62-317"><a href="#cb62-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-320"><a href="#cb62-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-321"><a href="#cb62-321" aria-hidden="true" tabindex="-1"></a><span class="co"># draw one realization of wiener process</span></span>
<span id="cb62-322"><a href="#cb62-322" aria-hidden="true" tabindex="-1"></a><span class="co">#   N = number of discrete points to calculate process at</span></span>
<span id="cb62-323"><a href="#cb62-323" aria-hidden="true" tabindex="-1"></a><span class="co">#   T_max = maximum time value to calculate process at</span></span>
<span id="cb62-324"><a href="#cb62-324" aria-hidden="true" tabindex="-1"></a><span class="co">#   s = parameter to iterate over if we want to draw multiple realizations</span></span>
<span id="cb62-325"><a href="#cb62-325" aria-hidden="true" tabindex="-1"></a>wiener <span class="ot">&lt;-</span> <span class="cf">function</span>(N, T_max, s){</span>
<span id="cb62-326"><a href="#cb62-326" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> T_max<span class="sc">/</span>N</span>
<span id="cb62-327"><a href="#cb62-327" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-328"><a href="#cb62-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">dW =</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> <span class="fu">sqrt</span>(dt)),</span>
<span id="cb62-329"><a href="#cb62-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">seq</span>(dt, T_max, dt),</span>
<span id="cb62-330"><a href="#cb62-330" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s</span>
<span id="cb62-331"><a href="#cb62-331" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-332"><a href="#cb62-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">cumsum</span>(dW)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-333"><a href="#cb62-333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">value =</span> <span class="dv">0</span>, <span class="at">time =</span> <span class="dv">0</span>, <span class="at">iter_num =</span> s, <span class="at">.before =</span> <span class="dv">0</span>)</span>
<span id="cb62-334"><a href="#cb62-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-335"><a href="#cb62-335" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-336"><a href="#cb62-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-337"><a href="#cb62-337" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">wiener</span>(<span class="fl">1e5</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb62-338"><a href="#cb62-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-339"><a href="#cb62-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-342"><a href="#cb62-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-343"><a href="#cb62-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-344"><a href="#cb62-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot55</span></span>
<span id="cb62-345"><a href="#cb62-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-346"><a href="#cb62-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-347"><a href="#cb62-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-348"><a href="#cb62-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "One realization of the Wiener process on the unit interval [0,1]."</span></span>
<span id="cb62-349"><a href="#cb62-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-350"><a href="#cb62-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-351"><a href="#cb62-351" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-352"><a href="#cb62-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb62-353"><a href="#cb62-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb62-354"><a href="#cb62-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-355"><a href="#cb62-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">"Value of W at t"</span>) </span>
<span id="cb62-356"><a href="#cb62-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-357"><a href="#cb62-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-358"><a href="#cb62-358" aria-hidden="true" tabindex="-1"></a>Since $W$ is continuous it's defined for all values in the interval $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$, so we can "zoom" in on increasingly small subsets of $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$, and $W$ will still be defined for all $t$.^<span class="co">[</span><span class="ot">Of course as we look at smaller and smaller intervals, the number of discrete points used to visualize the process will shrink, so the path may not appear quite as "jagged".</span><span class="co">]</span>  </span>
<span id="cb62-359"><a href="#cb62-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-362"><a href="#cb62-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-363"><a href="#cb62-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-364"><a href="#cb62-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot56</span></span>
<span id="cb62-365"><a href="#cb62-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-366"><a href="#cb62-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb62-367"><a href="#cb62-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-368"><a href="#cb62-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "``Zooming in'' on the Wiener process."</span></span>
<span id="cb62-369"><a href="#cb62-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-370"><a href="#cb62-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-371"><a href="#cb62-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-372"><a href="#cb62-372" aria-hidden="true" tabindex="-1"></a>zoom_in <span class="ot">&lt;-</span> <span class="cf">function</span>(W, t){</span>
<span id="cb62-373"><a href="#cb62-373" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb62-374"><a href="#cb62-374" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(time <span class="sc">&lt;=</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb62-375"><a href="#cb62-375" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb62-376"><a href="#cb62-376" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_time =</span> t,</span>
<span id="cb62-377"><a href="#cb62-377" aria-hidden="true" tabindex="-1"></a>      <span class="at">zoom_factor =</span> <span class="dv">1</span><span class="sc">/</span>t</span>
<span id="cb62-378"><a href="#cb62-378" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-379"><a href="#cb62-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-380"><a href="#cb62-380" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-381"><a href="#cb62-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-382"><a href="#cb62-382" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-383"><a href="#cb62-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(zoom_in, <span class="at">W =</span> results) <span class="sc">%&gt;%</span> </span>
<span id="cb62-384"><a href="#cb62-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-385"><a href="#cb62-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb62-386"><a href="#cb62-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb62-387"><a href="#cb62-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(zoom_factor) <span class="sc">+</span></span>
<span id="cb62-388"><a href="#cb62-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view_follow</span>() <span class="sc">+</span></span>
<span id="cb62-389"><a href="#cb62-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-390"><a href="#cb62-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">"Value of W at t"</span>)</span>
<span id="cb62-391"><a href="#cb62-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-392"><a href="#cb62-392" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">nframes =</span> <span class="dv">300</span>)</span>
<span id="cb62-393"><a href="#cb62-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-394"><a href="#cb62-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-395"><a href="#cb62-395" aria-hidden="true" tabindex="-1"></a>Note that as we "zoom in" the sample path has the same jagged appearance of $W$ on all of $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$. This is because the Wiener process is closely linked to the idea of a fractal.^<span class="co">[</span><span class="ot">Reference to john cook article</span><span class="co">]</span> Another interesting feature is that $W$ is nowhere differentiable despite being continuous on account of it being comprised of an infinite number of "kinks".</span>
<span id="cb62-396"><a href="#cb62-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-397"><a href="#cb62-397" aria-hidden="true" tabindex="-1"></a>Now that we've seen one sample path, let's draw 100 realizations of $W$ to get a sense of the relative frequency of certain paths.</span>
<span id="cb62-398"><a href="#cb62-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-401"><a href="#cb62-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-402"><a href="#cb62-402" aria-hidden="true" tabindex="-1"></a>draw_wiener <span class="ot">&lt;-</span> <span class="cf">function</span>(M, N, T_max){</span>
<span id="cb62-403"><a href="#cb62-403" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb62-404"><a href="#cb62-404" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(wiener, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max) <span class="sc">%&gt;%</span> </span>
<span id="cb62-405"><a href="#cb62-405" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() </span>
<span id="cb62-406"><a href="#cb62-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-407"><a href="#cb62-407" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-408"><a href="#cb62-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-409"><a href="#cb62-409" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener</span>(<span class="fl">1e2</span>, <span class="fl">1e4</span>, <span class="dv">1</span>)</span>
<span id="cb62-410"><a href="#cb62-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-411"><a href="#cb62-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-414"><a href="#cb62-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-415"><a href="#cb62-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-416"><a href="#cb62-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot57</span></span>
<span id="cb62-417"><a href="#cb62-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-418"><a href="#cb62-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-419"><a href="#cb62-419" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-420"><a href="#cb62-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1,000 simulated realizations of the Wiener process"</span></span>
<span id="cb62-421"><a href="#cb62-421" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-422"><a href="#cb62-422" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-423"><a href="#cb62-423" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb62-424"><a href="#cb62-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb62-425"><a href="#cb62-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb62-426"><a href="#cb62-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-427"><a href="#cb62-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb62-428"><a href="#cb62-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb62-429"><a href="#cb62-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb62-430"><a href="#cb62-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-431"><a href="#cb62-431" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb62-432"><a href="#cb62-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-433"><a href="#cb62-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-434"><a href="#cb62-434" aria-hidden="true" tabindex="-1"></a>Another way to visualize these realizations is by looking at the distribution of the simulated values of $W$ at various values of $t$. Since $W_t - W_s \sim N(0, t-s)$ and $W_0 = 0$, we should expect that $$W_t = W_t - 0  = W_t - W_0 \sim N(0,t-0) = N(0,t).$$</span>
<span id="cb62-435"><a href="#cb62-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-438"><a href="#cb62-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-439"><a href="#cb62-439" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw one realization of wiener process at times t (approximately)</span></span>
<span id="cb62-440"><a href="#cb62-440" aria-hidden="true" tabindex="-1"></a>wiener_t <span class="ot">&lt;-</span> <span class="cf">function</span>(N, T_max, t, s){ </span>
<span id="cb62-441"><a href="#cb62-441" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-442"><a href="#cb62-442" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">wiener</span>(N, T_max, s)</span>
<span id="cb62-443"><a href="#cb62-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-444"><a href="#cb62-444" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pick the values where W_t is calculated that are closest to the times of interest</span></span>
<span id="cb62-445"><a href="#cb62-445" aria-hidden="true" tabindex="-1"></a>  t_filter <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb62-446"><a href="#cb62-446" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb62-447"><a href="#cb62-447" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand_grid</span>(<span class="at">given_t =</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb62-448"><a href="#cb62-448" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dist =</span> <span class="fu">abs</span>(time <span class="sc">-</span> given_t)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-449"><a href="#cb62-449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(given_t) <span class="sc">%&gt;%</span> </span>
<span id="cb62-450"><a href="#cb62-450" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dist <span class="sc">==</span> <span class="fu">min</span>(dist)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-451"><a href="#cb62-451" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-452"><a href="#cb62-452" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb62-453"><a href="#cb62-453" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>()</span>
<span id="cb62-454"><a href="#cb62-454" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-455"><a href="#cb62-455" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb62-456"><a href="#cb62-456" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(time <span class="sc">%in%</span> t_filter) <span class="sc">%&gt;%</span> </span>
<span id="cb62-457"><a href="#cb62-457" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>dW)</span>
<span id="cb62-458"><a href="#cb62-458" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-459"><a href="#cb62-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-460"><a href="#cb62-460" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-461"><a href="#cb62-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-462"><a href="#cb62-462" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw M realizations of wiener process at vector of times t_vals</span></span>
<span id="cb62-463"><a href="#cb62-463" aria-hidden="true" tabindex="-1"></a>draw_wiener_t <span class="ot">&lt;-</span> <span class="cf">function</span>(M, t, T_max, N){</span>
<span id="cb62-464"><a href="#cb62-464" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb62-465"><a href="#cb62-465" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(wiener_t, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max, <span class="at">t =</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb62-466"><a href="#cb62-466" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb62-467"><a href="#cb62-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-468"><a href="#cb62-468" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-469"><a href="#cb62-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-470"><a href="#cb62-470" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(<span class="fl">1e5</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span>
<span id="cb62-471"><a href="#cb62-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-472"><a href="#cb62-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-475"><a href="#cb62-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-476"><a href="#cb62-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-477"><a href="#cb62-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot58</span></span>
<span id="cb62-478"><a href="#cb62-478" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-479"><a href="#cb62-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb62-480"><a href="#cb62-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-481"><a href="#cb62-481" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The top panel shows the density of the Wiener process at 10 fixed times calculated using 100,000 simulations. The bottom panel shows the sample analogs of expectation and variance for the process calculated at the fixed times, along with the theoretical values for comparison."</span></span>
<span id="cb62-482"><a href="#cb62-482" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-483"><a href="#cb62-483" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-484"><a href="#cb62-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-485"><a href="#cb62-485" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb62-486"><a href="#cb62-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> time, <span class="at">group =</span> time)) <span class="sc">+</span></span>
<span id="cb62-487"><a href="#cb62-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges2</span>(<span class="at">scale =</span> <span class="dv">5</span>, <span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">rel_min_height =</span> <span class="fl">0.007</span>) <span class="sc">+</span></span>
<span id="cb62-488"><a href="#cb62-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb62-489"><a href="#cb62-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb62-490"><a href="#cb62-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb62-491"><a href="#cb62-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"W_t"</span>, <span class="at">y =</span> <span class="st">"Time t"</span>)</span>
<span id="cb62-492"><a href="#cb62-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-493"><a href="#cb62-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-494"><a href="#cb62-494" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb62-495"><a href="#cb62-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb62-496"><a href="#cb62-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb62-497"><a href="#cb62-497" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample Mean'</span> <span class="ot">=</span> <span class="fu">mean</span>(value),</span>
<span id="cb62-498"><a href="#cb62-498" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample Variance'</span> <span class="ot">=</span> <span class="fu">var</span>(value)</span>
<span id="cb62-499"><a href="#cb62-499" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-500"><a href="#cb62-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>time) <span class="sc">%&gt;%</span> </span>
<span id="cb62-501"><a href="#cb62-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb62-502"><a href="#cb62-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb62-503"><a href="#cb62-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb62-504"><a href="#cb62-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-505"><a href="#cb62-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb62-506"><a href="#cb62-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb62-507"><a href="#cb62-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-508"><a href="#cb62-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">label=</span> <span class="st">"Var(W_t) = t"</span>) <span class="sc">+</span></span>
<span id="cb62-509"><a href="#cb62-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label=</span> <span class="st">"E[W_t] = 0"</span>) <span class="sc">+</span></span>
<span id="cb62-510"><a href="#cb62-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb62-511"><a href="#cb62-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb62-512"><a href="#cb62-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) </span>
<span id="cb62-513"><a href="#cb62-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-514"><a href="#cb62-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-515"><a href="#cb62-515" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb62-516"><a href="#cb62-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-517"><a href="#cb62-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-518"><a href="#cb62-518" aria-hidden="true" tabindex="-1"></a>For further confirmation that $W_t - W_s \sim N(0, t-s)$, let's calculate the sample variance associated with our realizations of $W_t - W_s$ for all $s,t\in<span class="co">[</span><span class="ot">0.1, 0.2,\ldots,0.9,1</span><span class="co">]</span>$ satisfying $s \le t$.</span>
<span id="cb62-519"><a href="#cb62-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-522"><a href="#cb62-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-523"><a href="#cb62-523" aria-hidden="true" tabindex="-1"></a><span class="co"># For a grid of time values, calculate var_st at each point {(s,t) ∈ t_grid² | s ≤ t} over M simulations</span></span>
<span id="cb62-524"><a href="#cb62-524" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(M, t_grid, T_max, N){</span>
<span id="cb62-525"><a href="#cb62-525" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-526"><a href="#cb62-526" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define function to calculate variance</span></span>
<span id="cb62-527"><a href="#cb62-527" aria-hidden="true" tabindex="-1"></a>  var_st <span class="ot">&lt;-</span> <span class="cf">function</span>(W, s, t){</span>
<span id="cb62-528"><a href="#cb62-528" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(t <span class="sc">==</span> s){</span>
<span id="cb62-529"><a href="#cb62-529" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb62-530"><a href="#cb62-530" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb62-531"><a href="#cb62-531" aria-hidden="true" tabindex="-1"></a>      output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb62-532"><a href="#cb62-532" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(s,t)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-533"><a href="#cb62-533" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(iter_num) <span class="sc">%&gt;%</span> </span>
<span id="cb62-534"><a href="#cb62-534" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">diff =</span> value <span class="sc">-</span> <span class="fu">lag</span>(value, <span class="at">order_by =</span> time)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-535"><a href="#cb62-535" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-536"><a href="#cb62-536" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarize</span>(<span class="fu">var</span>(diff, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-537"><a href="#cb62-537" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb62-538"><a href="#cb62-538" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb62-539"><a href="#cb62-539" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(output)</span>
<span id="cb62-540"><a href="#cb62-540" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb62-541"><a href="#cb62-541" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-542"><a href="#cb62-542" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-543"><a href="#cb62-543" aria-hidden="true" tabindex="-1"></a>  <span class="co"># draw M realizations of W at grid of times</span></span>
<span id="cb62-544"><a href="#cb62-544" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(M, t_grid, T_max, N)</span>
<span id="cb62-545"><a href="#cb62-545" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-546"><a href="#cb62-546" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply var_st to all combinations of times</span></span>
<span id="cb62-547"><a href="#cb62-547" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb62-548"><a href="#cb62-548" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">unique</span>(W<span class="sc">$</span>time),</span>
<span id="cb62-549"><a href="#cb62-549" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">unique</span>(W<span class="sc">$</span>time)</span>
<span id="cb62-550"><a href="#cb62-550" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-551"><a href="#cb62-551" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(s <span class="sc">&lt;=</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb62-552"><a href="#cb62-552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-553"><a href="#cb62-553" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">var =</span> <span class="fu">var_st</span>(W, s, t))</span>
<span id="cb62-554"><a href="#cb62-554" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-555"><a href="#cb62-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-556"><a href="#cb62-556" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-557"><a href="#cb62-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-558"><a href="#cb62-558" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e5</span>, (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span>
<span id="cb62-559"><a href="#cb62-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-560"><a href="#cb62-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-563"><a href="#cb62-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-564"><a href="#cb62-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-565"><a href="#cb62-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot59</span></span>
<span id="cb62-566"><a href="#cb62-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-567"><a href="#cb62-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-568"><a href="#cb62-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-569"><a href="#cb62-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The sample variance associated with W_t - W_s calculated using 100,000 simulations."</span></span>
<span id="cb62-570"><a href="#cb62-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-571"><a href="#cb62-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-572"><a href="#cb62-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-573"><a href="#cb62-573" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-574"><a href="#cb62-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(s,t, <span class="at">fill =</span> var)) <span class="sc">+</span></span>
<span id="cb62-575"><a href="#cb62-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">lwd =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb62-576"><a href="#cb62-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(var,<span class="dv">3</span>)), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb62-577"><a href="#cb62-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-578"><a href="#cb62-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb62-579"><a href="#cb62-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb62-580"><a href="#cb62-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb62-581"><a href="#cb62-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Var(W_t - W_s)"</span>) <span class="sc">+</span></span>
<span id="cb62-582"><a href="#cb62-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.line =</span> <span class="fu">element_blank</span>())</span>
<span id="cb62-583"><a href="#cb62-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-584"><a href="#cb62-584" aria-hidden="true" tabindex="-1"></a>We have $\widehat{\text{Var}}(W_t-W_s) \approx t-s$ as anticipated! Finally, we can provide visual evidence that $W_{t+u} - W_t \perp W_s$ for $u \ge 0$ and $s &lt; t$. We'll let $t = 0.3$, $u=0.1$, and $s = 0.2$.</span>
<span id="cb62-585"><a href="#cb62-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-588"><a href="#cb62-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-589"><a href="#cb62-589" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(<span class="fl">1e5</span>, (<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span>
<span id="cb62-590"><a href="#cb62-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-591"><a href="#cb62-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-594"><a href="#cb62-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-595"><a href="#cb62-595" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-596"><a href="#cb62-596" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot595</span></span>
<span id="cb62-597"><a href="#cb62-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-598"><a href="#cb62-598" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-599"><a href="#cb62-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-600"><a href="#cb62-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100,000 realized values of (W_4 - W_3) plotted against the corresponding 100,000 realized values of W_2."</span></span>
<span id="cb62-601"><a href="#cb62-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-602"><a href="#cb62-602" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-603"><a href="#cb62-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-604"><a href="#cb62-604" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb62-605"><a href="#cb62-605" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.4</span>] <span class="sc">-</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.3</span>],</span>
<span id="cb62-606"><a href="#cb62-606" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.2</span>]</span>
<span id="cb62-607"><a href="#cb62-607" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-608"><a href="#cb62-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb62-609"><a href="#cb62-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-610"><a href="#cb62-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb62-611"><a href="#cb62-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"W_4 - W_3"</span>, <span class="at">y =</span> <span class="st">"W_2"</span>)</span>
<span id="cb62-612"><a href="#cb62-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-613"><a href="#cb62-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-614"><a href="#cb62-614" aria-hidden="true" tabindex="-1"></a>From this figure, the two random variables certainly appear to be independent. </span>
<span id="cb62-615"><a href="#cb62-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-616"><a href="#cb62-616" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-617"><a href="#cb62-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-618"><a href="#cb62-618" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Wiener process is just one instance of a stochastic process that "looks like" a normal distribution at specific points $t\in T$. These types of processes are so special that they are simply known as Gaussian.</span></span>
<span id="cb62-619"><a href="#cb62-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-620"><a href="#cb62-620" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb62-621"><a href="#cb62-621" aria-hidden="true" tabindex="-1"></a>Let $<span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in T}$ be a stochastic process over the state space $\R$. The process is a [***Gaussian process***]{style="color:red"} if for any finite set of indices $t_1,\ldots,t_k\in T$, the random vector $\X = (X_{t_1},\ldots, X_{t_k})$ is distributed according to a multivariate normal distribution. </span>
<span id="cb62-622"><a href="#cb62-622" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-623"><a href="#cb62-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-624"><a href="#cb62-624" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The defining properties of the Wiener process immediately establish it as a Gaussian process. To find the explicit normal distribution referenced in the definition of a Gaussian process we need to calculate the covariance of $W_t$ and $W_s$.</span></span>
<span id="cb62-625"><a href="#cb62-625" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-626"><a href="#cb62-626" aria-hidden="true" tabindex="-1"></a>\cov{W_t,W_s} &amp;= \begin{cases} \cov{W_t-0, W_s} &amp; t &gt; s<span class="sc">\\</span> \cov{W_t, W_s + 0} &amp; s\le t \end{cases} <span class="sc">\\</span>&amp;= \begin{cases} \cov{W_t-W_s+W_s, W_s} &amp; t &gt; s<span class="sc">\\</span> \cov{W_t, W_s + W_t- W_t} &amp; s\le t\end{cases}<span class="sc">\\</span></span>
<span id="cb62-627"><a href="#cb62-627" aria-hidden="true" tabindex="-1"></a>&amp;= \begin{cases} \cov{W_t-W_s, W_s}+\cov{W_s,W_s} &amp; t &gt; s<span class="sc">\\</span> \cov{W_t, W_s-W_t} + \cov{W_t,W_t}&amp; s\le t \end{cases}<span class="sc">\\</span></span>
<span id="cb62-628"><a href="#cb62-628" aria-hidden="true" tabindex="-1"></a>&amp; = \begin{cases} 0 + \var{W_s} &amp; t &gt; s<span class="sc">\\</span> 0 + \var{W_t}&amp; s\le t \end{cases} &amp; (\text{independent increments})<span class="sc">\\</span></span>
<span id="cb62-629"><a href="#cb62-629" aria-hidden="true" tabindex="-1"></a>&amp; = \begin{cases} s &amp; t &gt; s<span class="sc">\\</span> t&amp; s\le t \end{cases}<span class="sc">\\</span></span>
<span id="cb62-630"><a href="#cb62-630" aria-hidden="true" tabindex="-1"></a>&amp; = \min<span class="sc">\{</span>s,t<span class="sc">\}</span></span>
<span id="cb62-631"><a href="#cb62-631" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-632"><a href="#cb62-632" aria-hidden="true" tabindex="-1"></a>Therefore, for any $\mathbf W = (W_{t_1},\ldots, W_{t_k})$ where $t_1,\ldots,t_k \in <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$ we have </span>
<span id="cb62-633"><a href="#cb62-633" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-634"><a href="#cb62-634" aria-hidden="true" tabindex="-1"></a>\mathbf W &amp;\sim N(\zer,\Sig),<span class="sc">\\</span></span>
<span id="cb62-635"><a href="#cb62-635" aria-hidden="true" tabindex="-1"></a>\Sig_{j\ell}&amp;=\begin{cases}t_j &amp; j = \ell <span class="sc">\\</span> \min<span class="sc">\{</span>t_j,t_{\ell}<span class="sc">\}</span> &amp; \text{otherwise} \end{cases}.</span>
<span id="cb62-636"><a href="#cb62-636" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-637"><a href="#cb62-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-638"><a href="#cb62-638" aria-hidden="true" tabindex="-1"></a>Let's look at another example of a Gaussian process by tweaking the Wiener process. </span>
<span id="cb62-639"><a href="#cb62-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-640"><a href="#cb62-640" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-641"><a href="#cb62-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-642"><a href="#cb62-642" aria-hidden="true" tabindex="-1"></a><span class="fu">## Brownian Bridge</span></span>
<span id="cb62-643"><a href="#cb62-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-644"><a href="#cb62-644" aria-hidden="true" tabindex="-1"></a>A process closely related to the Wiener Process is a Brownian bridge. For all intents and purposes, a Brownian bridge is a Wiener-like process which "bridges" two points $a,b\in \R$ on on the interval $<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$. The simplest form of the Brownian bridge has $a=b=0$, and is defined via conditioning as </span>
<span id="cb62-645"><a href="#cb62-645" aria-hidden="true" tabindex="-1"></a>$$ B(t)  = (W(t) \mid W(T) = 0)$$ for $t\in <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$. This is often called the "standard" Brownian bridge, and often has $T=1$. We can construct this process by defining $B(t)$ as </span>
<span id="cb62-646"><a href="#cb62-646" aria-hidden="true" tabindex="-1"></a>$$B(t) = W(t) - \frac{t}{T}W(T).$$ To bridge a general choice of $a,b\in\R$, we'll start by connecting the two points with a straight line parameterized by $t\in<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$, $(1-t/T)a+(t/T)b$. To modify this line, we'll add the standard Brownian bridge $B(t)$.</span>
<span id="cb62-647"><a href="#cb62-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-648"><a href="#cb62-648" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-649"><a href="#cb62-649" aria-hidden="true" tabindex="-1"></a>B(t\mid a,b) &amp;= \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + B(t)<span class="sc">\\</span></span>
<span id="cb62-650"><a href="#cb62-650" aria-hidden="true" tabindex="-1"></a>&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W(t) - \frac{t}{T}W(T)</span>
<span id="cb62-651"><a href="#cb62-651" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-652"><a href="#cb62-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-655"><a href="#cb62-655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-656"><a href="#cb62-656" aria-hidden="true" tabindex="-1"></a>brownian_bridge <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">T_max =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, s){</span>
<span id="cb62-657"><a href="#cb62-657" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Start by drawing standard Wiener process on [0,T]</span></span>
<span id="cb62-658"><a href="#cb62-658" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">wiener</span>(N, T_max, <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-659"><a href="#cb62-659" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb62-660"><a href="#cb62-660" aria-hidden="true" tabindex="-1"></a>      <span class="co"># define B(t) using W(t)</span></span>
<span id="cb62-661"><a href="#cb62-661" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> (<span class="dv">1</span> <span class="sc">-</span> time<span class="sc">/</span>T_max)<span class="sc">*</span>a <span class="sc">+</span> (time<span class="sc">/</span>T_max)<span class="sc">*</span>b <span class="sc">+</span> value <span class="sc">-</span> (time<span class="sc">/</span>T_max)<span class="sc">*</span><span class="fu">last</span>(value, <span class="at">order_by =</span> time),</span>
<span id="cb62-662"><a href="#cb62-662" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> s</span>
<span id="cb62-663"><a href="#cb62-663" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-664"><a href="#cb62-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-665"><a href="#cb62-665" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-666"><a href="#cb62-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-667"><a href="#cb62-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-668"><a href="#cb62-668" aria-hidden="true" tabindex="-1"></a>draw_brownian_bridge <span class="ot">&lt;-</span> <span class="cf">function</span>(n, N, <span class="at">T_max =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>){</span>
<span id="cb62-669"><a href="#cb62-669" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n <span class="sc">%&gt;%</span></span>
<span id="cb62-670"><a href="#cb62-670" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(brownian_bridge, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max, <span class="at">a =</span> a, <span class="at">b =</span> b) <span class="sc">%&gt;%</span></span>
<span id="cb62-671"><a href="#cb62-671" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb62-672"><a href="#cb62-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-673"><a href="#cb62-673" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-674"><a href="#cb62-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-675"><a href="#cb62-675" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_brownian_bridge</span>(<span class="fl">7e3</span>, <span class="fl">1e4</span>, <span class="at">T_max =</span> <span class="dv">2</span>, <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">3</span>)</span>
<span id="cb62-676"><a href="#cb62-676" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-677"><a href="#cb62-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-680"><a href="#cb62-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-681"><a href="#cb62-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-682"><a href="#cb62-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot5952</span></span>
<span id="cb62-683"><a href="#cb62-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-684"><a href="#cb62-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-685"><a href="#cb62-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-686"><a href="#cb62-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of the standard Brownian bridge"</span></span>
<span id="cb62-687"><a href="#cb62-687" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-688"><a href="#cb62-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb62-689"><a href="#cb62-689" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-690"><a href="#cb62-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(iter_num <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-691"><a href="#cb62-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb62-692"><a href="#cb62-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">linewidth =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb62-693"><a href="#cb62-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb62-694"><a href="#cb62-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-695"><a href="#cb62-695" aria-hidden="true" tabindex="-1"></a>Let's consider the random variable given by the Brownian bridge takes on at a specific point in time $t\in<span class="co">[</span><span class="ot">t_1,t_2</span><span class="co">]</span>$ which we will write as $B_{t\mid a,b, t_1, t_2}$. We can derive the distribution of this random variable using properties of the normal distribution and $W_t\sim N(0,t)$.</span>
<span id="cb62-696"><a href="#cb62-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-697"><a href="#cb62-697" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-698"><a href="#cb62-698" aria-hidden="true" tabindex="-1"></a>B_{t\mid a,b}&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W(t) - \frac{t}{T}W(T) <span class="sc">\\</span></span>
<span id="cb62-699"><a href="#cb62-699" aria-hidden="true" tabindex="-1"></a>&amp; \sim \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t) - \frac{t}{T}N(0,T)<span class="sc">\\</span></span>
<span id="cb62-700"><a href="#cb62-700" aria-hidden="true" tabindex="-1"></a>&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t) - N(0,t^2/T)<span class="sc">\\</span></span>
<span id="cb62-701"><a href="#cb62-701" aria-hidden="true" tabindex="-1"></a>&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t(T - t)/T)<span class="sc">\\</span></span>
<span id="cb62-702"><a href="#cb62-702" aria-hidden="true" tabindex="-1"></a>&amp; = N\left( \left(1-\frac{t}{T}\right)a + \frac{t}{T}b, \left(\frac{t(T-t)}{T}\right)\right)</span>
<span id="cb62-703"><a href="#cb62-703" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-704"><a href="#cb62-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-705"><a href="#cb62-705" aria-hidden="true" tabindex="-1"></a>To calculate the covariance of the Brownian bridge at two points, we first need to calculate the covariance </span>
<span id="cb62-706"><a href="#cb62-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-707"><a href="#cb62-707" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-708"><a href="#cb62-708" aria-hidden="true" tabindex="-1"></a>\cov{B_{t\mid a,b}, B_{s\mid a,b}} &amp;= \cov{\left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W_t - \frac{t}{T}W_T, \left(1-\frac{s}{T}\right)a + \frac{s}{T}b + W_s - \frac{s}{T}W_T}<span class="sc">\\</span></span>
<span id="cb62-709"><a href="#cb62-709" aria-hidden="true" tabindex="-1"></a>&amp; = \cov{W_t - \frac{t}{T}W_T, W_s - \frac{s}{T}W_T} <span class="sc">\\</span> </span>
<span id="cb62-710"><a href="#cb62-710" aria-hidden="true" tabindex="-1"></a>&amp; = \cov{W_t, W_s} - \frac{s}{T}\cov{W_t, W_T} - \frac{t}{T}\cov{W_T, W_s} + \frac{st}{T^2}\cov{W_T, W_T}<span class="sc">\\</span></span>
<span id="cb62-711"><a href="#cb62-711" aria-hidden="true" tabindex="-1"></a>&amp; = \min<span class="sc">\{</span>t,s<span class="sc">\}</span> - \frac{s}{T}\min<span class="sc">\{</span>t, T<span class="sc">\}</span> - \frac{t}{T}\min<span class="sc">\{</span>s, T<span class="sc">\}</span> + \frac{st}{T^2}\var{W_T}<span class="sc">\\</span></span>
<span id="cb62-712"><a href="#cb62-712" aria-hidden="true" tabindex="-1"></a>&amp; = \min<span class="sc">\{</span>t,s<span class="sc">\}</span> - \frac{st}{T} - \frac{st}{T} - \frac{stT}{T^2}<span class="sc">\\</span></span>
<span id="cb62-713"><a href="#cb62-713" aria-hidden="true" tabindex="-1"></a>&amp; = \min<span class="sc">\{</span>t,s<span class="sc">\}</span> - \frac{st}{T}</span>
<span id="cb62-714"><a href="#cb62-714" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-715"><a href="#cb62-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-716"><a href="#cb62-716" aria-hidden="true" tabindex="-1"></a>If we combine these two calculations, we can conclude that for any $t_1,\ldots,t_k\in <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$ we have </span>
<span id="cb62-717"><a href="#cb62-717" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-718"><a href="#cb62-718" aria-hidden="true" tabindex="-1"></a>\mathbf W &amp;\sim N(\boldsymbol{\mu},\Sig),<span class="sc">\\</span></span>
<span id="cb62-719"><a href="#cb62-719" aria-hidden="true" tabindex="-1"></a>\boldsymbol{\mu}_j &amp;= \left(1-\frac{t}{T}\right)a + \frac{t}{T}b,<span class="sc">\\</span></span>
<span id="cb62-720"><a href="#cb62-720" aria-hidden="true" tabindex="-1"></a>\Sig_{j\ell}&amp;=\begin{cases}\frac{t_j(T-t_j)}{T} &amp; j = \ell <span class="sc">\\</span> \min<span class="sc">\{</span>t_j,t_{\ell}<span class="sc">\}</span> - \frac{t_jt_\ell}{T} &amp; \text{otherwise} \end{cases},</span>
<span id="cb62-721"><a href="#cb62-721" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-722"><a href="#cb62-722" aria-hidden="true" tabindex="-1"></a>making $B(t\mid a,b)$ a Gaussian process. The Brownian bridge is an important tool and can be generalized to arbitrary intervals $<span class="co">[</span><span class="ot">t_1,t_2</span><span class="co">]</span>\subseteq <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$. For details see pages 82-86 of @glasserman2004monte. </span>
<span id="cb62-723"><a href="#cb62-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-724"><a href="#cb62-724" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-725"><a href="#cb62-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-726"><a href="#cb62-726" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One last example of a stochastic process is especially important in econometrics and is much easier to think of as a random function than more traditional examples of stochastic processes which are typically given as an indexed collection of random variables. </span></span>
<span id="cb62-727"><a href="#cb62-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-728"><a href="#cb62-728" aria-hidden="true" tabindex="-1"></a>:::{#exm-rf}</span>
<span id="cb62-729"><a href="#cb62-729" aria-hidden="true" tabindex="-1"></a><span class="fu">## A Random Function</span></span>
<span id="cb62-730"><a href="#cb62-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-731"><a href="#cb62-731" aria-hidden="true" tabindex="-1"></a>Imagine we observe an iid random sample $\X = (X_1,\ldots, X_n)$ where $X_i\iid N(\mu,\sigma^2)$, and we want to measure the distance a number $t\in\R$ is from the sample $\X$. One way to do this is with the Euclidean metric. If $\mathbf e$ is the unit vector of length $n$ then the distance between $\X$ and $t$ is </span>
<span id="cb62-732"><a href="#cb62-732" aria-hidden="true" tabindex="-1"></a>$$ \norm{\X - t\cdot\mathbf e}_2 = \left(\textstyle\sum_{i=1}^n(X_i - t)^2\right)^{1/2}.$$ If we define $Q_t = \norm{\X - t\cdot\mathbf e}_2$, then $Q = \{Q_t\}_{t\in\R}$ is a stochastic process which maps $\R$ to functions in the space $\R^\R$ (the set of all single variable real functions). Let's look at 100 simulated values of the process $Q$ where $\mu = 0$ and $\sigma^2 = 1$.</span>
<span id="cb62-733"><a href="#cb62-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-736"><a href="#cb62-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-737"><a href="#cb62-737" aria-hidden="true" tabindex="-1"></a><span class="co"># define random function Q_t</span></span>
<span id="cb62-738"><a href="#cb62-738" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, t){</span>
<span id="cb62-739"><a href="#cb62-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">sum</span>((sample<span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb62-740"><a href="#cb62-740" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-741"><a href="#cb62-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-742"><a href="#cb62-742" aria-hidden="true" tabindex="-1"></a><span class="co"># draw n values and calculate Q_t on a given domain</span></span>
<span id="cb62-743"><a href="#cb62-743" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(f, domain, n, dist, dist_params, s){</span>
<span id="cb62-744"><a href="#cb62-744" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb62-745"><a href="#cb62-745" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-746"><a href="#cb62-746" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> domain, </span>
<span id="cb62-747"><a href="#cb62-747" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s,</span>
<span id="cb62-748"><a href="#cb62-748" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q =</span> <span class="fu">map_dbl</span>(domain, f, <span class="at">sample =</span> X),</span>
<span id="cb62-749"><a href="#cb62-749" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> n</span>
<span id="cb62-750"><a href="#cb62-750" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-751"><a href="#cb62-751" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-752"><a href="#cb62-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-753"><a href="#cb62-753" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-754"><a href="#cb62-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-755"><a href="#cb62-755" aria-hidden="true" tabindex="-1"></a><span class="co"># draw N realizations of Q_t on the domain</span></span>
<span id="cb62-756"><a href="#cb62-756" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(N, f, domain, n, dist, dist_params){</span>
<span id="cb62-757"><a href="#cb62-757" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb62-758"><a href="#cb62-758" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">f =</span> f, <span class="at">domain =</span> domain, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb62-759"><a href="#cb62-759" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb62-760"><a href="#cb62-760" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-761"><a href="#cb62-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-762"><a href="#cb62-762" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-763"><a href="#cb62-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-764"><a href="#cb62-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-765"><a href="#cb62-765" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb62-766"><a href="#cb62-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-767"><a href="#cb62-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-770"><a href="#cb62-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-771"><a href="#cb62-771" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-772"><a href="#cb62-772" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot510</span></span>
<span id="cb62-773"><a href="#cb62-773" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-774"><a href="#cb62-774" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-775"><a href="#cb62-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-776"><a href="#cb62-776" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of an aggregated distance of a real number from a random sample calculated using the Euclidean metric."</span></span>
<span id="cb62-777"><a href="#cb62-777" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-778"><a href="#cb62-778" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb62-779"><a href="#cb62-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-780"><a href="#cb62-780" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-781"><a href="#cb62-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb62-782"><a href="#cb62-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb62-783"><a href="#cb62-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-784"><a href="#cb62-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>)</span>
<span id="cb62-785"><a href="#cb62-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-786"><a href="#cb62-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-787"><a href="#cb62-787" aria-hidden="true" tabindex="-1"></a>In each case the realized value of $Q$ is a parabola which happens to be continuously differentiable, so $Q:\R\to C^2(\R)$. We could also define $Q$ using the the norm $\norm{\cdot}_1$ (giving taxi-cab metric) or $\norm{\cdot}_\infty$ (giving the supremum metric).</span>
<span id="cb62-788"><a href="#cb62-788" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-789"><a href="#cb62-789" aria-hidden="true" tabindex="-1"></a>\norm{\X - t\cdot\mathbf e}_1 &amp;= \left(\textstyle\sum_{i=1}^n\abs{X_i - t}\right)<span class="sc">\\</span></span>
<span id="cb62-790"><a href="#cb62-790" aria-hidden="true" tabindex="-1"></a>\norm{\X - t\cdot\mathbf e}_\infty &amp; = \max_{i}\abs{X_i-t}</span>
<span id="cb62-791"><a href="#cb62-791" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-792"><a href="#cb62-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-793"><a href="#cb62-793" aria-hidden="true" tabindex="-1"></a>In both these cases, the realized value of $Q$ will not be differentiable on all of $\R$ since $\abs{x_i - t}$ is not differentiable at the point $t=x_i$.</span>
<span id="cb62-794"><a href="#cb62-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-797"><a href="#cb62-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-798"><a href="#cb62-798" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample,t){</span>
<span id="cb62-799"><a href="#cb62-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(sample<span class="sc">-</span>t))</span>
<span id="cb62-800"><a href="#cb62-800" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-801"><a href="#cb62-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-802"><a href="#cb62-802" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb62-803"><a href="#cb62-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-804"><a href="#cb62-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-807"><a href="#cb62-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-808"><a href="#cb62-808" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-809"><a href="#cb62-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot511</span></span>
<span id="cb62-810"><a href="#cb62-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-811"><a href="#cb62-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-812"><a href="#cb62-812" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-813"><a href="#cb62-813" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of an aggregated distance of a real number from a random sample calculated using the taxi-cab metric. While the realization of the stochastic process appears smooth, it has slight kinks at which it is not differentiable."</span></span>
<span id="cb62-814"><a href="#cb62-814" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-815"><a href="#cb62-815" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb62-816"><a href="#cb62-816" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb62-817"><a href="#cb62-817" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-818"><a href="#cb62-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb62-819"><a href="#cb62-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb62-820"><a href="#cb62-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-821"><a href="#cb62-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>)</span>
<span id="cb62-822"><a href="#cb62-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-823"><a href="#cb62-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-826"><a href="#cb62-826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-827"><a href="#cb62-827" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample,t){</span>
<span id="cb62-828"><a href="#cb62-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">abs</span>(sample<span class="sc">-</span>t))</span>
<span id="cb62-829"><a href="#cb62-829" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-830"><a href="#cb62-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-831"><a href="#cb62-831" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb62-832"><a href="#cb62-832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-833"><a href="#cb62-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-836"><a href="#cb62-836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-837"><a href="#cb62-837" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-838"><a href="#cb62-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot512</span></span>
<span id="cb62-839"><a href="#cb62-839" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-840"><a href="#cb62-840" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-841"><a href="#cb62-841" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-842"><a href="#cb62-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of an aggregated distance of a real number from a random sample calculated using the supremum metric."</span></span>
<span id="cb62-843"><a href="#cb62-843" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-844"><a href="#cb62-844" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb62-845"><a href="#cb62-845" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb62-846"><a href="#cb62-846" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-847"><a href="#cb62-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb62-848"><a href="#cb62-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb62-849"><a href="#cb62-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-850"><a href="#cb62-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>)</span>
<span id="cb62-851"><a href="#cb62-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-852"><a href="#cb62-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-853"><a href="#cb62-853" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-854"><a href="#cb62-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-855"><a href="#cb62-855" aria-hidden="true" tabindex="-1"></a><span class="fu">## Convergence</span></span>
<span id="cb62-856"><a href="#cb62-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-857"><a href="#cb62-857" aria-hidden="true" tabindex="-1"></a>Like any sequence of random variables, a sequence of stochastic processes can converge in a number of ways. A sequence of stochastic processes is just a probabilistic version of a sequence of functions. As such, we can retrofit concepts such as pointwise convergence, uniform convergence, and equicontinuity to apply to stochastic processes. The notation around stochastic processes is cumbersome to begin with, but introducing an index to sequence them makes things even messier. We'll stick to writing a stochastic process $<span class="sc">\{</span>X<span class="sc">\}</span>_{t\in T}$ as $X(t)$, and will denote a sequence of stochastic processes $<span class="sc">\{</span>X_t(t), X_2(t), \ldots<span class="sc">\}</span>$ as $X_n(t)$.</span>
<span id="cb62-858"><a href="#cb62-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-859"><a href="#cb62-859" aria-hidden="true" tabindex="-1"></a>:::{#exm-rf2}</span>
<span id="cb62-860"><a href="#cb62-860" aria-hidden="true" tabindex="-1"></a>Return to @exm-rf where we defined</span>
<span id="cb62-861"><a href="#cb62-861" aria-hidden="true" tabindex="-1"></a>$$Q(t) = \left(\textstyle\sum_{i=1}^n(X_i - t)^2\right)^{1/2} $$ for $X_i\iid N(\mu,\sigma^2)$ and a sample size of $n$. If we let $n$ vary, we have a sequence $Q_n(t)$ indexed by $n$. We'll modify the process $Q_n(t)$ by dividing by $n$ and eliminating the square root, such that $Q_n(t)$ is the average distance between $t$ and $X_i$.</span>
<span id="cb62-862"><a href="#cb62-862" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-863"><a href="#cb62-863" aria-hidden="true" tabindex="-1"></a>Q_1(t) &amp;= \left((X_1 - t)^2\right)^{1/2} = X_1-t<span class="sc">\\</span></span>
<span id="cb62-864"><a href="#cb62-864" aria-hidden="true" tabindex="-1"></a>Q_2(t) &amp; = \frac{1}{2}\left((X_1 - t)^2 + (X_2 - t)^2\right)<span class="sc">\\</span></span>
<span id="cb62-865"><a href="#cb62-865" aria-hidden="true" tabindex="-1"></a>&amp;\vdots<span class="sc">\\</span></span>
<span id="cb62-866"><a href="#cb62-866" aria-hidden="true" tabindex="-1"></a>Q_n(t) &amp; = \frac{1}{n} \textstyle\sum_{i=1}^n(X_i - t)^2<span class="sc">\\</span></span>
<span id="cb62-867"><a href="#cb62-867" aria-hidden="true" tabindex="-1"></a> \vdots </span>
<span id="cb62-868"><a href="#cb62-868" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-869"><a href="#cb62-869" aria-hidden="true" tabindex="-1"></a>The key question is how does the behavior of $Q_n(t)$ change as $n\to\infty$? Let's repeat the same simulation as we did in @exm-rf, but do so for increasingly large sample sizes $n$.</span>
<span id="cb62-870"><a href="#cb62-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-873"><a href="#cb62-873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-874"><a href="#cb62-874" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, t, n){</span>
<span id="cb62-875"><a href="#cb62-875" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sample[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb62-876"><a href="#cb62-876" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">sum</span>((X<span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(X)</span>
<span id="cb62-877"><a href="#cb62-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-878"><a href="#cb62-878" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-879"><a href="#cb62-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-880"><a href="#cb62-880" aria-hidden="true" tabindex="-1"></a><span class="co"># perform simulation over varying sample sizes given by vector n_vals</span></span>
<span id="cb62-881"><a href="#cb62-881" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(f, domain, sample, n){</span>
<span id="cb62-882"><a href="#cb62-882" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-883"><a href="#cb62-883" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> domain,</span>
<span id="cb62-884"><a href="#cb62-884" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> n,</span>
<span id="cb62-885"><a href="#cb62-885" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q =</span> <span class="fu">map_dbl</span>(domain, f, <span class="at">sample =</span> sample, <span class="at">n =</span> n)</span>
<span id="cb62-886"><a href="#cb62-886" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-887"><a href="#cb62-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-888"><a href="#cb62-888" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-889"><a href="#cb62-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-890"><a href="#cb62-890" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(n_vals, f, domain, n, dist, dist_params){</span>
<span id="cb62-891"><a href="#cb62-891" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb62-892"><a href="#cb62-892" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> n_vals <span class="sc">%&gt;%</span> </span>
<span id="cb62-893"><a href="#cb62-893" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">f =</span> f, <span class="at">domain =</span> domain, <span class="at">sample =</span> X) <span class="sc">%&gt;%</span> </span>
<span id="cb62-894"><a href="#cb62-894" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb62-895"><a href="#cb62-895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-896"><a href="#cb62-896" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-897"><a href="#cb62-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-898"><a href="#cb62-898" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="dv">10</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="dv">100</span>), obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="fl">1e3</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb62-899"><a href="#cb62-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-900"><a href="#cb62-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-903"><a href="#cb62-903" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-904"><a href="#cb62-904" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-905"><a href="#cb62-905" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot513</span></span>
<span id="cb62-906"><a href="#cb62-906" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-907"><a href="#cb62-907" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-908"><a href="#cb62-908" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-909"><a href="#cb62-909" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of the process at various sample sizes."</span></span>
<span id="cb62-910"><a href="#cb62-910" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb62-911"><a href="#cb62-911" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-912"><a href="#cb62-912" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb62-913"><a href="#cb62-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb62-914"><a href="#cb62-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb62-915"><a href="#cb62-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-916"><a href="#cb62-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(sample_size) <span class="sc">+</span> </span>
<span id="cb62-917"><a href="#cb62-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Q'</span>, <span class="at">x =</span> <span class="st">'t'</span>) <span class="sc">+</span></span>
<span id="cb62-918"><a href="#cb62-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>}, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb62-919"><a href="#cb62-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Sample Size: {closest_state}'</span>)</span>
<span id="cb62-920"><a href="#cb62-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-921"><a href="#cb62-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-922"><a href="#cb62-922" aria-hidden="true" tabindex="-1"></a>As the sample size increases, it appears that the stochastic process approaches the deterministic function $f(x) = x^2 + 1$.</span>
<span id="cb62-923"><a href="#cb62-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-924"><a href="#cb62-924" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-925"><a href="#cb62-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-926"><a href="#cb62-926" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Instead of focusing just on stochastic processes, we'll generalize the definition of convergence in probability to any random variable defined on a metric space.^[Sometimes the definition is given for separable metric spaces (also known as Polish spaces). This additional assumption gives some convenient topological properties.] </span></span>
<span id="cb62-927"><a href="#cb62-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-928"><a href="#cb62-928" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb62-929"><a href="#cb62-929" aria-hidden="true" tabindex="-1"></a>Suppose $X_n$ is a sequence of random variables defined on a metric space $E$ (equipped with a metric $d:E\times E\to<span class="co">[</span><span class="ot">0,\infty</span><span class="co">]</span>$). The sequence $X_n$ <span class="co">[</span><span class="ot">***converges in probability***</span><span class="co">]</span>{style="color:red"} to a random variable $X$ (defined on the same metric space) if </span>
<span id="cb62-930"><a href="#cb62-930" aria-hidden="true" tabindex="-1"></a>$$ \lim_{n\to\infty}\Pr\left(d(X,X_n) &gt; \varepsilon \right) = 0.$$ </span>
<span id="cb62-931"><a href="#cb62-931" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-932"><a href="#cb62-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-933"><a href="#cb62-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-934"><a href="#cb62-934" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-935"><a href="#cb62-935" aria-hidden="true" tabindex="-1"></a>If $X_n$ is a sequence of random variables defined on $\R$ equipped with the Euclidean metric $d(x,y) = \abs{x-y}$, then the generalized definition of convergence in probability reduces </span>
<span id="cb62-936"><a href="#cb62-936" aria-hidden="true" tabindex="-1"></a>$$ \lim_{n\to\infty}\Pr\left(\abs{X-X_n} &gt; \varepsilon \right) = 0.$$</span>
<span id="cb62-937"><a href="#cb62-937" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-938"><a href="#cb62-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-939"><a href="#cb62-939" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This "new" definition of convergence in probability allows us to define convergence in probability of stochastic processes. If $X_n(t)$ is a sequence of stochastic processes which map the sample space $\mathcal X$ to the space of functions $S^T$, then we can define $X_n(t)\pto X$ as long as $S^T$ is a metric space. The most familiar such space of functions is the set of real-valued continuous functions on a closed interval $[a,b]$, $C([a,b])$. The standard metric on this space is the supremum/uniform metric defined as </span></span>
<span id="cb62-940"><a href="#cb62-940" aria-hidden="true" tabindex="-1"></a>$$ d(f,g) = \norm{f-g}_\infty = \sup_{x\in<span class="co">[</span><span class="ot">a,b</span><span class="co">]</span>}\abs{f(x) - g(x)}.$$ If a sequence of (deterministic) $<span class="sc">\{</span>f_n<span class="sc">\}</span>$ in the space $C(<span class="co">[</span><span class="ot">a,b</span><span class="co">]</span>)$ converges with respect to the supremum metric, then the sequence of real functions converges uniformly (hence the alternate name of "uniform" metric). Uniform convergence is one of the most important concepts in real analysis because it plays nicely with operations like integration and differentiation (opposed to pointwise convergence). The probabilistic extension of uniform convergence of stochastic processes arises when considering convergence in probability with respect to the supremum metric. </span>
<span id="cb62-941"><a href="#cb62-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-942"><a href="#cb62-942" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb62-943"><a href="#cb62-943" aria-hidden="true" tabindex="-1"></a>Suppose $X_n(t)$ is a sequence of stochastic processes defined on the set $C(E)$, where $E\subseteq \R$, equipped with the metric $d(f,g) = \norm{f-g}_\infty$. We say that $X_n$  <span class="co">[</span><span class="ot">***converges in probability uniformly***</span><span class="co">]</span>{style="color:red"} to a stochastic process $X$ (defined on the same metric space) if</span>
<span id="cb62-944"><a href="#cb62-944" aria-hidden="true" tabindex="-1"></a>$$ \lim_{n\to\infty}\Pr\left(\sup_{t\in E}\abs{X_n(t) - X(t)} &gt; \varepsilon \right) = 0.$$ </span>
<span id="cb62-945"><a href="#cb62-945" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-946"><a href="#cb62-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-947"><a href="#cb62-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-948"><a href="#cb62-948" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The definition of uniform convergence in probability may look intimidating, but it's nothing more then a special case of convergence in probability that arises from looking at a metric space comprised of functions. </span></span>
<span id="cb62-949"><a href="#cb62-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-950"><a href="#cb62-950" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One definition that is relevant to the convergence of stochastic processes is related to continuity. Recall that a function $f:X\to Y$, defined on two metric spaces with respective metrics $d_X$ and $d_Y,$ is continuous at a point $x_0\in X$ if for all $\varepsilon &gt; 0$ there exists a $\delta_{x_0} &gt; 0$ such that $$d_Y(f(x_0), f(x)) &lt; \varepsilon $$ for all $x\in X$ satisfying $d_X(x_0,x) &lt; \delta_{x_0}$. In the event that a function is continuous at every point in some subset $E\subseteq X$, then $f$ is continuous on $E$. It's important to realize that the value $\delta_{x_0}$ in the definition of continuity may depend on the point $x_0$, hence the subscript. Even if $f$ is continuous on $E$, $d_X(x_0',x) &lt; \delta_{x_0}$ *does not* imply that $d_Y(f(x_0'), f(x)) &lt; \varepsilon$ for some $x_0'\in E$. If we require that there is one "silver-bullet" $\delta$ that works for all points on $E$, then we say $f$ is uniformly continuous on $E$. In other words, for all $\varepsilon &gt; 0$, there exists a single $\delta$ such that $$d_Y(f(x_0), f(x)) &lt; \varepsilon$$ whenever $d_X(x_0,x) &lt; \delta$ *for all* $x_0\in E$. This is a much stronger form of continuity called uniform continuity, and it can also be written as $$ \sup_{d(x,x_0) &lt; \delta} d_Y(f(x_0), f(x)) &lt; \varepsilon.$$ If $d_Y(f(x_0), f(x)) &lt; \varepsilon$ for the "largest" such value of $d_Y(f(x_0), f(x))$ where $d(x,x_0) &lt; \delta$, then it must hold for all $d_Y(f(x_0), f(x))$ satisfying $d(x,x_0) &lt; \delta$.^[I'm using "largest" loosely here because it's possible that this value isn't attained which is why we use the supremum.]</span></span>
<span id="cb62-951"><a href="#cb62-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-952"><a href="#cb62-952" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If we think about uniform continuity in the context of sequences of functions $\{f_n\}$ where $f_n:X\to Y$, we can introduce a form of continuity even stronger than uniform continuity. Suppose we have a sequence of uniformly continuous functions $\{f_n\}$. For each $f_n$, we have some $\delta_n$ such that $d_X(x_0, x) &lt; \delta_n$ implies that $d_Y(f_n(x_0), f(x))&lt;\varepsilon$ for all $x_0 \in E$. In general, for two functions $f_i$ and $f_j$ (which are in the sequence $\{f_n\}$), $\delta_i\neq\delta_j$. All the functions in the sequence may be uniformly continuous, but their uniform continuity is not related to other elements in anyway. What would happen if we required this though? In other words, what if we were to require that there is a single $\delta$ that is independent of $n$ that works across all $f_n$? This would be like uniform continuity on steroids, and in fact has a name. A group of functions $\mathcal F$ (in our case our interest is when $\mathcal F$ is a sequence of functions) is (uniformly) equicontinuous if for all $\varepsilon &gt;0$ there exists a $\delta &gt;0$ such that $d_X(x_0, x) &lt; \delta$ implies $d_Y(f(x_0),f(x)) &lt; \varepsilon$ *for all* $f\in \mathcal F$ and *all* $x_0\in E$. Another way of saying this is that </span></span>
<span id="cb62-953"><a href="#cb62-953" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-954"><a href="#cb62-954" aria-hidden="true" tabindex="-1"></a>\sup_{d(x,x_0) &lt; \delta} d_Y(f(x_0), f(x)) &amp;&lt; \varepsilon &amp; (\forall f\in \mathcal F)</span>
<span id="cb62-955"><a href="#cb62-955" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-956"><a href="#cb62-956" aria-hidden="true" tabindex="-1"></a>To be even more succinct, we can write this in terms of the choice of $f$ which gives the "largest" value of $\sup_{d(x,x_0) &lt; \delta} d_Y(f(x_0), f(x))$, as this would imply it holds for all $f\in \mathcal F$.</span>
<span id="cb62-957"><a href="#cb62-957" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-958"><a href="#cb62-958" aria-hidden="true" tabindex="-1"></a>\sup_{f\in\mathcal F}\sup_{d(x,x_0) &lt; \delta} d_Y(f(x_0), f(x)) &amp;&lt; \varepsilon</span>
<span id="cb62-959"><a href="#cb62-959" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-960"><a href="#cb62-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-961"><a href="#cb62-961" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; We want to develop a probabilistic version of equicontinuity in the context of stochastic processes. To makes things easier, we'll only concern ourselves with processes defined on real continuous functions defined on $E\subseteq \mathbb R$.^[The definition is readily extended to a general stochastic process.] If our process $X_n(t)$ is indexed by $n$, then the probabilistic extension of uniform continuity would look like something like</span></span>
<span id="cb62-962"><a href="#cb62-962" aria-hidden="true" tabindex="-1"></a>$$\Pr\left(\sup_{\abs{s-t} &lt; \delta} \abs{X_n(t)-X_n(s)} &gt; \eta \right) &lt; \varepsilon$$ for all $\eta,\varepsilon &gt; 0$. To ensure this holds for all $X_n$, we take the supremum over $n$</span>
<span id="cb62-963"><a href="#cb62-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-964"><a href="#cb62-964" aria-hidden="true" tabindex="-1"></a>$$\sup_{n}\Pr\left(\sup_{\abs{s-t} &lt; \delta} \abs{X_n(t)-X_n(s)} &gt; \eta \right) &lt; \varepsilon.$$ Since we're considering the asymptotics of $<span class="sc">\{</span>X_n<span class="sc">\}</span>$ we'd like this inequality to hold as $n\to\infty$ which gives the condition </span>
<span id="cb62-965"><a href="#cb62-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-966"><a href="#cb62-966" aria-hidden="true" tabindex="-1"></a>$$\limsup_{n\to\infty}\Pr\left(\sup_{\abs{s-t} &lt; \delta} \abs{X_n(t)-X_n(s)} &gt; \eta \right) &lt; \varepsilon.$$</span>
<span id="cb62-967"><a href="#cb62-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-968"><a href="#cb62-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-969"><a href="#cb62-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-970"><a href="#cb62-970" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb62-971"><a href="#cb62-971" aria-hidden="true" tabindex="-1"></a>Suppose $X_n(t)$ is a sequence of stochastic processes defined on the set $C(E)$, where $E\subseteq \R$. We say that this collection of stochastic processes is <span class="co">[</span><span class="ot">***stochastically equicontinuous***</span><span class="co">]</span>{style="color:red"} if </span>
<span id="cb62-972"><a href="#cb62-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-973"><a href="#cb62-973" aria-hidden="true" tabindex="-1"></a>$$\limsup_{n\to\infty}\Pr\left(\sup_{\abs{s-t} &lt; \delta} \abs{X_n(t)-X_n(s)} &gt; \eta \right) &lt; \varepsilon.$$</span>
<span id="cb62-974"><a href="#cb62-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-975"><a href="#cb62-975" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-976"><a href="#cb62-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-977"><a href="#cb62-977" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Informally, stochastic equicontinuity ensures that if $t$ and $s$ are close, then the probability that $X_n(s)$ and $X_n(t)$ are close is very high as $n\to\infty$. As one might expect from the grotesque definition, proving a sequence of random functions exhibits stochastic equicontinuity can be quite tricky. @andrews1994empirical provides several conditions which imply stochastic continuity that are more readily verified. </span></span>
<span id="cb62-978"><a href="#cb62-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-979"><a href="#cb62-979" aria-hidden="true" tabindex="-1"></a><span class="fu">## Convergence in Distribution {#sec-dist}</span></span>
<span id="cb62-980"><a href="#cb62-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-981"><a href="#cb62-981" aria-hidden="true" tabindex="-1"></a>A sequence of real-valued random variables $X_n$ converges in distribution to $X$ if $\lim_{n\to\infty}F_{n}(x) = F_X(x)$. This form of convergence is what the various forms of the CLT were concerned with, and it's also the type of convergence that underpins statistical inference by allowing us to derive the asymptotic distribution of test statistics. It stands to reason then that if convergence in distribution is so important, it should be generalized to stochastic processes. While it can be, it will look a bit different, and this is why you sometimes hear people refer to convergence in distribution as "weak convergence". This is due to the term "(cumulative) distribution function" being specific to real-valued random variables. It's worth digging a bit deeper on the measure theory behind this. </span>
<span id="cb62-982"><a href="#cb62-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-983"><a href="#cb62-983" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If $(\mathcal X, \mathcal F, P)$ is a probability space and $X:\mathcal X\to E$ is a random variable defined on the measurable space $(E, \mathcal E)$, then we can define a special measure on $(E, \mathcal E)$ using the probability measure $P:\mathcal F\to[0,1]$. We do this by composing $P$ and $X^{-1}$ to get what is called the "law" of $X$, written as </span></span>
<span id="cb62-984"><a href="#cb62-984" aria-hidden="true" tabindex="-1"></a>$$\mathcal L(X) = P\circ X^{-1}.$$ Since $X$ is a random variable, $X^{-1}(A)\in \mathcal F$ for all $A\in \mathcal E$, so we know that $P$ is defined for all $X^{-1}(A)$, i.e $\mathcal L(X)$ is defined on all of $\mathcal E$. The law of $X$ evaluated at $A\in\mathcal E$, $P\circ X^{-1}(A)$, tells us "what is the probability that $X$ takes on a value in the set $A$?" We can define the law of $X$ *for any* random variable. In the event that $E = \R$ and $\mathcal E = \mathcal B(\R)$, making $X$ a real-valued random variable, then we can use the law of $X$ to define the familiar distribution function as follows:</span>
<span id="cb62-985"><a href="#cb62-985" aria-hidden="true" tabindex="-1"></a>$$ P\circ X^{-1}((-\infty,x]) = P(X\in (-\infty, x]) = P(X\le x) = F_X(x).$$</span>
<span id="cb62-986"><a href="#cb62-986" aria-hidden="true" tabindex="-1"></a>Generalizing convergence in distribution to random variables defined on arbitrary metric spaces really means defining convergence in laws (which is synonymous with "weak convergence"). The mathematical details of this are interesting, but fairly rigorous. @billingsley2008probability, which is one of the *de facto* references for probability theory, only scratches the surface of convergence in laws, instead treating it in it's own book (@billingsleycon). For this reason, it's better to just cover the basics. </span>
<span id="cb62-987"><a href="#cb62-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-988"><a href="#cb62-988" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The first step in defining weak convergence for random functions is with a useful results that gives several equivalent formulations for convergence in distribution for real variables. We'll provide only one of these equivalences.</span></span>
<span id="cb62-989"><a href="#cb62-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-990"><a href="#cb62-990" aria-hidden="true" tabindex="-1"></a>:::{#lem-}</span>
<span id="cb62-991"><a href="#cb62-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-992"><a href="#cb62-992" aria-hidden="true" tabindex="-1"></a><span class="fu">## Portmanteau Lemma</span></span>
<span id="cb62-993"><a href="#cb62-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-994"><a href="#cb62-994" aria-hidden="true" tabindex="-1"></a>Suppose $X_n$ is a sequence of real-valued random variables. We have $X_n\dto X$  *if and only if* $\E{f(X_n)}\to\E{f(X)}$ for all bounded continuous functions $f$. </span>
<span id="cb62-995"><a href="#cb62-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-996"><a href="#cb62-996" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-997"><a href="#cb62-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-998"><a href="#cb62-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-999"><a href="#cb62-999" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The proof is not particularly important.^[It's actually almost immediate from the definition of integration with respect to a measure.] What is, is that we can retrofit this definition of weak convergence for random variables defined on any metric space. </span></span>
<span id="cb62-1000"><a href="#cb62-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1001"><a href="#cb62-1001" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb62-1002"><a href="#cb62-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1003"><a href="#cb62-1003" aria-hidden="true" tabindex="-1"></a>Suppose $X_n$ is a sequence of random variables defined on a metric space $E$. We say that $X_n$ <span class="co">[</span><span class="ot">***converges weakly***</span><span class="co">]</span>{style="color:red"} to a random variable $X$ if $\E{f(X_n)}\to\E{f(X)}$ for all bounded and continuous functions $f:E\to\R$. To be consistent with existing notation, this will be written as $X_n\dto X$. </span>
<span id="cb62-1004"><a href="#cb62-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1005"><a href="#cb62-1005" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1006"><a href="#cb62-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1007"><a href="#cb62-1007" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; So now what? We have a definition of weak convergence we can apply to random functions in $C(E)$ for $E\subseteq \R$, but how do we even begin to apply this definition to show that $X_n \dto X$?! It turns out, if we use stochastic equicontinuity, we can break the problem into much smaller parts that we know how to solve. Recall that one of the easiest ways to understand the Wiener process $W$ was looking at the real-valued random variables $\{W(t_1), W(t_2), \ldots, W(t_k)\}$ at fixed times $t_1,t_2,\ldots,t_k$. What happens if this collection of real-valued random variables $(W(t_1), W(t_2),\ldots, W(t_k))$, which forms a random vector, converges in distribution? Could we then conclude that the entire process $W$ converges in distribution? *Maybe*! In typical real analysis fashion, we need to impose a property related to convergence and continuity to iron out some wacky edge cases that could mess things up. It just so happens that the property we need is stochastic equicontinuity. This gives rise to a useful characterization of weak convergence of random functions, the proof of which can be found in Chapter 7 of @billingsleycon.</span></span>
<span id="cb62-1008"><a href="#cb62-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1009"><a href="#cb62-1009" aria-hidden="true" tabindex="-1"></a>:::{#thm-spconv}</span>
<span id="cb62-1010"><a href="#cb62-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1011"><a href="#cb62-1011" aria-hidden="true" tabindex="-1"></a>Suppose $X_n(t)$ is a sequence of stochastic processes defined on the set $C(E)$, where $E\subseteq \R$, equipped with the metric $d(f,g) = \norm{f-g}_\infty$. We have $X_n\dto X$ *if and only if* the two following conditions holds:</span>
<span id="cb62-1012"><a href="#cb62-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1013"><a href="#cb62-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>For every finite set of points $t_1,\ldots, t_k\in E$ the random vector $(X_n(t_1),\ldots,X_n(t_k))$ converges in distribution to the random vector $(X(t_1),\ldots X(t_k))$.</span>
<span id="cb62-1014"><a href="#cb62-1014" aria-hidden="true" tabindex="-1"></a>$$ (X_n(t_1),\ldots,X_n(t_k))\dto (X(t_1),\ldots X(t_k))$$</span>
<span id="cb62-1015"><a href="#cb62-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>There exists a finite partition of $E =\cup_{j=1}^J E_j$ such that $X_n$ is stochastically equicontinuous on $E_j$ for all $j=1,\ldots,J$.</span>
<span id="cb62-1016"><a href="#cb62-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1017"><a href="#cb62-1017" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1018"><a href="#cb62-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1019"><a href="#cb62-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1020"><a href="#cb62-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">## Application: Empirical Process Theory</span></span>
<span id="cb62-1021"><a href="#cb62-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1022"><a href="#cb62-1022" aria-hidden="true" tabindex="-1"></a>A great deal of the asymptotic theory dealing with stochastic processes was developed in the context of one *very* important stochastic process. This particular process happens to be one of the most important estimators in statistics, and is used to estimate the cumulative distribution function of a random variable.</span>
<span id="cb62-1023"><a href="#cb62-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1024"><a href="#cb62-1024" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb62-1025"><a href="#cb62-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1026"><a href="#cb62-1026" aria-hidden="true" tabindex="-1"></a>Let $\mathcal F$ be the set of all distribution functions of a real-valued random variable defined on $\mathcal X$, and $(X_1,\ldots,X_n)$ be a set of iid real-valued random variables defined on $\mathcal X$.^<span class="co">[</span><span class="ot">This is not at all a technical approach to defining this space. For a rigorous approach, look up "Skorokhod space".</span><span class="co">]</span> If The <span class="co">[</span><span class="ot">***empirical (cumulative) distribution function (ecdf)***</span><span class="co">]</span>{style="color:red"} $\hat F:\mathcal X\to\mathcal F$ is an estimator defined as </span>
<span id="cb62-1027"><a href="#cb62-1027" aria-hidden="true" tabindex="-1"></a>$$\hat F_X(x) = \frac{1}{n}\sum_{i=1}^nI<span class="co">[</span><span class="ot">X_i \le x</span><span class="co">]</span>.$$ This estimator can be generalized to an iid sample of real-valued random vectors as follows:</span>
<span id="cb62-1028"><a href="#cb62-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1029"><a href="#cb62-1029" aria-hidden="true" tabindex="-1"></a>$$ \hat F_{\X}(\x) = \frac{1}{n}\sum_{i=1}^nI<span class="co">[</span><span class="ot">X_{i,k} \le x_k\ \forall k</span><span class="co">]</span>$$</span>
<span id="cb62-1030"><a href="#cb62-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1031"><a href="#cb62-1031" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1032"><a href="#cb62-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1033"><a href="#cb62-1033" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; To estimate the probability of $\Pr(X\le x) = \hat F_X(x)$ at a given point $x\in\mathcal X$, the estimator $\hat F$ just counts the number of realized values of $X_i$ which are less than $X$. This proportion is often called the *empirical probability*, and is the sample-counterpart to the true probability.</span></span>
<span id="cb62-1034"><a href="#cb62-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1035"><a href="#cb62-1035" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-1036"><a href="#cb62-1036" aria-hidden="true" tabindex="-1"></a>Let's draw a sample of $n=100$ from $X\iid N(0,1)$, calculate $\hat F_X(0)$, and then compare $F_X$ and $\hat F_X$ with a figure.</span>
<span id="cb62-1037"><a href="#cb62-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1040"><a href="#cb62-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1041"><a href="#cb62-1041" aria-hidden="true" tabindex="-1"></a><span class="co"># Define "function factory" to create estimator F_X(x) given X = sample</span></span>
<span id="cb62-1042"><a href="#cb62-1042" aria-hidden="true" tabindex="-1"></a>emp_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(sample){</span>
<span id="cb62-1043"><a href="#cb62-1043" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample)</span>
<span id="cb62-1044"><a href="#cb62-1044" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb62-1045"><a href="#cb62-1045" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(sample <span class="sc">&lt;</span> x) <span class="sc">/</span> n)</span>
<span id="cb62-1046"><a href="#cb62-1046" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-1047"><a href="#cb62-1047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">Vectorize</span>(output))</span>
<span id="cb62-1048"><a href="#cb62-1048" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1049"><a href="#cb62-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1050"><a href="#cb62-1050" aria-hidden="true" tabindex="-1"></a>F_hat <span class="ot">&lt;-</span> <span class="fu">emp_cdf</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb62-1051"><a href="#cb62-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">F_hat</span>(<span class="dv">0</span>)</span>
<span id="cb62-1052"><a href="#cb62-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1053"><a href="#cb62-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1056"><a href="#cb62-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1057"><a href="#cb62-1057" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-1058"><a href="#cb62-1058" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot5135</span></span>
<span id="cb62-1059"><a href="#cb62-1059" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-1060"><a href="#cb62-1060" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-1061"><a href="#cb62-1061" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-1062"><a href="#cb62-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: " iii"</span></span>
<span id="cb62-1063"><a href="#cb62-1063" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb62-1064"><a href="#cb62-1064" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-1065"><a href="#cb62-1065" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb62-1066"><a href="#cb62-1066" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb62-1067"><a href="#cb62-1067" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1068"><a href="#cb62-1068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-1069"><a href="#cb62-1069" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Empirical Distribution</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">F_hat</span>(x),</span>
<span id="cb62-1070"><a href="#cb62-1070" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Actual Distribution</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">pnorm</span>(x)</span>
<span id="cb62-1071"><a href="#cb62-1071" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1072"><a href="#cb62-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>x) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1073"><a href="#cb62-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb62-1074"><a href="#cb62-1074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-1075"><a href="#cb62-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-1076"><a href="#cb62-1076" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"Pr(X &lt; x)"</span>) <span class="sc">+</span></span>
<span id="cb62-1077"><a href="#cb62-1077" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb62-1078"><a href="#cb62-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>))</span>
<span id="cb62-1079"><a href="#cb62-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1080"><a href="#cb62-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1081"><a href="#cb62-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1082"><a href="#cb62-1082" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1083"><a href="#cb62-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1084"><a href="#cb62-1084" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The empirical distribution function is one of the most important estimators in statistics (right up there with sample mean), which is why there is an entire field of research dedicated to it (along with generalizations) called empirical process theory. Before introducing the highlights of empirical process theory, let's consider $\hat F$ evaluated at some fixed value $x_0\in \mathcal X$. This gives an estimator $\hat F_X(x_0):\mathcal X\to[0,1]$ which is fairly easy to analyze. </span></span>
<span id="cb62-1085"><a href="#cb62-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1086"><a href="#cb62-1086" aria-hidden="true" tabindex="-1"></a>:::{#thm-}</span>
<span id="cb62-1087"><a href="#cb62-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1088"><a href="#cb62-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pointwise Properties of the ECDF</span></span>
<span id="cb62-1089"><a href="#cb62-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1090"><a href="#cb62-1090" aria-hidden="true" tabindex="-1"></a>Suppose $\X = (X_1,\ldots, X_n)$ is an iid sequence of real-valued random variables defined on $\mathcal X$. *For a fixed* value $x_0\in \mathcal X$, the estimator $\hat F_X(x_0):\mathcal X\to<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ exhibits the following properties:</span>
<span id="cb62-1091"><a href="#cb62-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1092"><a href="#cb62-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$\hat F_X(x_0)$ is an unbiased estimator for $F_X(x_0)$ and has a variance of $\frac{1}{n} F_X(x_0)(1-F_X(x_0)$;</span>
<span id="cb62-1093"><a href="#cb62-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>$\hat F_X(x_0)$ is a consistent estimator for $F_X(x_0)$;</span>
<span id="cb62-1094"><a href="#cb62-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>$\sqrt{n}\left<span class="co">[</span><span class="ot">\hat F_X(x_0) - F_X(x_0)\right</span><span class="co">]</span>\dto N(0, F_X(x_0)(1-F_X(x_0)))$.</span>
<span id="cb62-1095"><a href="#cb62-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1096"><a href="#cb62-1096" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1097"><a href="#cb62-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1098"><a href="#cb62-1098" aria-hidden="true" tabindex="-1"></a>:::{.proof}</span>
<span id="cb62-1099"><a href="#cb62-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1100"><a href="#cb62-1100" aria-hidden="true" tabindex="-1"></a>We have $I<span class="co">[</span><span class="ot">X_i \le x</span><span class="co">]</span> \iid \text{Bernoulli}(F_X(x_0))$, so the sum of these $n$ of these indicator functions is a binomial random variable which we will denote as $Y$.</span>
<span id="cb62-1101"><a href="#cb62-1101" aria-hidden="true" tabindex="-1"></a>$$Y=\sum_{i=1}^nI<span class="co">[</span><span class="ot">X_i \le x</span><span class="co">]</span> \sim \text{Ber}(n, F_X(x_0))$$</span>
<span id="cb62-1102"><a href="#cb62-1102" aria-hidden="true" tabindex="-1"></a>This makes the estimator $\hat F_X(x_0)= Y/n$ a scaled version of the binomial distribution, a fact which we can use to prove the claimed properties.</span>
<span id="cb62-1103"><a href="#cb62-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1104"><a href="#cb62-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The estimator's unbiasedness follows from the expectation of the binomial random variable $Y$. $$\E{\hat F_X(x_0)} = \E{Y/n} = \frac{1}{n}\E{Y} = \frac{1}{n}\left<span class="co">[</span><span class="ot">nF_X(x_0)\right</span><span class="co">]</span>=F_X(x_0)$$ The variance follows from a similar calculation. $$\var{\hat F_X(x_0)} = \var{Y/n} = \frac{1}{n^2}\var{Y} = \frac{1}{n^2}\left<span class="co">[</span><span class="ot">nF_X(x_0)(1-F_X(x_0))\right</span><span class="co">]</span>=\frac{1}{n} F_X(x_0)(1-F_X(x_0).$$</span>
<span id="cb62-1105"><a href="#cb62-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1106"><a href="#cb62-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The estimator $\hat F_X(x_0)$ is the sample average of idd random bernoulli variables $I<span class="co">[</span><span class="ot">X_i \le x</span><span class="co">]</span>$, so by the LLN we have </span>
<span id="cb62-1107"><a href="#cb62-1107" aria-hidden="true" tabindex="-1"></a>$$\hat F_X(x_0) = \frac{1}{n}\sum_{i=1}^n I<span class="co">[</span><span class="ot">X_i \le x</span><span class="co">]</span> \pto \E{I<span class="co">[</span><span class="ot">X_i \le x</span><span class="co">]</span>} = F_X(x_0) .$$</span>
<span id="cb62-1108"><a href="#cb62-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1109"><a href="#cb62-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>One way to show this is by applying Slutsky's theorem to the normal approximation of the binomial distribution. </span>
<span id="cb62-1110"><a href="#cb62-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1111"><a href="#cb62-1111" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-1112"><a href="#cb62-1112" aria-hidden="true" tabindex="-1"></a>&amp; Y  \sim \text{Ber}(n, F_X(x_0))<span class="sc">\\</span></span>
<span id="cb62-1113"><a href="#cb62-1113" aria-hidden="true" tabindex="-1"></a>\implies &amp; Y\dto N(nF_X(x_0), F_X(x_0)(1-F_X(x_0))<span class="sc">\\</span></span>
<span id="cb62-1114"><a href="#cb62-1114" aria-hidden="true" tabindex="-1"></a>\implies &amp; \frac{1}{n}Y \dto N\left(F_X(x_0), \frac{1}{n}F_X(x_0)(1-F_X(x_0)\right)<span class="sc">\\</span></span>
<span id="cb62-1115"><a href="#cb62-1115" aria-hidden="true" tabindex="-1"></a>\implies &amp; \hat F_X(x_0) \dto  N\left(F_X(x_0), \frac{1}{n}F_X(x_0)(1-F_X(x_0)\right)<span class="sc">\\</span></span>
<span id="cb62-1116"><a href="#cb62-1116" aria-hidden="true" tabindex="-1"></a>\implies &amp; \sqrt{n}\left<span class="co">[</span><span class="ot">\hat F_X(x_0) - F_X(x_0)\right</span><span class="co">]</span>\dto N(0, F_X(x_0)(1-F_X(x_0)))</span>
<span id="cb62-1117"><a href="#cb62-1117" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-1118"><a href="#cb62-1118" aria-hidden="true" tabindex="-1"></a>Another way of showing this is directly applying the CLT to $\hat F_X(x_0)$, which is a sample average of Bernoulli random variables. </span>
<span id="cb62-1119"><a href="#cb62-1119" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1120"><a href="#cb62-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1121"><a href="#cb62-1121" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One place we rely on $\hat F_X(x_0)$ being a "good" estimator is when performing Monte Carlo simulations.</span></span>
<span id="cb62-1122"><a href="#cb62-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1123"><a href="#cb62-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1124"><a href="#cb62-1124" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-1125"><a href="#cb62-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1126"><a href="#cb62-1126" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulations and Hypothesis Tests</span></span>
<span id="cb62-1127"><a href="#cb62-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1128"><a href="#cb62-1128" aria-hidden="true" tabindex="-1"></a>In @sec-testing we relied on Monte Carlo simulations to approximate the probability of committing a type I or type II error. This actually relies on the empirical CDF evaluated at a point! Suppose $H_0:\mu  \le \mu_0$ and $H_1: \mu &gt; \mu_0$, where $X_i \iid N(0,1)$ for a sample size of $n=1000$, $\mu = 0$, and $\mu_0 = 0$. We can test this using the decision rule $\delta(\X) = I<span class="co">[</span><span class="ot">T(\X) \ge 1.645</span><span class="co">]</span>$ where the decision space is $\mathcal A = <span class="sc">\{</span>0,1<span class="sc">\}</span>$. We have </span>
<span id="cb62-1129"><a href="#cb62-1129" aria-hidden="true" tabindex="-1"></a>$$ \Pr(\text{correct decision}) = \Pr(\delta(\X) = 0) = \Pr(T(\X) &lt; 1.645) = F_T(1.645),$$ so we can estimate the probability we make the correct decision using $\hat F_T(1.645)$. If we simulate $N$ decisions (uppercase $N$ here, as $n$ is the sample size used to calculate our test statistic) then </span>
<span id="cb62-1130"><a href="#cb62-1130" aria-hidden="true" tabindex="-1"></a>$$ \hat F_T(1.645) = \frac{1}{N}\sum_{k=1}^NI<span class="co">[</span><span class="ot">T(\X) &lt; 1.645</span><span class="co">]</span> $$ for simulations $k=1,\ldots,N$. We will set $N = 1000$.</span>
<span id="cb62-1131"><a href="#cb62-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1134"><a href="#cb62-1134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1135"><a href="#cb62-1135" aria-hidden="true" tabindex="-1"></a>T_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(X, mu_0){</span>
<span id="cb62-1136"><a href="#cb62-1136" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(X)</span>
<span id="cb62-1137"><a href="#cb62-1137" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> (<span class="fu">mean</span>(X)<span class="sc">-</span>mu_0)<span class="sc">/</span>(<span class="fu">sd</span>(X)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb62-1138"><a href="#cb62-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1139"><a href="#cb62-1139" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1140"><a href="#cb62-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1141"><a href="#cb62-1141" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(mu_0, n, dist, dist_params, t){</span>
<span id="cb62-1142"><a href="#cb62-1142" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb62-1143"><a href="#cb62-1143" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-1144"><a href="#cb62-1144" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> t, </span>
<span id="cb62-1145"><a href="#cb62-1145" aria-hidden="true" tabindex="-1"></a>    <span class="at">T_stat =</span> <span class="fu">T_stat</span>(X, mu_0)</span>
<span id="cb62-1146"><a href="#cb62-1146" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-1147"><a href="#cb62-1147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1148"><a href="#cb62-1148" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1149"><a href="#cb62-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1150"><a href="#cb62-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1151"><a href="#cb62-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1152"><a href="#cb62-1152" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(x, N, mu_0, n, dist, dist_params, s){</span>
<span id="cb62-1153"><a href="#cb62-1153" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb62-1154"><a href="#cb62-1154" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">mu_0 =</span> mu_0, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1155"><a href="#cb62-1155" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-1156"><a href="#cb62-1156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">ecdf_x =</span> <span class="fu">mean</span>(T_stat <span class="sc">&lt;</span> x)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1157"><a href="#cb62-1157" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">iter_num =</span> s)</span>
<span id="cb62-1158"><a href="#cb62-1158" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1159"><a href="#cb62-1159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1160"><a href="#cb62-1160" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1161"><a href="#cb62-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1162"><a href="#cb62-1162" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="dv">100-1</span>), <span class="fl">1e3</span>, <span class="dv">0</span>, <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb62-1163"><a href="#cb62-1163" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>ecdf_x</span>
<span id="cb62-1164"><a href="#cb62-1164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1165"><a href="#cb62-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1166"><a href="#cb62-1166" aria-hidden="true" tabindex="-1"></a>Our estimate is close to the true value of $0.95$! Now let's repeat this $M=10,000$ times to get $10,000$ simulated values of $\hat F_T(1.645)$.^<span class="co">[</span><span class="ot">The nesting of simulations may be a little confusing here. We're drawing $n$ realizations of $X_i$ to calculate one value of $T(\X)$. We then repeat this $N$ times to get $N$ values of $T(\X)$ to calculate one value of $\hat F_T(1.645)$, so we've drawn $n*N$ values of $X_i$. Now we want to repeat *all of this* $M$ times to get $M$ values of $\hat F_T(1.645)$, so we've drawn $n\times N\times M$ values of $X_i$!</span><span class="co">]</span> </span>
<span id="cb62-1167"><a href="#cb62-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1170"><a href="#cb62-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1171"><a href="#cb62-1171" aria-hidden="true" tabindex="-1"></a>outer_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(M, x, N, mu_0, n, dist, dist_params){</span>
<span id="cb62-1172"><a href="#cb62-1172" aria-hidden="true" tabindex="-1"></a> output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span></span>
<span id="cb62-1173"><a href="#cb62-1173" aria-hidden="true" tabindex="-1"></a>   <span class="fu">map</span>(sim, <span class="at">x =</span> x, <span class="at">N =</span> N, <span class="at">mu_0 =</span> mu_0, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span></span>
<span id="cb62-1174"><a href="#cb62-1174" aria-hidden="true" tabindex="-1"></a>   <span class="fu">bind_rows</span>()</span>
<span id="cb62-1175"><a href="#cb62-1175" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(output)</span>
<span id="cb62-1176"><a href="#cb62-1176" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1177"><a href="#cb62-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1178"><a href="#cb62-1178" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">outer_sim</span>(<span class="fl">1e4</span>, <span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="dv">100-1</span>), <span class="fl">1e3</span>, <span class="dv">0</span>, <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb62-1179"><a href="#cb62-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1180"><a href="#cb62-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1181"><a href="#cb62-1181" aria-hidden="true" tabindex="-1"></a>In theory, we have </span>
<span id="cb62-1182"><a href="#cb62-1182" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-1183"><a href="#cb62-1183" aria-hidden="true" tabindex="-1"></a>\E{\hat F_T(1.645)} &amp;= F_T(1.645) = 0.95,<span class="sc">\\</span></span>
<span id="cb62-1184"><a href="#cb62-1184" aria-hidden="true" tabindex="-1"></a>\var{\hat F_T(1.645)} &amp; = \frac{1}{N}\cdot F_T(1.645)\cdot\left<span class="co">[</span><span class="ot">1-F_T(1.645)\right</span><span class="co">]</span> = \frac{0.95(1-0.95)}{1000} = 4.75\times 10^{-5},</span>
<span id="cb62-1185"><a href="#cb62-1185" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-1186"><a href="#cb62-1186" aria-hidden="true" tabindex="-1"></a>so we should see the sample mean and sample variance of our estimates come close to these values.</span>
<span id="cb62-1187"><a href="#cb62-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1190"><a href="#cb62-1190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1191"><a href="#cb62-1191" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-1192"><a href="#cb62-1192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb62-1193"><a href="#cb62-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(ecdf_x),</span>
<span id="cb62-1194"><a href="#cb62-1194" aria-hidden="true" tabindex="-1"></a>    <span class="at">variance =</span> <span class="fu">var</span>(ecdf_x)</span>
<span id="cb62-1195"><a href="#cb62-1195" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-1196"><a href="#cb62-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1197"><a href="#cb62-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1198"><a href="#cb62-1198" aria-hidden="true" tabindex="-1"></a>Finally, we should see these estimates (approximately) follow a normal distribution.</span>
<span id="cb62-1199"><a href="#cb62-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1202"><a href="#cb62-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1203"><a href="#cb62-1203" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-1204"><a href="#cb62-1204" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot514</span></span>
<span id="cb62-1205"><a href="#cb62-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-1206"><a href="#cb62-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-1207"><a href="#cb62-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-1208"><a href="#cb62-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Histogram of simulated values along with the asymptotic distribution given in Theorem 5.2."</span></span>
<span id="cb62-1209"><a href="#cb62-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb62-1210"><a href="#cb62-1210" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-1211"><a href="#cb62-1211" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-1212"><a href="#cb62-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ecdf_x)) <span class="sc">+</span> </span>
<span id="cb62-1213"><a href="#cb62-1213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">2e-3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb62-1214"><a href="#cb62-1214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.95</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>( (<span class="fl">0.95</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.95</span>)<span class="sc">/</span><span class="dv">1000</span> )), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb62-1215"><a href="#cb62-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Empricial CDF evaluated at 1.645"</span>, <span class="at">y =</span> <span class="st">"Probability Density"</span>) <span class="sc">+</span></span>
<span id="cb62-1216"><a href="#cb62-1216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb62-1217"><a href="#cb62-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1218"><a href="#cb62-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1219"><a href="#cb62-1219" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1220"><a href="#cb62-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1221"><a href="#cb62-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1222"><a href="#cb62-1222" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-1223"><a href="#cb62-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1224"><a href="#cb62-1224" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulations with Consistent Estimators </span></span>
<span id="cb62-1225"><a href="#cb62-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1226"><a href="#cb62-1226" aria-hidden="true" tabindex="-1"></a>In @exm-lln1 we actually used the empirical CDF evaluated at a point to show that $\bar X\pto \mu$, it was just hidden behind the vague wording "observed probability". Using the full definition of convergence in probability, the LLN states </span>
<span id="cb62-1227"><a href="#cb62-1227" aria-hidden="true" tabindex="-1"></a>$$ \lim_{n\to\infty} \Pr\left(\abs{\bar X -\mu} &gt; \varepsilon\right) = 0.$$ Let's fix $n = 100$ and $\varepsilon = 0.1$, and draw $n$ observations of $X\sim F_X$ to calculate $\bar X$. If we repeat this $N$ times we have $N$ realized values of $\bar X$, giving $N$ realized values of $\abs{\bar X -\mu} &gt; \varepsilon$. We can now estimate the probability that $\Pr\left(\abs{\bar X -\mu} &gt; \varepsilon\right)$.</span>
<span id="cb62-1228"><a href="#cb62-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1229"><a href="#cb62-1229" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-1230"><a href="#cb62-1230" aria-hidden="true" tabindex="-1"></a>\hat{\Pr}\left(\abs{\bar X -\mu} &gt; \varepsilon\right) &amp;= 1 - \hat{\Pr}\left(\abs{\bar X -\mu} \le \varepsilon\right) = 1 - \hat{F}_{\abs{\bar X-\mu}}(\varepsilon) = 1 - \frac{1}{N}\sum_{i = 1}^N I\left<span class="co">[</span><span class="ot">\abs{\bar X -\mu} \le \varepsilon\right</span><span class="co">]</span>.</span>
<span id="cb62-1231"><a href="#cb62-1231" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-1232"><a href="#cb62-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1233"><a href="#cb62-1233" aria-hidden="true" tabindex="-1"></a>Let's do this for $N = 1,000$ and $X\sim N(0,1)$. </span>
<span id="cb62-1234"><a href="#cb62-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1237"><a href="#cb62-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1238"><a href="#cb62-1238" aria-hidden="true" tabindex="-1"></a>draw_X_bar <span class="ot">&lt;-</span> <span class="cf">function</span>(n, dist, dist_params, t){</span>
<span id="cb62-1239"><a href="#cb62-1239" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb62-1240"><a href="#cb62-1240" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-1241"><a href="#cb62-1241" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">mean</span>(X),</span>
<span id="cb62-1242"><a href="#cb62-1242" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> t,</span>
<span id="cb62-1243"><a href="#cb62-1243" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> n</span>
<span id="cb62-1244"><a href="#cb62-1244" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-1245"><a href="#cb62-1245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1246"><a href="#cb62-1246" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1247"><a href="#cb62-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1248"><a href="#cb62-1248" aria-hidden="true" tabindex="-1"></a>F_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(N, epsilon, mu, n, dist, dist_params){</span>
<span id="cb62-1249"><a href="#cb62-1249" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span></span>
<span id="cb62-1250"><a href="#cb62-1250" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(draw_X_bar, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1251"><a href="#cb62-1251" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-1252"><a href="#cb62-1252" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb62-1253"><a href="#cb62-1253" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate =</span> <span class="fu">sum</span>(<span class="fu">abs</span>(estimate <span class="sc">-</span> mu) <span class="sc">&lt;=</span> epsilon) <span class="sc">/</span> N,</span>
<span id="cb62-1254"><a href="#cb62-1254" aria-hidden="true" tabindex="-1"></a>      <span class="at">sample_size =</span> N,</span>
<span id="cb62-1255"><a href="#cb62-1255" aria-hidden="true" tabindex="-1"></a>      <span class="at">e =</span> epsilon,</span>
<span id="cb62-1256"><a href="#cb62-1256" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-1257"><a href="#cb62-1257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1258"><a href="#cb62-1258" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1259"><a href="#cb62-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1260"><a href="#cb62-1260" aria-hidden="true" tabindex="-1"></a><span class="fu">F_hat</span>(<span class="fl">1e3</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb62-1261"><a href="#cb62-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1262"><a href="#cb62-1262" aria-hidden="true" tabindex="-1"></a>How does this compare to the true value $\hat{F}_{\abs{\bar X-\mu}}(\varepsilon)$? We have </span>
<span id="cb62-1263"><a href="#cb62-1263" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-1264"><a href="#cb62-1264" aria-hidden="true" tabindex="-1"></a>\hat{F}_{\abs{\bar X-\mu}}(\varepsilon) &amp; = \Pr(\abs{\bar X -\mu} \le \varepsilon)<span class="sc">\\</span></span>
<span id="cb62-1265"><a href="#cb62-1265" aria-hidden="true" tabindex="-1"></a>&amp; = \Pr(\bar X \in <span class="co">[</span><span class="ot">\mu - \varepsilon, \mu + \varepsilon</span><span class="co">]</span>)</span>
<span id="cb62-1266"><a href="#cb62-1266" aria-hidden="true" tabindex="-1"></a>&amp; = \Pr(\bar X \le \mu + \varepsilon) - \Pr(\bar X \le \mu - \varepsilon). </span>
<span id="cb62-1267"><a href="#cb62-1267" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-1268"><a href="#cb62-1268" aria-hidden="true" tabindex="-1"></a>Since $\bar X \sim N(\mu, \sigma/\sqrt{n})$, this can be readily calculated.</span>
<span id="cb62-1269"><a href="#cb62-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1272"><a href="#cb62-1272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1273"><a href="#cb62-1273" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb62-1274"><a href="#cb62-1274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1275"><a href="#cb62-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1276"><a href="#cb62-1276" aria-hidden="true" tabindex="-1"></a>Our estimate for these particular values of $n$ and $\varepsilon$ is spot-on. Going back to @exm-lln1, we repeat this process for increasingly  values of $n$ to show $\Pr\left(\abs{\bar X -\mu} &gt; \varepsilon\right)$. This must hold for any $\varepsilon &gt; 0$, so it's also helpful to confirm this trend holds for a handful of $\varepsilon$ values.</span>
<span id="cb62-1277"><a href="#cb62-1277" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1278"><a href="#cb62-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1279"><a href="#cb62-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1280"><a href="#cb62-1280" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With the key properties of estimator $\hat F_X(x_0):\mathcal X\to[0,1]$, let's now shift gears and consider the empirical distribution function $\hat F:\mathcal X\to \mathcal F$ as an estimator of a random function in the space $\mathcal F$.</span></span>
<span id="cb62-1281"><a href="#cb62-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1282"><a href="#cb62-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1283"><a href="#cb62-1283" aria-hidden="true" tabindex="-1"></a><span class="fu">### Glivenko–Cantelli Theorem </span></span>
<span id="cb62-1284"><a href="#cb62-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1285"><a href="#cb62-1285" aria-hidden="true" tabindex="-1"></a>The first property we'll establish is consistency. Since the space of distribution functions $\mathcal F$ is comprised entirely by bounded functions, the *de facto* metric $d(F,G)=\norm{F-G}_\infty$ is well defined. By Definition 5.2, $\hat F_X\pto F_X$ if </span>
<span id="cb62-1286"><a href="#cb62-1286" aria-hidden="true" tabindex="-1"></a>$$ \lim_{n\to\infty}\Pr\left(\norm{\hat F_X-F_X}_\infty &gt; \varepsilon \right) = 0$$ for all $\varepsilon &gt; 0$. In other words, we want to show that </span>
<span id="cb62-1287"><a href="#cb62-1287" aria-hidden="true" tabindex="-1"></a>$$ \norm{\hat F_X-F_X}_\infty \pto 0 .$$ </span>
<span id="cb62-1288"><a href="#cb62-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1289"><a href="#cb62-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1290"><a href="#cb62-1290" aria-hidden="true" tabindex="-1"></a>:::{#thm-}</span>
<span id="cb62-1291"><a href="#cb62-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1292"><a href="#cb62-1292" aria-hidden="true" tabindex="-1"></a><span class="fu">## Glivenko–Cantelli</span></span>
<span id="cb62-1293"><a href="#cb62-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1294"><a href="#cb62-1294" aria-hidden="true" tabindex="-1"></a>The empirical distribution function $\hat F_X:\mathcal X\to<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ satisfies </span>
<span id="cb62-1295"><a href="#cb62-1295" aria-hidden="true" tabindex="-1"></a>$$ \norm{\hat F_X-F_X}_\infty \overset{as}{\to} 0 $$</span>
<span id="cb62-1296"><a href="#cb62-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1297"><a href="#cb62-1297" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1298"><a href="#cb62-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1299"><a href="#cb62-1299" aria-hidden="true" tabindex="-1"></a>:::{.proof}</span>
<span id="cb62-1300"><a href="#cb62-1300" aria-hidden="true" tabindex="-1"></a>In the event that $X$ is a discrete random variable, then</span>
<span id="cb62-1301"><a href="#cb62-1301" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1302"><a href="#cb62-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1303"><a href="#cb62-1303" aria-hidden="true" tabindex="-1"></a>:::{#cor-}</span>
<span id="cb62-1304"><a href="#cb62-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1305"><a href="#cb62-1305" aria-hidden="true" tabindex="-1"></a>The empirical distribution function $\hat F_X:\mathcal X\to<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ is a consistent estimator for $F_X$. </span>
<span id="cb62-1306"><a href="#cb62-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1307"><a href="#cb62-1307" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1308"><a href="#cb62-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1309"><a href="#cb62-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1310"><a href="#cb62-1310" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb62-1311"><a href="#cb62-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1312"><a href="#cb62-1312" aria-hidden="true" tabindex="-1"></a>To illustrate that $\hat F_X$ is a consistent estimator for $F_X$, the first thing we need to do is get a sense of what $\norm{\hat F_X-F_X}_\infty$ "looks like". For the entirety of this example, we'll just assume that $X_i\sim N(0,1)$. To calculate $\norm{\hat F_X-F_X}_\infty$, we need to find the supremum of $\abs{\hat F_X(x)-F_X(x)}$ over the set $\mathcal X = \R$. This is not only impossible because the supremum may not be attained, but also because we cannot compute an uncountably infinite number of values. Instead, we'll take a discretized version of the problem as an approximation. If we calculate $\norm{\hat F_X-F_X}_\infty$ at $J$ values $<span class="sc">\{</span>x_1,\ldots,x_J<span class="sc">\}</span>\subseteq \R$, then we can use the approximation </span>
<span id="cb62-1313"><a href="#cb62-1313" aria-hidden="true" tabindex="-1"></a>$$\norm{\hat F_X-F_X}_\infty\approx \max_{x_1,\ldots,x_j} \abs{\hat F_X(x)-F_X(x)}$$ for a large value of $J$. To see this approximation in action, we'll draw $n=1,000$ values of $X_i$ to calculate $\hat F_X$ on the discrete domain of the $J=100,000$ evenly spaced points between $-4$ and $4$.^<span class="co">[</span><span class="ot">Since $\Pr(X_i \notin[-4,4]) \approx 0.00006 $, our discrete approximation doesn't lose much accuracy from clipping the tails of the sample space.</span><span class="co">]</span>   </span>
<span id="cb62-1314"><a href="#cb62-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1317"><a href="#cb62-1317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1318"><a href="#cb62-1318" aria-hidden="true" tabindex="-1"></a>F_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(t, X){</span>
<span id="cb62-1319"><a href="#cb62-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(X <span class="sc">&lt;</span> t)<span class="sc">/</span><span class="fu">length</span>(X)</span>
<span id="cb62-1320"><a href="#cb62-1320" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb62-1321"><a href="#cb62-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1322"><a href="#cb62-1322" aria-hidden="true" tabindex="-1"></a>norm <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X){</span>
<span id="cb62-1323"><a href="#cb62-1323" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1324"><a href="#cb62-1324" aria-hidden="true" tabindex="-1"></a>  <span class="co"># given dist, define quantile function</span></span>
<span id="cb62-1325"><a href="#cb62-1325" aria-hidden="true" tabindex="-1"></a>  qdist <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb62-1326"><a href="#cb62-1326" aria-hidden="true" tabindex="-1"></a>    rnorm <span class="sc">%&gt;%</span> </span>
<span id="cb62-1327"><a href="#cb62-1327" aria-hidden="true" tabindex="-1"></a>      <span class="fu">substitute</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-1328"><a href="#cb62-1328" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-1329"><a href="#cb62-1329" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_replace</span>(<span class="st">"r"</span>, <span class="st">"q"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1330"><a href="#cb62-1330" aria-hidden="true" tabindex="-1"></a>      <span class="fu">do.call</span>(<span class="fu">list</span>(x))</span>
<span id="cb62-1331"><a href="#cb62-1331" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-1332"><a href="#cb62-1332" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1333"><a href="#cb62-1333" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define upper and lower bound of domain using qdist </span></span>
<span id="cb62-1334"><a href="#cb62-1334" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">qdist</span>(<span class="dv">0</span>) <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span>){</span>
<span id="cb62-1335"><a href="#cb62-1335" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">=</span> <span class="fu">qdist</span>(<span class="fl">1e-7</span>)</span>
<span id="cb62-1336"><a href="#cb62-1336" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb62-1337"><a href="#cb62-1337" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">=</span> <span class="fu">qdist</span>(<span class="dv">0</span>)</span>
<span id="cb62-1338"><a href="#cb62-1338" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-1339"><a href="#cb62-1339" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">qdist</span>(<span class="dv">1</span>) <span class="sc">==</span> <span class="cn">Inf</span>){</span>
<span id="cb62-1340"><a href="#cb62-1340" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">=</span> <span class="fu">qdist</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">1e-7</span>)</span>
<span id="cb62-1341"><a href="#cb62-1341" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb62-1342"><a href="#cb62-1342" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">=</span> <span class="fu">qdist</span>(<span class="dv">1</span>)</span>
<span id="cb62-1343"><a href="#cb62-1343" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-1344"><a href="#cb62-1344" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1345"><a href="#cb62-1345" aria-hidden="true" tabindex="-1"></a>  <span class="co"># discretize domain into N points</span></span>
<span id="cb62-1346"><a href="#cb62-1346" aria-hidden="true" tabindex="-1"></a>  domain <span class="ot">&lt;-</span> <span class="fu">seq</span>(lower, upper, <span class="at">length =</span> N)</span>
<span id="cb62-1347"><a href="#cb62-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1348"><a href="#cb62-1348" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-1349"><a href="#cb62-1349" aria-hidden="true" tabindex="-1"></a>    domain,</span>
<span id="cb62-1350"><a href="#cb62-1350" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_hat =</span> <span class="fu">map_dbl</span>(domain, F_hat, <span class="at">X =</span> X),</span>
<span id="cb62-1351"><a href="#cb62-1351" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_0 =</span> <span class="fu">pnorm</span>(domain)</span>
<span id="cb62-1352"><a href="#cb62-1352" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-1353"><a href="#cb62-1353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb62-1354"><a href="#cb62-1354" aria-hidden="true" tabindex="-1"></a>      <span class="at">difference =</span> F_hat <span class="sc">-</span> F_0,</span>
<span id="cb62-1355"><a href="#cb62-1355" aria-hidden="true" tabindex="-1"></a>      <span class="at">distance =</span> <span class="fu">abs</span>(F_hat <span class="sc">-</span> F_0)</span>
<span id="cb62-1356"><a href="#cb62-1356" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-1357"><a href="#cb62-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1358"><a href="#cb62-1358" aria-hidden="true" tabindex="-1"></a>  norm <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb62-1359"><a href="#cb62-1359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">max</span>(distance)) <span class="sc">%&gt;%</span></span>
<span id="cb62-1360"><a href="#cb62-1360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb62-1361"><a href="#cb62-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1362"><a href="#cb62-1362" aria-hidden="true" tabindex="-1"></a>  attained_at <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb62-1363"><a href="#cb62-1363" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(distance <span class="sc">==</span> <span class="fu">max</span>(distance)) <span class="sc">%&gt;%</span></span>
<span id="cb62-1364"><a href="#cb62-1364" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(domain) <span class="sc">%&gt;%</span></span>
<span id="cb62-1365"><a href="#cb62-1365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb62-1366"><a href="#cb62-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1367"><a href="#cb62-1367" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb62-1368"><a href="#cb62-1368" aria-hidden="true" tabindex="-1"></a>    <span class="st">"norm"</span> <span class="ot">=</span> norm,</span>
<span id="cb62-1369"><a href="#cb62-1369" aria-hidden="true" tabindex="-1"></a>    <span class="st">"norm_attained_at"</span> <span class="ot">=</span> attained_at,</span>
<span id="cb62-1370"><a href="#cb62-1370" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span> <span class="ot">=</span> df</span>
<span id="cb62-1371"><a href="#cb62-1371" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-1372"><a href="#cb62-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1373"><a href="#cb62-1373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1374"><a href="#cb62-1374" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1375"><a href="#cb62-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1376"><a href="#cb62-1376" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">norm</span>(<span class="fl">1e6</span>, <span class="fu">rnorm</span>(<span class="fl">1e3</span>))</span>
<span id="cb62-1377"><a href="#cb62-1377" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb62-1378"><a href="#cb62-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1379"><a href="#cb62-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1380"><a href="#cb62-1380" aria-hidden="true" tabindex="-1"></a>Now let's visualize what this looks like by comparing $\hat F_X$ and $F_X$, along with showing the values of $\abs{\hat F_X(x)-F_X(x)}$ that we took the maximum of. </span>
<span id="cb62-1381"><a href="#cb62-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1384"><a href="#cb62-1384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1385"><a href="#cb62-1385" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-1386"><a href="#cb62-1386" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot515</span></span>
<span id="cb62-1387"><a href="#cb62-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-1388"><a href="#cb62-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1.2</span></span>
<span id="cb62-1389"><a href="#cb62-1389" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-1390"><a href="#cb62-1390" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "test"</span></span>
<span id="cb62-1391"><a href="#cb62-1391" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb62-1392"><a href="#cb62-1392" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> results<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb62-1393"><a href="#cb62-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb62-1394"><a href="#cb62-1394" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Empirical Distribution, F_hat</span><span class="st">`</span> <span class="ot">=</span> F_hat,</span>
<span id="cb62-1395"><a href="#cb62-1395" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Actual Distribution, F</span><span class="st">`</span> <span class="ot">=</span> F_0</span>
<span id="cb62-1396"><a href="#cb62-1396" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1397"><a href="#cb62-1397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>distance, <span class="sc">-</span>difference) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1398"><a href="#cb62-1398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>domain) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1399"><a href="#cb62-1399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(domain, value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb62-1400"><a href="#cb62-1400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-1401"><a href="#cb62-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-1402"><a href="#cb62-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"t"</span>, <span class="at">y =</span> <span class="st">"Pr(X &lt; t)"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb62-1403"><a href="#cb62-1403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb62-1404"><a href="#cb62-1404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb62-1405"><a href="#cb62-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1406"><a href="#cb62-1406" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> results<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb62-1407"><a href="#cb62-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(domain, difference)) <span class="sc">+</span></span>
<span id="cb62-1408"><a href="#cb62-1408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-1409"><a href="#cb62-1409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"t"</span>, <span class="at">y =</span> <span class="st">"F - F_hat"</span>) <span class="sc">+</span></span>
<span id="cb62-1410"><a href="#cb62-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb62-1411"><a href="#cb62-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1412"><a href="#cb62-1412" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> results<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb62-1413"><a href="#cb62-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(domain, distance)) <span class="sc">+</span></span>
<span id="cb62-1414"><a href="#cb62-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-1415"><a href="#cb62-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb62-1416"><a href="#cb62-1416" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> results<span class="sc">$</span>norm_attained_at, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> results<span class="sc">$</span>norm_attained_at, <span class="at">yend =</span> results<span class="sc">$</span>norm),</span>
<span id="cb62-1417"><a href="#cb62-1417" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb62-1418"><a href="#cb62-1418" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb62-1419"><a href="#cb62-1419" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-1420"><a href="#cb62-1420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb62-1421"><a href="#cb62-1421" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> results<span class="sc">$</span>norm_attained_at, <span class="at">y  =</span>results<span class="sc">$</span>norm, <span class="at">xend =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">yend =</span> results<span class="sc">$</span>norm),</span>
<span id="cb62-1422"><a href="#cb62-1422" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb62-1423"><a href="#cb62-1423" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb62-1424"><a href="#cb62-1424" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb62-1425"><a href="#cb62-1425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"t"</span>, <span class="at">y =</span> <span class="st">"|F - F_hat|"</span>) <span class="sc">+</span></span>
<span id="cb62-1426"><a href="#cb62-1426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb62-1427"><a href="#cb62-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1428"><a href="#cb62-1428" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, plot3, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb62-1429"><a href="#cb62-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1430"><a href="#cb62-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1431"><a href="#cb62-1431" aria-hidden="true" tabindex="-1"></a>We'll now repeat this process *many* times, letting sample size grow for each drawn sample. </span>
<span id="cb62-1432"><a href="#cb62-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1435"><a href="#cb62-1435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1436"><a href="#cb62-1436" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-1437"><a href="#cb62-1437" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X, k){</span>
<span id="cb62-1438"><a href="#cb62-1438" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> X[<span class="dv">1</span><span class="sc">:</span>k]</span>
<span id="cb62-1439"><a href="#cb62-1439" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-1440"><a href="#cb62-1440" aria-hidden="true" tabindex="-1"></a>    <span class="at">norm_val =</span> <span class="fu">norm</span>(N, sample)<span class="sc">$</span>norm,</span>
<span id="cb62-1441"><a href="#cb62-1441" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> k</span>
<span id="cb62-1442"><a href="#cb62-1442" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-1443"><a href="#cb62-1443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1444"><a href="#cb62-1444" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1445"><a href="#cb62-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1446"><a href="#cb62-1446" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(n_vals, N, dist, dist_params, s){</span>
<span id="cb62-1447"><a href="#cb62-1447" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(<span class="fu">max</span>(n_vals), dist_params))</span>
<span id="cb62-1448"><a href="#cb62-1448" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> n_vals <span class="sc">%&gt;%</span> </span>
<span id="cb62-1449"><a href="#cb62-1449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">N =</span> N, <span class="at">X =</span> X) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1450"><a href="#cb62-1450" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-1451"><a href="#cb62-1451" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">iter_num =</span> s)</span>
<span id="cb62-1452"><a href="#cb62-1452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1453"><a href="#cb62-1453" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1454"><a href="#cb62-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1455"><a href="#cb62-1455" aria-hidden="true" tabindex="-1"></a>outer_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(M, n_vals, N, dist, dist_params){</span>
<span id="cb62-1456"><a href="#cb62-1456" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb62-1457"><a href="#cb62-1457" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(sim, <span class="at">n_vals =</span> n_vals, <span class="at">N =</span> N, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1458"><a href="#cb62-1458" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb62-1459"><a href="#cb62-1459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1460"><a href="#cb62-1460" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1461"><a href="#cb62-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1462"><a href="#cb62-1462" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">outer_sim</span>(<span class="fl">1e4</span>, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">1e3</span>, <span class="at">length =</span> <span class="dv">20</span>), <span class="fl">1e2</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb62-1463"><a href="#cb62-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1464"><a href="#cb62-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1465"><a href="#cb62-1465" aria-hidden="true" tabindex="-1"></a>If we plot the results of our simulation, we see that as $n\to\infty$, it appears that the proportion of lines "far away" from zero shrinks. In other words, the probability that $\norm{\hat F_X-F_X}_\infty &gt;  \varepsilon$ shrinks as $n\to\infty$.</span>
<span id="cb62-1466"><a href="#cb62-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1469"><a href="#cb62-1469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1470"><a href="#cb62-1470" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-1471"><a href="#cb62-1471" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot516</span></span>
<span id="cb62-1472"><a href="#cb62-1472" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-1473"><a href="#cb62-1473" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-1474"><a href="#cb62-1474" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-1475"><a href="#cb62-1475" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Approximate values of the norm of the difference between the empirical distribution and true distribution calculated for 10,000 simulations."</span></span>
<span id="cb62-1476"><a href="#cb62-1476" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure."</span></span>
<span id="cb62-1477"><a href="#cb62-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-1478"><a href="#cb62-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1479"><a href="#cb62-1479" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-1480"><a href="#cb62-1480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sample_size, norm_val)) <span class="sc">+</span></span>
<span id="cb62-1481"><a href="#cb62-1481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">linewidth =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb62-1482"><a href="#cb62-1482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Size, n"</span>, <span class="at">y =</span> <span class="st">"sup|F - F_hat|"</span>) <span class="sc">+</span></span>
<span id="cb62-1483"><a href="#cb62-1483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb62-1484"><a href="#cb62-1484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb62-1485"><a href="#cb62-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1486"><a href="#cb62-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1487"><a href="#cb62-1487" aria-hidden="true" tabindex="-1"></a>But we're not done yet! We can go a step further here by estimating the probability that $\norm{\hat F_X-F_X}_\infty &gt;  \varepsilon$ by estimating the empirical distribution function of $\norm{\hat F_X-F_X}_\infty$ at the point $\varepsilon$! </span>
<span id="cb62-1488"><a href="#cb62-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1489"><a href="#cb62-1489" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-1490"><a href="#cb62-1490" aria-hidden="true" tabindex="-1"></a>\widehat\Pr\left(\norm{\hat F_X-F_X}_\infty &gt;  \varepsilon \right) &amp;= 1 - \widehat\Pr\left(\norm{\hat F_X-F_X}_\infty \le  \varepsilon \right) = 1 - \hat F_{\norm{\hat F_X-F_X}_\infty}(\varepsilon)</span>
<span id="cb62-1491"><a href="#cb62-1491" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-1492"><a href="#cb62-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1493"><a href="#cb62-1493" aria-hidden="true" tabindex="-1"></a>This amounts to finding the proportion of lines which fall outside the interval $[0,\varepsilon)$ for a particular sample size. Since this probability should approach zero for all $\varepsilon &gt;0$, we'll estimate these probabilities at a handful of values of $\varepsilon$.</span>
<span id="cb62-1494"><a href="#cb62-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1497"><a href="#cb62-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1498"><a href="#cb62-1498" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-1499"><a href="#cb62-1499" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot517</span></span>
<span id="cb62-1500"><a href="#cb62-1500" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-1501"><a href="#cb62-1501" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-1502"><a href="#cb62-1502" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-1503"><a href="#cb62-1503" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The empirical probability that the norm in question is \"far\" from zero shrinks as sample size grows."</span></span>
<span id="cb62-1504"><a href="#cb62-1504" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure."</span></span>
<span id="cb62-1505"><a href="#cb62-1505" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb62-1506"><a href="#cb62-1506" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-1507"><a href="#cb62-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1508"><a href="#cb62-1508" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-1509"><a href="#cb62-1509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">e =</span> (<span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1510"><a href="#cb62-1510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample_size, e) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1511"><a href="#cb62-1511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">prob =</span> <span class="fu">mean</span>(norm_val <span class="sc">&gt;</span> e)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1512"><a href="#cb62-1512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sample_size, prob, <span class="at">color =</span> <span class="fu">as.factor</span>(e))) <span class="sc">+</span> </span>
<span id="cb62-1513"><a href="#cb62-1513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-1514"><a href="#cb62-1514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"ε"</span>, <span class="at">y =</span> <span class="st">"Pr(Norm &gt; ε)"</span>, <span class="at">x =</span> <span class="st">"Sample Size, n"</span>) <span class="sc">+</span></span>
<span id="cb62-1515"><a href="#cb62-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-1516"><a href="#cb62-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb62-1517"><a href="#cb62-1517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1518"><a href="#cb62-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1519"><a href="#cb62-1519" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-1520"><a href="#cb62-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1521"><a href="#cb62-1521" aria-hidden="true" tabindex="-1"></a><span class="fu">### Donsker's Theorem </span></span>
<span id="cb62-1522"><a href="#cb62-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1523"><a href="#cb62-1523" aria-hidden="true" tabindex="-1"></a>@sec-dist explored what it meant for a stochastic process to converge in distribution. If the process $\hat F_X$ is so important, it stands to reason that people have established whether or not $\hat F_x$ converges weakly. It in fact does, and this is the content of Donsker's Theorem which is also known as the "functional" central limit theorem or the invariance principle. </span>
<span id="cb62-1524"><a href="#cb62-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1525"><a href="#cb62-1525" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; To arrive at the result, let's start with the simple setting of $X\iid \text{Uni}(0,1)$ and apply @thm-spconv to $\sqrt{n}(\hat F_X - F_X)$. For ease we will denote this process as $s_n$ and simplify its expression. </span></span>
<span id="cb62-1526"><a href="#cb62-1526" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-1527"><a href="#cb62-1527" aria-hidden="true" tabindex="-1"></a>S_n(t) &amp;= \sqrt{n}(\hat F_X(t) - F_X(t))<span class="sc">\\</span></span>
<span id="cb62-1528"><a href="#cb62-1528" aria-hidden="true" tabindex="-1"></a>&amp;= \sqrt{n}\left(\frac{1}{n}\sum_{i=1}^n 1<span class="co">[</span><span class="ot">X_i\le t</span><span class="co">]</span> - t\right) &amp; (F_X(t) = t)<span class="sc">\\</span></span>
<span id="cb62-1529"><a href="#cb62-1529" aria-hidden="true" tabindex="-1"></a>&amp; =  \sqrt{n}\left(\frac{1}{n}\sum_{i=1}^n 1<span class="co">[</span><span class="ot">X_i\le t</span><span class="co">]</span> - \frac{1}{n}\sum_{i=1}^n t\right) &amp; \left(\frac{1}{n}\sum_{i=1}^n t = t\right)<span class="sc">\\</span></span>
<span id="cb62-1530"><a href="#cb62-1530" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{1}{\sqrt n}\sum_{i=1}^n\left(1<span class="co">[</span><span class="ot">X_i\le t</span><span class="co">]</span> - t\right)<span class="sc">\\</span></span>
<span id="cb62-1531"><a href="#cb62-1531" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{1}{\sqrt n}\sum_{i=1}^nU_i(t) &amp; (U_i(t) = 1<span class="co">[</span><span class="ot">X_i\le t</span><span class="co">]</span> - t).</span>
<span id="cb62-1532"><a href="#cb62-1532" aria-hidden="true" tabindex="-1"></a>\end{align*} </span>
<span id="cb62-1533"><a href="#cb62-1533" aria-hidden="true" tabindex="-1"></a>Let $t_1,\ldots,t_k$ be an arbitrary set of points in $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$. We can verify that the first condition of @thm-spconv is met by applying the multivariate CLT to $(U_i(t_1),\ldots,U_i(t_k))$.^<span class="co">[</span><span class="ot">We'll simply generalize the proof of Theorem 5.2</span><span class="co">]</span> For any $t_\ell$ we have </span>
<span id="cb62-1534"><a href="#cb62-1534" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-1535"><a href="#cb62-1535" aria-hidden="true" tabindex="-1"></a>\E{U_i(t_\ell)} = \E{1<span class="co">[</span><span class="ot">X_i\le t_\ell</span><span class="co">]</span> - t_\ell} = \E{1<span class="co">[</span><span class="ot">X_i\le t_\ell</span><span class="co">]</span>} - t_\ell = \Pr(X_i\le t_\ell) - t_i = t_\ell - t_\ell = 0.</span>
<span id="cb62-1536"><a href="#cb62-1536" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-1537"><a href="#cb62-1537" aria-hidden="true" tabindex="-1"></a>For any two $t_\ell,t_j$ in our arbitrary set of points in $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ we have </span>
<span id="cb62-1538"><a href="#cb62-1538" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-1539"><a href="#cb62-1539" aria-hidden="true" tabindex="-1"></a>\var{\begin{bmatrix}U_i(t_\ell)<span class="sc">\\</span>U_i(t_j) \end{bmatrix}} &amp; = \E{\left(\begin{bmatrix}U_i(t_\ell)<span class="sc">\\</span>U_i(t_j) \end{bmatrix} -\E{\begin{bmatrix}U_i(t_\ell)<span class="sc">\\</span>U_i(t_j) \end{bmatrix}}\right)\left(\begin{bmatrix}U_i(t_\ell)<span class="sc">\\</span>U_i(t_j) \end{bmatrix} -\E{\begin{bmatrix}U_i(t_\ell)<span class="sc">\\</span>U_i(t_j) \end{bmatrix}}\right)'}<span class="sc">\\</span></span>
<span id="cb62-1540"><a href="#cb62-1540" aria-hidden="true" tabindex="-1"></a>&amp; = \E{\begin{bmatrix}U_i(t_\ell)<span class="sc">\\</span>U_i(t_j) \end{bmatrix}\begin{bmatrix}U_i(t_\ell)<span class="sc">\\</span>U_i(t_j) \end{bmatrix}'} &amp; (\E{U_i(t)} = 0\ \forall t\in <span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>)<span class="sc">\\</span></span>
<span id="cb62-1541"><a href="#cb62-1541" aria-hidden="true" tabindex="-1"></a>&amp; = \begin{bmatrix} \E{U_i(t_\ell)^2} &amp;\E{U_i(t_\ell)U_i(t_j)} <span class="sc">\\</span> \E{U_i(t_\ell)U_i(t_j)}&amp; \E{U_i(t_j)^2} \end{bmatrix}<span class="sc">\\</span></span>
<span id="cb62-1542"><a href="#cb62-1542" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-1543"><a href="#cb62-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1544"><a href="#cb62-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1545"><a href="#cb62-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1548"><a href="#cb62-1548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1549"><a href="#cb62-1549" aria-hidden="true" tabindex="-1"></a>emp_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, n){</span>
<span id="cb62-1550"><a href="#cb62-1550" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb62-1551"><a href="#cb62-1551" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(sample[<span class="dv">1</span><span class="sc">:</span>n] <span class="sc">&lt;</span> x) <span class="sc">/</span> n)</span>
<span id="cb62-1552"><a href="#cb62-1552" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-1553"><a href="#cb62-1553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">Vectorize</span>(output))</span>
<span id="cb62-1554"><a href="#cb62-1554" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1555"><a href="#cb62-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1556"><a href="#cb62-1556" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, n, domain){</span>
<span id="cb62-1557"><a href="#cb62-1557" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-1558"><a href="#cb62-1558" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> domain, </span>
<span id="cb62-1559"><a href="#cb62-1559" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_hat =</span> <span class="fu">emp_cdf</span>(sample, n)(domain),</span>
<span id="cb62-1560"><a href="#cb62-1560" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> n</span>
<span id="cb62-1561"><a href="#cb62-1561" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-1562"><a href="#cb62-1562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1563"><a href="#cb62-1563" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1564"><a href="#cb62-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1565"><a href="#cb62-1565" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(n_vals, domain, sample_size, dist, dist_params){</span>
<span id="cb62-1566"><a href="#cb62-1566" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(sample_size, dist_params))</span>
<span id="cb62-1567"><a href="#cb62-1567" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> n_vals <span class="sc">%&gt;%</span> </span>
<span id="cb62-1568"><a href="#cb62-1568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">sample =</span> X, <span class="at">domain =</span> domain) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1569"><a href="#cb62-1569" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-1570"><a href="#cb62-1570" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb62-1571"><a href="#cb62-1571" aria-hidden="true" tabindex="-1"></a>      <span class="at">F_true =</span> <span class="fu">punif</span>(x),</span>
<span id="cb62-1572"><a href="#cb62-1572" aria-hidden="true" tabindex="-1"></a>      <span class="at">scaled_centered =</span> <span class="fu">sqrt</span>(n)<span class="sc">*</span>(F_hat <span class="sc">-</span> F_true)</span>
<span id="cb62-1573"><a href="#cb62-1573" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-1574"><a href="#cb62-1574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1575"><a href="#cb62-1575" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1576"><a href="#cb62-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1577"><a href="#cb62-1577" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="dv">10</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="dv">100</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">*</span><span class="fl">1e3</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">*</span><span class="fl">1e4</span>), <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="fl">1e3</span>), <span class="fl">1e5</span>, runif, <span class="fu">list</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb62-1578"><a href="#cb62-1578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1579"><a href="#cb62-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1582"><a href="#cb62-1582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1583"><a href="#cb62-1583" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-1584"><a href="#cb62-1584" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot518</span></span>
<span id="cb62-1585"><a href="#cb62-1585" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-1586"><a href="#cb62-1586" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-1587"><a href="#cb62-1587" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-1588"><a href="#cb62-1588" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "10 "</span></span>
<span id="cb62-1589"><a href="#cb62-1589" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure."</span></span>
<span id="cb62-1590"><a href="#cb62-1590" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb62-1591"><a href="#cb62-1591" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-1592"><a href="#cb62-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1593"><a href="#cb62-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1594"><a href="#cb62-1594" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results  <span class="sc">%&gt;%</span> </span>
<span id="cb62-1595"><a href="#cb62-1595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb62-1596"><a href="#cb62-1596" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Actual Distribution</span><span class="st">`</span> <span class="ot">=</span> F_true,</span>
<span id="cb62-1597"><a href="#cb62-1597" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Empirical Distribution</span><span class="st">`</span> <span class="ot">=</span> F_hat</span>
<span id="cb62-1598"><a href="#cb62-1598" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1599"><a href="#cb62-1599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(x,n)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1600"><a href="#cb62-1600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"scaled_centered"</span>, <span class="st">"Scaled Difference, √n(F_hat - F_0)"</span>, <span class="st">"Distribution"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1601"><a href="#cb62-1601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, value, <span class="at">color =</span> name)) <span class="sc">+</span> </span>
<span id="cb62-1602"><a href="#cb62-1602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb62-1603"><a href="#cb62-1603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb62-1604"><a href="#cb62-1604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-1605"><a href="#cb62-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(n) <span class="sc">+</span></span>
<span id="cb62-1606"><a href="#cb62-1606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Sample Size: {closest_state}'</span>) <span class="sc">+</span></span>
<span id="cb62-1607"><a href="#cb62-1607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb62-1608"><a href="#cb62-1608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb62-1609"><a href="#cb62-1609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">""</span>)</span>
<span id="cb62-1610"><a href="#cb62-1610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1611"><a href="#cb62-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1612"><a href="#cb62-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1613"><a href="#cb62-1613" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hypothesis Testing </span></span>
<span id="cb62-1614"><a href="#cb62-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1617"><a href="#cb62-1617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1618"><a href="#cb62-1618" aria-hidden="true" tabindex="-1"></a>emp_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(sample){</span>
<span id="cb62-1619"><a href="#cb62-1619" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample)</span>
<span id="cb62-1620"><a href="#cb62-1620" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb62-1621"><a href="#cb62-1621" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(sample <span class="sc">&lt;</span> x) <span class="sc">/</span> n)</span>
<span id="cb62-1622"><a href="#cb62-1622" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-1623"><a href="#cb62-1623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">Vectorize</span>(output))</span>
<span id="cb62-1624"><a href="#cb62-1624" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1625"><a href="#cb62-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1626"><a href="#cb62-1626" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(domain, n, dist, dist_params, t){</span>
<span id="cb62-1627"><a href="#cb62-1627" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb62-1628"><a href="#cb62-1628" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-1629"><a href="#cb62-1629" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> domain,</span>
<span id="cb62-1630"><a href="#cb62-1630" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">emp_cdf</span>(X)(domain) <span class="sc">-</span> <span class="fu">punif</span>(domain))),</span>
<span id="cb62-1631"><a href="#cb62-1631" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> t</span>
<span id="cb62-1632"><a href="#cb62-1632" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1633"><a href="#cb62-1633" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">norm =</span> <span class="fu">max</span>(value))</span>
<span id="cb62-1634"><a href="#cb62-1634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1635"><a href="#cb62-1635" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1636"><a href="#cb62-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1637"><a href="#cb62-1637" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(N, domain, n, dist, dist_params){</span>
<span id="cb62-1638"><a href="#cb62-1638" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb62-1639"><a href="#cb62-1639" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">domain =</span> domain, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1640"><a href="#cb62-1640" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb62-1641"><a href="#cb62-1641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb62-1642"><a href="#cb62-1642" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1643"><a href="#cb62-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1644"><a href="#cb62-1644" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e3</span>, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="fl">1e3</span>), <span class="fl">1e3</span>, runif, <span class="fu">list</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb62-1645"><a href="#cb62-1645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1646"><a href="#cb62-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1649"><a href="#cb62-1649" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1650"><a href="#cb62-1650" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb62-1651"><a href="#cb62-1651" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot519</span></span>
<span id="cb62-1652"><a href="#cb62-1652" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb62-1653"><a href="#cb62-1653" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb62-1654"><a href="#cb62-1654" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb62-1655"><a href="#cb62-1655" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "10 "</span></span>
<span id="cb62-1656"><a href="#cb62-1656" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure."</span></span>
<span id="cb62-1657"><a href="#cb62-1657" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb62-1658"><a href="#cb62-1658" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-1659"><a href="#cb62-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1660"><a href="#cb62-1660" aria-hidden="true" tabindex="-1"></a>norms <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb62-1661"><a href="#cb62-1661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb62-1662"><a href="#cb62-1662" aria-hidden="true" tabindex="-1"></a>    iter_num, </span>
<span id="cb62-1663"><a href="#cb62-1663" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> norm</span>
<span id="cb62-1664"><a href="#cb62-1664" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1665"><a href="#cb62-1665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-1666"><a href="#cb62-1666" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb62-1667"><a href="#cb62-1667" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"norm"</span></span>
<span id="cb62-1668"><a href="#cb62-1668" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1669"><a href="#cb62-1669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb62-1670"><a href="#cb62-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1671"><a href="#cb62-1671" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb62-1672"><a href="#cb62-1672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, value)) <span class="sc">+</span></span>
<span id="cb62-1673"><a href="#cb62-1673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb62-1674"><a href="#cb62-1674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-1675"><a href="#cb62-1675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> norms, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb62-1676"><a href="#cb62-1676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num, <span class="at">transition_length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb62-1677"><a href="#cb62-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb62-1678"><a href="#cb62-1678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"|√n(F_hat - F_0)|"</span>) </span>
<span id="cb62-1679"><a href="#cb62-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1680"><a href="#cb62-1680" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb62-1681"><a href="#cb62-1681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1682"><a href="#cb62-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1685"><a href="#cb62-1685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1686"><a href="#cb62-1686" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb62-1687"><a href="#cb62-1687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb62-1688"><a href="#cb62-1688" aria-hidden="true" tabindex="-1"></a>    iter_num,</span>
<span id="cb62-1689"><a href="#cb62-1689" aria-hidden="true" tabindex="-1"></a>    norm</span>
<span id="cb62-1690"><a href="#cb62-1690" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-1691"><a href="#cb62-1691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-1692"><a href="#cb62-1692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(norm)) <span class="sc">+</span></span>
<span id="cb62-1693"><a href="#cb62-1693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">15</span>)  <span class="sc">+</span></span>
<span id="cb62-1694"><a href="#cb62-1694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb62-1695"><a href="#cb62-1695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1698"><a href="#cb62-1698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1699"><a href="#cb62-1699" aria-hidden="true" tabindex="-1"></a>pkolg <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb62-1700"><a href="#cb62-1700" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb62-1701"><a href="#cb62-1701" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x <span class="sc">&lt;=</span> <span class="dv">0</span>){</span>
<span id="cb62-1702"><a href="#cb62-1702" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb62-1703"><a href="#cb62-1703" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb62-1704"><a href="#cb62-1704" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">1-2</span><span class="sc">*</span><span class="fu">sum</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>((<span class="dv">1</span><span class="sc">:</span>k)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span>k)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb62-1705"><a href="#cb62-1705" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-1706"><a href="#cb62-1706" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1707"><a href="#cb62-1707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1708"><a href="#cb62-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1711"><a href="#cb62-1711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1712"><a href="#cb62-1712" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb62-1713"><a href="#cb62-1713" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb62-1714"><a href="#cb62-1714" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">sort</span>(x)) <span class="sc">-</span> (<span class="dv">0</span> <span class="sc">:</span> (n<span class="dv">-1</span>)) <span class="sc">/</span> n</span>
<span id="cb62-1715"><a href="#cb62-1715" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(x2, <span class="dv">1</span><span class="sc">/</span>n <span class="sc">-</span> x2))</span>
<span id="cb62-1716"><a href="#cb62-1716" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x, <span class="st">"pnorm"</span>)</span>
<span id="cb62-1717"><a href="#cb62-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1718"><a href="#cb62-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1719"><a href="#cb62-1719" aria-hidden="true" tabindex="-1"></a>D</span>
<span id="cb62-1720"><a href="#cb62-1720" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pkolg</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>D)</span>
<span id="cb62-1721"><a href="#cb62-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1722"><a href="#cb62-1722" aria-hidden="true" tabindex="-1"></a>kolg_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, dist){</span>
<span id="cb62-1723"><a href="#cb62-1723" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1724"><a href="#cb62-1724" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-1725"><a href="#cb62-1725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1726"><a href="#cb62-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1727"><a href="#cb62-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1728"><a href="#cb62-1728" aria-hidden="true" tabindex="-1"></a>https://github.com/SurajGupta/r-source/blob/master/src/library/stats/src/ks.c</span>
<span id="cb62-1729"><a href="#cb62-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1730"><a href="#cb62-1730" aria-hidden="true" tabindex="-1"></a>https://github.com/SurajGupta/r-source/blob/master/src/library/stats/R/ks.test.R</span>
<span id="cb62-1731"><a href="#cb62-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1732"><a href="#cb62-1732" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-1733"><a href="#cb62-1733" aria-hidden="true" tabindex="-1"></a>F_D(x) &amp;= 1 - 2\sum_{k=1}^\infty(-1)^{k-1}\exp(-2k^2x^2)<span class="sc">\\</span></span>
<span id="cb62-1734"><a href="#cb62-1734" aria-hidden="true" tabindex="-1"></a>f_D(x) &amp; = 8\sum_{k=1}^\infty(-1)^{k-1}xk^2\exp(-2k^2x^2)</span>
<span id="cb62-1735"><a href="#cb62-1735" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-1736"><a href="#cb62-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1737"><a href="#cb62-1737" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further Reading</span></span>
<span id="cb62-1738"><a href="#cb62-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1739"><a href="#cb62-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1740"><a href="#cb62-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1741"><a href="#cb62-1741" aria-hidden="true" tabindex="-1"></a>@newey1991uniform, @hansen2022probability chapter 18, @billingsleycon, @billingsley2008probability, @pollard2012convergence, @durbin1973distribution</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>