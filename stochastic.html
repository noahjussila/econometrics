<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Advanced Econometrics with Examples - 5&nbsp; Stochastic Processes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./adv_asymptotics.html" rel="next">
<link href="./exp_fam.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./estimators.html">Statistical Theory</a></li><li class="breadcrumb-item"><a href="./stochastic.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Stochastic Processes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Econometrics with Examples</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preliminaries</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Statistical Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Finite Sample Properties of Estimators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asymptotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Asymptotic Properties of Estimators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exp_fam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Exponential Families</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stochastic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Stochastic Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./adv_asymptotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Asymptotics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The Classical Linear Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./endog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Endogeniety I: IV and 2SLS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Generalized Least Squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simul.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Endogeniety II: Simultaneity and Multiple Regressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Estimation Frameworks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./extremum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Extremum Estimators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Generalized Method of Moments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Maximum Likelihood Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Basic Microeconometrics and Time Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./binary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Binary Choice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./panel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Panel Data I: The Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Basic Time Series</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonpar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonparametrics I: Distribution and Density Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonpar_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Nonparametrics II: Functional Forms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./semipar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Semiparametrics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sieve.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Sieve Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./partial_id.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Partial Identification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./endog_nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Endogeniety III: Nonlinear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./weak_inst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Endogeniety IV: Weak Instruments</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Microeconometrics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete_choice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Discrete Choice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tobit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Tobit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Count Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Mixed and Multilevel Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./panel2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Panel Methods II</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Time Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Math Review</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Causal Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causal1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Potential Outcomes Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Matching Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rdd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Regression Discontinuity Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./did.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Difference in Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LATE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Non-Compliance and LATE</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hetero.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Heterogeneous Treatment Effects</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">More Statistical Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Bayesian Estimation I: Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Bayesian Estimation II: Computation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Bayesian Estimation III: Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelselection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./robust.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Robust Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./learning_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Statistical Learning Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Supervised Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Dimmension Reduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Unsupervised Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Text Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ML meets Causal Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#reviewing-more-probability-theory" id="toc-reviewing-more-probability-theory" class="nav-link active" data-scroll-target="#reviewing-more-probability-theory"><span class="header-section-number">5.1</span> Reviewing More Probability Theory</a></li>
  <li><a href="#examples-of-stochastic-processes" id="toc-examples-of-stochastic-processes" class="nav-link" data-scroll-target="#examples-of-stochastic-processes"><span class="header-section-number">5.2</span> Examples of Stochastic Processes</a></li>
  <li><a href="#moments" id="toc-moments" class="nav-link" data-scroll-target="#moments"><span class="header-section-number">5.3</span> Moments</a></li>
  <li><a href="#stationarity" id="toc-stationarity" class="nav-link" data-scroll-target="#stationarity"><span class="header-section-number">5.4</span> Stationarity</a></li>
  <li><a href="#ergodicity" id="toc-ergodicity" class="nav-link" data-scroll-target="#ergodicity"><span class="header-section-number">5.5</span> Ergodicity</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./estimators.html">Statistical Theory</a></li><li class="breadcrumb-item"><a href="./stochastic.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Stochastic Processes</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Stochastic Processes</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="reviewing-more-probability-theory" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="reviewing-more-probability-theory"><span class="header-section-number">5.1</span> Reviewing More Probability Theory</h2>
<p>Given a probability space <span class="math inline">\((\mathcal X, \mathcal F, P)\)</span> and a set <span class="math inline">\(E\)</span> equipped with a sigma-algebra <span class="math inline">\(\mathcal E\)</span>, a random variable is some function <span class="math inline">\(X:\mathcal X\to E\)</span> such that <span class="math inline">\(X^{-1}(I) \in \mathcal F\)</span> for all <span class="math inline">\(I\in \mathcal E\)</span>. Until now, we’ve only dealt with the case <span class="math inline">\(E = \mathbb{R}\)</span> and <span class="math inline">\(\mathcal E = \mathcal B(\mathbb{R})\)</span>, so let’s look at random variables on other spaces. In particular, we’re interested in random variables defined on metric spaces.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.1 (Random Vectors)</strong></span> We’ve been interpreting a random vector <span class="math inline">\(\mathbf{X}= (X_1,\ldots,X_n)\)</span> as a collection of <span class="math inline">\(n\)</span> random scalars <span class="math inline">\(X_1:\mathcal X_1\to E_1,\ldots,X_n:\mathcal X_n\to E_n\)</span>. Alternatively, we could consider <span class="math inline">\(\mathbf{X}\)</span> to be a random variable mapping <span class="math inline">\(\mathcal X_1\times\cdots\times \mathcal X_n\)</span> to <span class="math inline">\(E^n\)</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> A special case of this is when we draw a sample of <span class="math inline">\(n\)</span> observations of <span class="math inline">\(X_i \overset{iid}{\sim}F_X\)</span>. If we execute <code>rnorm(10)</code>, it will return <span class="math inline">\(n\)</span> realizations of <span class="math inline">\(X:\mathbb{R}\to\mathbb{R}\)</span> which can also be interpreted as one realization of a random vector <span class="math inline">\(\mathbf{X}:\mathbb{R}^{10}\to\mathbb{R}^{10}\)</span>. Whether you think of the resulting data as 10 realizations of iid random variables or a single random vector will depend on the application. It’s usually easier to model problems with random vectors when random scalars aren’t iid. If we have <span class="math inline">\(X_1 \sim N(0,1)\)</span>, <span class="math inline">\(X_2 \sim N(1,2)\)</span>, and <span class="math inline">\(\text{Cov}\left(X_1, X_2\right) = 1\)</span>, then all the information about <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> can easily be summarized by <span class="math inline">\(\mathbf{X}= (X_1,X_2)\)</span> where <span class="math display">\[\mathbf{X}\sim N\left(\begin{bmatrix} 0\\ 1\end{bmatrix}, \begin{bmatrix} 1 &amp; 1\\ 1 &amp; 2\end{bmatrix}\right)\]</span></p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.2 (Random Matrices)</strong></span> We can combine random vectors into a single random matrix just like we combined random scalars into a random vector. For the sake of ease, we’ll only consider real valued random vectors here. Suppose we have <span class="math inline">\(k\)</span> random vectors <span class="math inline">\(\mathbf{X}_1,\ldots,\mathbf{X}_k\)</span>, each of length <span class="math inline">\(n\)</span>. We can form a <span class="math inline">\(n\times k\)</span> matrix using these vectors as column vectors. We’ll denote this random matrix with <span class="math inline">\(\mathbb{X}\)</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span class="math display">\[\mathbb{X}= \begin{bmatrix}\mathbf{X}_1 &amp; \cdots &amp;\mathbf{X}_k \end{bmatrix} =  \begin{bmatrix}X_{11} &amp; \cdots &amp;X_{k1} \\ \vdots &amp; \ddots &amp; \vdots\\ X_{1n} &amp; \cdots &amp;X_{kn} \end{bmatrix}\]</span> In this case, the random variable <span class="math inline">\(\mathbb{X}\)</span> takes on a value in the set of all <span class="math inline">\(n\times k\)</span> real matrices, <span class="math inline">\(\mathbb{R}^{n\times k}\)</span>. We could also consider <span class="math inline">\(\mathbb{X}\)</span> to be comprised of <span class="math inline">\(n\)</span> random vectors of length <span class="math inline">\(k\)</span>. <span class="math display">\[ \mathbb{X}= \begin{bmatrix}\mathbf{X}_1\\ \vdots \\ \mathbf{X}_k \end{bmatrix}.\]</span> This interpretation is particularly important when considering regression models where we observe <span class="math inline">\(n\)</span> realizations of <span class="math inline">\(k\)</span> regressors <span class="math inline">\(X_1,\ldots,X_k\)</span>.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A random object we’ve yet to talk about are stochastic processes. These will make for an excellent example in abstracting random variables beyond <span class="math inline">\(\mathbb{R}\)</span>.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.1</strong></span> Given a probability space <span class="math inline">\((\mathcal X, \mathcal F, P)\)</span>, suppose we have a collection of random variables <span class="math inline">\(\{X_t\}_{t\in T}\)</span> indexed by some set <span class="math inline">\(T\)</span> which take on values in the measurable space <span class="math inline">\((S, \mathcal S)\)</span>. The collection <span class="math inline">\(\{X_t\}_{t\in T}\)</span> is a <span style="color:red"><strong><em>stochastic process</em></strong></span>. We refer to <span class="math inline">\(S\)</span> as the <span style="color:red"><strong><em>state space</em></strong></span> and <span class="math inline">\(T\)</span> as the <span style="color:red"><strong><em>index set</em></strong></span>. If <span class="math inline">\(T = \mathbb N\)</span> then <span class="math inline">\(\{X_t\}_{t\in T}\)</span> is a <span style="color:red"><strong><em>discrete-time stochastic process</em></strong></span>. If <span class="math inline">\(T = \mathbb{R}^+\)</span> <span style="color:red"><strong><em>continuous-time stochastic process</em></strong></span></p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The index set is almost always denoted by <span class="math inline">\(T\)</span> because the main application of stochastic processes is modeling the evolution of random phenomena over time periods <span class="math inline">\(t\in T\)</span>. Each value <span class="math inline">\(t\in T\)</span> is mapped to a random variable <span class="math inline">\(X_t\)</span>, which takes on a realized value <span class="math inline">\(X_t(\omega)\in S\)</span> for some outcome <span class="math inline">\(\omega\in\mathcal X\)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Since <span class="math inline">\(X_t\)</span> is indexed by <span class="math inline">\(T\)</span>, we can actually think of a stochastic process as a function <span class="math inline">\(t\mapsto X_t\)</span>, and opt to write <span class="math inline">\(X(t)\)</span> or <span class="math inline">\(X(t,\omega)\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> This interpretation is how we’ll be able to define a stochastic process as a random variable.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.3 (Stochastic Processes as RVs)</strong></span> Given a state space <span class="math inline">\(S\)</span> and an index set <span class="math inline">\(T\)</span>, consider the set <span class="math inline">\(S^T\)</span> of all functions mapping <span class="math inline">\(T\)</span> to <span class="math inline">\(S\)</span>. A stochastic process <span class="math inline">\(\{X_t\}_{t\in T}\)</span> defined on the probability space <span class="math inline">\((\mathcal X, \mathcal F, P)\)</span> is a random variable <span class="math inline">\(X:\mathcal X\to S^T\)</span>. One realization of <span class="math inline">\(X(\omega)\in S^T\)</span> is a function from <span class="math inline">\(T\)</span> to <span class="math inline">\(S\)</span>. In the event that <span class="math inline">\(T =\mathbb N\)</span>, <span class="math inline">\(S^\mathbb N\)</span> is the set of sequences in <span class="math inline">\(S\)</span>, as a sequence in <span class="math inline">\(S\)</span> is just a function which assigns natural numbers to the elements of <span class="math inline">\(S\)</span>. This means that <span class="math inline">\(X:\mathcal X\to S^{\mathbb N}\)</span> is a random sequence. We often refer to realizations of stochastic processes as sample paths to emphasize the additional dimension given by <span class="math inline">\(T\)</span>.</p>
</div>
</section>
<section id="examples-of-stochastic-processes" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="examples-of-stochastic-processes"><span class="header-section-number">5.2</span> Examples of Stochastic Processes</h2>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.4 (IID draws)</strong></span> Suppose we have observe <span class="math inline">\(n\)</span> values of <span class="math inline">\(X_1,\ldots, X_n\)</span> where <span class="math inline">\(X_i\overset{iid}{\sim}F_X\)</span>. This is a discrete time stochastic process where the index set <span class="math inline">\(i=1,\ldots,n\)</span> is the set of units for which we observe <span class="math inline">\(X_i\)</span>. Whether it makes sense to interpret the <span class="math inline">\(n\)</span> realizations of <span class="math inline">\(X_i\)</span> as a stochastic process or not very much depends on the context in which we’re collecting our data and the phenomena we may be trying to model.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.5 (Simple Random Walk)</strong></span> Suppose we have a sequence of iid random variables <span class="math inline">\(Y_1,Y_2,\ldots\)</span> defined on the sample space <span class="math inline">\(\{-1,1\}\)</span> such that <span class="math inline">\(\Pr(Y_t = 1) = p\)</span> and <span class="math inline">\(\Pr(Y_t = -1) = 1-p\)</span> for all <span class="math inline">\(t\)</span>. We can think of <span class="math inline">\(Y_t\)</span> as a modified Bernoulli random variable where a “failure” corresponds to the value <span class="math inline">\(-1\)</span> instead of <span class="math inline">\(0\)</span>.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> Using the sequence <span class="math inline">\(Y_t\)</span> we can define a new sequence of random variables <span class="math inline">\(X_t\)</span> as <span class="math display">\[ X_t = \sum_{i=1}^t Y_i.\]</span> The sequence <span class="math inline">\(X_n\)</span> is a random walk. The name is due to a thought experiment corresponding to <span class="math inline">\(Y_n\)</span> and <span class="math inline">\(X_n\)</span>. Suppose someone is standing at a reference point (the origin <span class="math inline">\(0\)</span>) at time <span class="math inline">\(t=0\)</span>. At <span class="math inline">\(t=1\)</span> they flip a coin. If the flip results in a head they will take one step forward, but if the flip results in a tail they will take a step backwards. This is repeated for <span class="math inline">\(t=2,3,\ldots\)</span>. The outcome of the coin flip at time <span class="math inline">\(t\)</span> corresponds to the random variable <span class="math inline">\(Y_t\)</span>. At any time <span class="math inline">\(t\)</span>, the person’s position relative to the reference points is given as <span class="math inline">\(X_t\)</span>. Instead of considering <span class="math inline">\(X_1,X_2,\ldots\)</span> to be a sequence of separate random variables, we can think of <span class="math inline">\(X=(X_1,X_2,\ldots)\)</span> to be a single random variable defined on the space <span class="math inline">\(\mathbb Z^{\mathbb N}\)</span>. Let’s look at one realized value of <span class="math inline">\(X\)</span> taking <span class="math inline">\(p = 1/2\)</span>,<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> in which case our random walk is symmetric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>random_walk <span class="ot">&lt;-</span> <span class="cf">function</span>(n, dist, dist_params, t){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">step =</span> X) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">time =</span> <span class="fu">row_number</span>(),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">cumsum</span>(step),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> t</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">time =</span> <span class="dv">0</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="dv">0</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> t,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">.before =</span> <span class="dv">0</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>rredmacher <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p){</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p, p)))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">random_walk</span>(<span class="dv">20</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>), <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>iter_num) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>time) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"step"</span>, <span class="st">"position"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Step Y_t"</span>, <span class="st">"Position X_t"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(time, <span class="at">transition_length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>() <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time, t"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot51" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot51-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot51-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot51-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: One simulated realization of a random walk
</figcaption>
</figure>
</div>
</div>
</div>
<p>Since this is just one realization, it’s analogous to illustrating a random variable with a standard normal distribution with a histogram of a single value generated by <code>rnorm(n = 1)</code>. Let’s look at 1,000 simulated realizations of our random walk <span class="math inline">\(X=(X_1,X_2,\ldots)\)</span>.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>draw_n_random_walk <span class="ot">&lt;-</span> <span class="cf">function</span>(N, n, dist, dist_params){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span>  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(random_walk, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_n_random_walk</span>(<span class="fl">1e3</span>, <span class="dv">20</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">factor</span>(iter_num))) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Position"</span>) </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot52" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot52-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot52-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot52-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: 1,000 simulated realizations of the random walk.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can also investigate the individual terms of the random sequence <span class="math inline">\(X = (X_1,X_2,\ldots)\)</span> by treating them like their own random variables defined on <span class="math inline">\(\mathbb Z\)</span>. For 100,000 simulated realizations of <span class="math inline">\(X\)</span>, let’s look at the distribution of the realized values of <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_{10}\)</span>, <span class="math inline">\(X_{20}\)</span>, and <span class="math inline">\(X_{30}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_n_random_walk</span>(<span class="fl">1e5</span>, <span class="dv">30</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, position) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fl">1e5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"t = 1"</span>, <span class="st">"t =10"</span>, <span class="st">"t = 20"</span>, <span class="st">"t = 30"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(position, freq)) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">xend =</span> position, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> freq)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>time) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"position"</span>, <span class="at">y =</span> <span class="st">"frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot53" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot53-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot53-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot53-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Distribution of simulated positions at various times.
</figcaption>
</figure>
</div>
</div>
</div>
<p>It is no coincidence that as <span class="math inline">\(t\)</span> increases, the distribution of <span class="math inline">\(X_t\)</span> appears to resemble a normal distribution. To show this we’ll need to find the probability mass function of <span class="math inline">\(X_t\)</span> which gives <span class="math inline">\(\Pr(X_t = x)\)</span> for <span class="math inline">\(x\in\{-t,-t+1,\ldots,t-1,t\}\subset \mathbb Z\)</span>. First note that the probability that <span class="math inline">\(k\)</span> steps forward and <span class="math inline">\(t-k\)</span> steps backwards are taken follows a binomial distribution, since <span class="math inline">\(I(Y_i = 1)\sim \text{Ber}(p)\)</span>. <span class="math display">\[ \Pr(\textstyle\sum_{i=1}^t I(Y_i = 1)) = \binom{t}{k}p^k(1-p)^{t-k}\]</span> We can write the number of steps forward <span class="math inline">\(k\)</span> in position <span class="math inline">\(x\)</span> by noting that <span class="math inline">\(x = k - (t-k) = 2k-t,\)</span> so <span class="math inline">\(k = (t+x)/2\)</span>. <span class="math display">\[f_{X_t}(x \mid t, p) = \binom{t}{(t+x)/2}p^{(t+x)/2}(1-p)^{t-(t+x)/2}.\]</span> Since <span class="math inline">\(X_t\)</span> follows a variant of the binomial distribution, as <span class="math inline">\(t\to\infty\)</span> the normal approximation of the binomial distribution holds with increasing accuracy. The parameters of this normal distribution are given by the expected value and variance of <span class="math inline">\(X_t\)</span>. These are <span class="math display">\[\begin{align*}
\text{E}\left[X_t\right] &amp;= \text{E}\left[\sum_{i=1}^t Y_i\right] \\&amp;= \sum_{i=1}^t \text{E}\left[Y_i\right] &amp; (\text{E}\left[\cdot\right]\text{ linear})\\ &amp;= t\left[p\cdot 1 + (1-p)(-1) \right] &amp; (Y_i\text{ iid})\\ &amp; = t(2p-1)\\
\text{Var}\left(X_t\right) &amp;= \text{Var}\left(\sum_{i=1}^t Y_i\right)\\
        &amp; = \sum_{i=1}^t \text{Var}\left(Y_i\right) &amp; (Y_i\text{ iid})\\
        &amp; = t\left[\text{E}\left[Y_i^2\right] - \text{E}\left[Y_i\right]^2\right] \\
        &amp; = t[1 - (2p-1)^2] &amp; (Y_i^2 = 1)\\
        &amp; = 4tp(1-p)
\end{align*}\]</span> If <span class="math inline">\(p = 1/2\)</span> and <span class="math inline">\(t = 100\)</span>, we should expect that the distribution of <span class="math inline">\(X_t\)</span> resembles <span class="math inline">\(N(0,100)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_n_random_walk</span>(<span class="fl">1e5</span>, <span class="dv">100</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">==</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(position)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">colour =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">binwidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> t<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>p <span class="sc">-</span> <span class="dv">1</span>), <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">*</span>t<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">x =</span> <span class="st">"Random Walk Position at t=100"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot54" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot54-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot54-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot54-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: Position of random walk at time t=100 for 100,000 simulations with a normal distribution with µ=0 and σ=10 overlaid.
</figcaption>
</figure>
</div>
</div>
</div>
<p>This entire examples happens to be just one very stylized example of a random walk. There exists numerous interesting extensions with valuable applications.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.6 (Wiener Process)</strong></span> One of the most famous random function is the the Wiener process. This continuous-time stochastic process plays a key role in physics as it’s a mathematical formalization of Brownian motion.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> Brownian motion refers to the behavior of particles that are continuously moving randomly about. For instance, gas molecules move rapidly about colliding with other molecules, resulting in seemingly random movement. Formally, the Weiner process <span class="math inline">\(W = \{W_t\}_{t\in \mathbb{R}^+}\)</span> is a random variable <span class="math inline">\(W:\mathcal X\to C( \mathbb{R}^+)\)</span> for some probability space <span class="math inline">\((\mathcal X, \mathcal F, P)\)</span> where <span class="math inline">\(C( \mathbb{R}^+)\)</span> is the set of all real continuous functions defined on the unit interval $ ^+$.process <span class="math inline">\(\{W_t\}_{t\in \mathbb{R}^+}\)</span> satisfies:</p>
<ol type="1">
<li><span class="math inline">\(W_0 = 0\)</span>. The process’ initial value at time <span class="math inline">\(t=0\)</span> is always <span class="math inline">\(0\)</span>.</li>
<li>For all <span class="math inline">\(t\in \mathbb{R}^+\)</span>, <span class="math inline">\(W_{t+u} - W_t \perp W_s\)</span> for <span class="math inline">\(u \ge 0\)</span> and <span class="math inline">\(s &lt; t\)</span>. The process has independent increments. In other words, the “movement” of the process between times <span class="math inline">\(t\)</span> and <span class="math inline">\(t+u\)</span> is independent of the processes location prior to <span class="math inline">\(t\)</span> (at time <span class="math inline">\(s\)</span>). Another way to think of this property is that the process is “memoryless” in the sense that future movement of the process only depends on its current position and not how it got to that position.</li>
<li>For all <span class="math inline">\(t\in \mathbb{R}^+\)</span>, <span class="math inline">\(W_{t+u}-W_t\sim N(0,u)\)</span> for <span class="math inline">\(u \ge 0\)</span>. This is equivalent to <span class="math inline">\(W_t - W_s \sim N(0,t-s)\)</span> for <span class="math inline">\(s\le t\)</span>, which can also be written as <span class="math inline">\(W_t-W_s\sim \sqrt{t-s}\cdot N(0,1)\)</span></li>
</ol>
<p>A fourth property that we’ve implicitly assumed by defining <span class="math inline">\(W\)</span> to be a <span class="math inline">\(C( \mathbb{R}^+)\)</span>-valued random variable is that <span class="math inline">\(W\)</span> is continuous. <em>A priori</em>, it isn’t obvious that there exists a process which satisfies all of these properties, but we will take its existence as given.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<p>One of the limitations of turning to simulations to illlustrate <span class="math inline">\(W\)</span> is that we aren’t able to graph a truly continuous (non-linear) function on a computer.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> You may be thinking” “well no duh, this is obvious! Why are you bringing up something so basic and trivial?” It’s worth emphasizing because this entire example is meant to illustrate a continuous stochastic process, which unfortunately we need to do by simulating a discrete analog. Suppose we have <span class="math inline">\(N\)</span> evenly spaced points in <span class="math inline">\([0,1]\)</span>, such that time increments are <span class="math inline">\(dt = 1/N\)</span>. We have <span class="math display">\[\begin{align*}
W_0 &amp; = 0,\\
W_j &amp; = W_{j-1} + dW_{j}, &amp; (j = 1,\ldots, N)\\
dW_j &amp; \overset{iid}{\sim}N(0, dt).
\end{align*}\]</span> We’ll set <span class="math inline">\(N = 1\times10^7\)</span>, which is such a large value that we’ll be able to just treat <span class="math inline">\(W\)</span> as if it was truly continuous. Let’s simulate a single realization of <span class="math inline">\(W\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw one realization of wiener process</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   N = number of discrete points to calculate process at</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   T_max = maximum time value to calculate process at</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   s = parameter to iterate over if we want to draw multiple realizations</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>wiener <span class="ot">&lt;-</span> <span class="cf">function</span>(N, T_max, s){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> T_max<span class="sc">/</span>N</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">dW =</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> <span class="fu">sqrt</span>(dt)),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">seq</span>(dt, T_max, dt),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">cumsum</span>(dW)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">value =</span> <span class="dv">0</span>, <span class="at">time =</span> <span class="dv">0</span>, <span class="at">iter_num =</span> s, <span class="at">.before =</span> <span class="dv">0</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">wiener</span>(<span class="fl">1e5</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">"Value of W at t"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot55" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot55-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot55-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot55-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: One realization of the Wiener process on the unit interval [0,1].
</figcaption>
</figure>
</div>
</div>
</div>
<p>Since <span class="math inline">\(W\)</span> is continuous it’s defined for all values in the interval <span class="math inline">\([0,1]\)</span>, so we can “zoom” in on increasingly small subsets of <span class="math inline">\([0,1]\)</span>, and <span class="math inline">\(W\)</span> will still be defined for all <span class="math inline">\(t\)</span>.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>zoom_in <span class="ot">&lt;-</span> <span class="cf">function</span>(W, t){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(time <span class="sc">&lt;=</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_time =</span> t,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">zoom_factor =</span> <span class="dv">1</span><span class="sc">/</span>t</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(zoom_in, <span class="at">W =</span> results) <span class="sc">%&gt;%</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(zoom_factor) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view_follow</span>() <span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">"Value of W at t"</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">nframes =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot56" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot56-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot56-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot56-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6: ``Zooming in’’ on the Wiener process.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that as we “zoom in” the sample path has the same jagged appearance of <span class="math inline">\(W\)</span> on all of <span class="math inline">\([0,1]\)</span>. This is because the Wiener process is closely linked to the idea of a fractal.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> Another interesting feature is that <span class="math inline">\(W\)</span> is nowhere differentiable despite being continuous on account of it being comprised of an infinite number of “kinks”.</p>
<p>Now that we’ve seen one sample path, let’s draw 100 realizations of <span class="math inline">\(W\)</span> to get a sense of the relative frequency of certain paths.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>draw_wiener <span class="ot">&lt;-</span> <span class="cf">function</span>(M, N, T_max){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(wiener, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener</span>(<span class="fl">1e2</span>, <span class="fl">1e4</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot57" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot57-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot57-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot57-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.7: 1,000 simulated realizations of the Wiener process
</figcaption>
</figure>
</div>
</div>
</div>
<p>Another way to visualize these realizations is by looking at the distribution of the simulated values of <span class="math inline">\(W\)</span> at various values of <span class="math inline">\(t\)</span>. Since <span class="math inline">\(W_t - W_s \sim N(0, t-s)\)</span> and <span class="math inline">\(W_0 = 0\)</span>, we should expect that <span class="math display">\[W_t = W_t - 0  = W_t - W_0 \sim N(0,t-0) = N(0,t).\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw one realization of wiener process at times t (approximately)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>wiener_t <span class="ot">&lt;-</span> <span class="cf">function</span>(N, T_max, t, s){ </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">wiener</span>(N, T_max, s)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pick the values where W_t is calculated that are closest to the times of interest</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  t_filter <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand_grid</span>(<span class="at">given_t =</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dist =</span> <span class="fu">abs</span>(time <span class="sc">-</span> given_t)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(given_t) <span class="sc">%&gt;%</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dist <span class="sc">==</span> <span class="fu">min</span>(dist)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>()</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(time <span class="sc">%in%</span> t_filter) <span class="sc">%&gt;%</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>dW)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw M realizations of wiener process at vector of times t_vals</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>draw_wiener_t <span class="ot">&lt;-</span> <span class="cf">function</span>(M, t, T_max, N){</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(wiener_t, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max, <span class="at">t =</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(<span class="fl">1e5</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> time, <span class="at">group =</span> time)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges2</span>(<span class="at">scale =</span> <span class="dv">5</span>, <span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">rel_min_height =</span> <span class="fl">0.007</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"W_t"</span>, <span class="at">y =</span> <span class="st">"Time t"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample Mean'</span> <span class="ot">=</span> <span class="fu">mean</span>(value),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample Variance'</span> <span class="ot">=</span> <span class="fu">var</span>(value)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>time) <span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">label=</span> <span class="st">"Var(W_t) = t"</span>) <span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label=</span> <span class="st">"E[W_t] = 0"</span>) <span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot58" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot58-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot58-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot58-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.8: The top panel shows the density of the Wiener process at 10 fixed times calculated using 100,000 simulations. The bottom panel shows the sample analogs of expectation and variance for the process calculated at the fixed times, along with the theoretical values for comparison.
</figcaption>
</figure>
</div>
</div>
</div>
<p>For further confirmation that <span class="math inline">\(W_t - W_s \sim N(0, t-s)\)</span>, let’s calculate the sample variance associated with our realizations of <span class="math inline">\(W_t - W_s\)</span> for all <span class="math inline">\(s,t\in[0.1, 0.2,\ldots,0.9,1]\)</span> satisfying <span class="math inline">\(s \le t\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For a grid of time values, calculate var_st at each point {(s,t) ∈ t_grid² | s ≤ t} over M simulations</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(M, t_grid, T_max, N){</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define function to calculate variance</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  var_st <span class="ot">&lt;-</span> <span class="cf">function</span>(W, s, t){</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(t <span class="sc">==</span> s){</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(s,t)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(iter_num) <span class="sc">%&gt;%</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">diff =</span> value <span class="sc">-</span> <span class="fu">lag</span>(value, <span class="at">order_by =</span> time)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarize</span>(<span class="fu">var</span>(diff, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(output)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># draw M realizations of W at grid of times</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(M, t_grid, T_max, N)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply var_st to all combinations of times</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">unique</span>(W<span class="sc">$</span>time),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">unique</span>(W<span class="sc">$</span>time)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(s <span class="sc">&lt;=</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">var =</span> <span class="fu">var_st</span>(W, s, t))</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e5</span>, (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(s,t, <span class="at">fill =</span> var)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">lwd =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(var,<span class="dv">3</span>)), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Var(W_t - W_s)"</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.line =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot59" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot59-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot59-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot59-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.9: The sample variance associated with W_t - W_s calculated using 100,000 simulations.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We have <span class="math inline">\(\widehat{\text{Var}}(W_t-W_s) \approx t-s\)</span> as anticipated! Finally, we can provide visual evidence that <span class="math inline">\(W_{t+u} - W_t \perp W_s\)</span> for <span class="math inline">\(u \ge 0\)</span> and <span class="math inline">\(s &lt; t\)</span>. We’ll let <span class="math inline">\(t = 0.3\)</span>, <span class="math inline">\(u=0.1\)</span>, and <span class="math inline">\(s = 0.2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(<span class="fl">1e5</span>, (<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.4</span>] <span class="sc">-</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.3</span>],</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.2</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"W_4 - W_3"</span>, <span class="at">y =</span> <span class="st">"W_2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot595" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot595-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot595-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot595-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.10: 100,000 realized values of (W_4 - W_3) plotted against the corresponding 100,000 realized values of W_2.
</figcaption>
</figure>
</div>
</div>
</div>
<p>From this figure, the two random variables certainly appear to be independent.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Wiener process is just one instance of a stochastic process that “looks like” a normal distribution at specific points <span class="math inline">\(t\in T\)</span>. These types of processes are so special that they are simply known as Gaussian.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.2</strong></span> Let <span class="math inline">\(\{X_t\}_{t\in T}\)</span> be a stochastic process over the state space <span class="math inline">\(\mathbb{R}\)</span>. The process is a <span style="color:red"><strong><em>Gaussian process</em></strong></span> if for any finite set of indices <span class="math inline">\(t_1,\ldots,t_k\in T\)</span>, the random vector <span class="math inline">\(\mathbf{X}= (X_{t_1},\ldots, X_{t_k})\)</span> is distributed according to a multivariate normal distribution.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The defining properties of the Wiener process immediately establish it as a Gaussian process. To find the explicit normal distribution referenced in the definition of a Gaussian process we need to calculate the covariance of <span class="math inline">\(W_t\)</span> and <span class="math inline">\(W_s\)</span>. <span class="math display">\[\begin{align*}
\text{Cov}\left(W_t,W_s\right) &amp;= \begin{cases} \text{Cov}\left(W_t-0, W_s\right) &amp; t &gt; s\\ \text{Cov}\left(W_t, W_s + 0\right) &amp; s\le t \end{cases} \\&amp;= \begin{cases} \text{Cov}\left(W_t-W_s+W_s, W_s\right) &amp; t &gt; s\\ \text{Cov}\left(W_t, W_s + W_t- W_t\right) &amp; s\le t\end{cases}\\
&amp;= \begin{cases} \text{Cov}\left(W_t-W_s, W_s\right)+\text{Cov}\left(W_s,W_s\right) &amp; t &gt; s\\ \text{Cov}\left(W_t, W_s-W_t\right) + \text{Cov}\left(W_t,W_t\right)&amp; s\le t \end{cases}\\
&amp; = \begin{cases} 0 + \text{Var}\left(W_s\right) &amp; t &gt; s\\ 0 + \text{Var}\left(W_t\right)&amp; s\le t \end{cases} &amp; (\text{independent increments})\\
&amp; = \begin{cases} s &amp; t &gt; s\\ t&amp; s\le t \end{cases}\\
&amp; = \min\{s,t\}
\end{align*}\]</span> Therefore, for any <span class="math inline">\(\mathbf W = (W_{t_1},\ldots, W_{t_k})\)</span> where <span class="math inline">\(t_1,\ldots,t_k \in [0,T]\)</span> we have <span class="math display">\[\begin{align*}
\mathbf W &amp;\sim N(\mathbf{0},\boldsymbol{\Sigma}),\\
\boldsymbol{\Sigma}_{j\ell}&amp;=\begin{cases}t_j &amp; j = \ell \\ \min\{t_j,t_{\ell}\} &amp; \text{otherwise} \end{cases}.
\end{align*}\]</span></p>
<p>Let’s look at another example of a Gaussian process by tweaking the Wiener process.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.7 (Brownian Bridge)</strong></span> A process closely related to the Wiener Process is a Brownian bridge. For all intents and purposes, a Brownian bridge is a Wiener-like process which “bridges” two points <span class="math inline">\(a,b\in \mathbb{R}\)</span> on on the interval <span class="math inline">\([0,T]\)</span>. The simplest form of the Brownian bridge has <span class="math inline">\(a=b=0\)</span>, and is defined via conditioning as <span class="math display">\[ B(t)  = (W(t) \mid W(T) = 0)\]</span> for <span class="math inline">\(t\in [0,T]\)</span>. This is often called the “standard” Brownian bridge, and often has <span class="math inline">\(T=1\)</span>. We can construct this process by defining <span class="math inline">\(B(t)\)</span> as <span class="math display">\[B(t) = W(t) - \frac{t}{T}W(T).\]</span> To bridge a general choice of <span class="math inline">\(a,b\in\mathbb{R}\)</span>, we’ll start by connecting the two points with a straight line parameterized by <span class="math inline">\(t\in[0,T]\)</span>, <span class="math inline">\((1-t/T)a+(t/T)b\)</span>. To modify this line, we’ll add the standard Brownian bridge <span class="math inline">\(B(t)\)</span>.</p>
<p><span class="math display">\[\begin{align*}
B(t\mid a,b) &amp;= \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + B(t)\\
&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W(t) - \frac{t}{T}W(T)
\end{align*}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>brownian_bridge <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">T_max =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, s){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Start by drawing standard Wiener process on [0,T]</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">wiener</span>(N, T_max, <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># define B(t) using W(t)</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> (<span class="dv">1</span> <span class="sc">-</span> time<span class="sc">/</span>T_max)<span class="sc">*</span>a <span class="sc">+</span> (time<span class="sc">/</span>T_max)<span class="sc">*</span>b <span class="sc">+</span> value <span class="sc">-</span> (time<span class="sc">/</span>T_max)<span class="sc">*</span><span class="fu">last</span>(value, <span class="at">order_by =</span> time),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> s</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>draw_brownian_bridge <span class="ot">&lt;-</span> <span class="cf">function</span>(n, N, <span class="at">T_max =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>){</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n <span class="sc">%&gt;%</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(brownian_bridge, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max, <span class="at">a =</span> a, <span class="at">b =</span> b) <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_brownian_bridge</span>(<span class="fl">7e3</span>, <span class="fl">1e4</span>, <span class="at">T_max =</span> <span class="dv">2</span>, <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(iter_num <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot5952" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot5952-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot5952-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot5952-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.11: 100 realizations of the standard Brownian bridge
</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s consider the random variable given by the Brownian bridge takes on at a specific point in time <span class="math inline">\(t\in[t_1,t_2]\)</span> which we will write as <span class="math inline">\(B_{t\mid a,b, t_1, t_2}\)</span>. We can derive the distribution of this random variable using properties of the normal distribution and <span class="math inline">\(W_t\sim N(0,t)\)</span>.</p>
<p><span class="math display">\[\begin{align*}
B_{t\mid a,b}&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W(t) - \frac{t}{T}W(T) \\
&amp; \sim \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t) - \frac{t}{T}N(0,T)\\
&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t) - N(0,t^2/T)\\
&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t(T - t)/T)\\
&amp; = N\left( \left(1-\frac{t}{T}\right)a + \frac{t}{T}b, \left(\frac{t(T-t)}{T}\right)\right)
\end{align*}\]</span></p>
<p>To calculate the covariance of the Brownian bridge at two points, we first need to calculate the covariance</p>
<p><span class="math display">\[\begin{align*}
\text{Cov}\left(B_{t\mid a,b}, B_{s\mid a,b}\right) &amp;= \text{Cov}\left(\left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W_t - \frac{t}{T}W_T, \left(1-\frac{s}{T}\right)a + \frac{s}{T}b + W_s - \frac{s}{T}W_T\right)\\
&amp; = \text{Cov}\left(W_t - \frac{t}{T}W_T, W_s - \frac{s}{T}W_T\right) \\
&amp; = \text{Cov}\left(W_t, W_s\right) - \frac{s}{T}\text{Cov}\left(W_t, W_T\right) - \frac{t}{T}\text{Cov}\left(W_T, W_s\right) + \frac{st}{T^2}\text{Cov}\left(W_T, W_T\right)\\
&amp; = \min\{t,s\} - \frac{s}{T}\min\{t, T\} - \frac{t}{T}\min\{s, T\} + \frac{st}{T^2}\text{Var}\left(W_T\right)\\
&amp; = \min\{t,s\} - \frac{st}{T} - \frac{st}{T} - \frac{stT}{T^2}\\
&amp; = \min\{t,s\} - \frac{st}{T}
\end{align*}\]</span></p>
<p>If we combine these two calculations, we can conclude that for any <span class="math inline">\(t_1,\ldots,t_k\in [0,T]\)</span> we have <span class="math display">\[\begin{align*}
\mathbf W &amp;\sim N(\boldsymbol{\mu},\boldsymbol{\Sigma}),\\
\boldsymbol{\mu}_j &amp;= \left(1-\frac{t}{T}\right)a + \frac{t}{T}b,\\
\boldsymbol{\Sigma}_{j\ell}&amp;=\begin{cases}\frac{t_j(T-t_j)}{T} &amp; j = \ell \\ \min\{t_j,t_{\ell}\} - \frac{t_jt_\ell}{T} &amp; \text{otherwise} \end{cases},
\end{align*}\]</span> making <span class="math inline">\(B(t\mid a,b)\)</span> a Gaussian process. The Brownian bridge is an important tool and can be generalized to arbitrary intervals <span class="math inline">\([t_1,t_2]\subseteq [0,T]\)</span>. For details see pages 82-86 of <span class="citation" data-cites="glasserman2004monte">Glasserman (<a href="#ref-glasserman2004monte" role="doc-biblioref">2004</a>)</span>.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.8 (Gaussian White Noise)</strong></span> The simplest of Gaussian processes is a discrete-time white noise process <span class="math inline">\(\varepsilon\)</span> where <span class="math inline">\(\varepsilon_t \overset{iid}{\sim}N(0, \sigma^2)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>gaussian_wn <span class="ot">&lt;-</span> <span class="cf">function</span>(T_max, <span class="at">sigma =</span> <span class="dv">1</span>, s){</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(T_max, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">t =</span> <span class="fu">row_number</span>(),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> s</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>draw_gaussian_wn <span class="ot">&lt;-</span> <span class="cf">function</span>(n, T_max, <span class="at">sigma =</span> <span class="dv">1</span>){</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n <span class="sc">%&gt;%</span> </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(gaussian_wn, <span class="at">T_max =</span> T_max, <span class="at">sigma =</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_gaussian_wn</span>(</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_max =</span> <span class="fl">1e4</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, value)) <span class="sc">+</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot5953" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot5953-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot5953-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot5953-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.12: 100 realizations of a Gaussian white noise process.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One last example of a stochastic process is especially important in econometrics and is much easier to think of as a random function than more traditional examples of stochastic processes which are typically given as an indexed collection of random variables.</p>
<div id="exm-rf" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.9 (A Random Function)</strong></span> Imagine we observe an iid random sample <span class="math inline">\(\mathbf{X}= (X_1,\ldots, X_n)\)</span> where <span class="math inline">\(X_i\overset{iid}{\sim}N(\mu,\sigma^2)\)</span>, and we want to measure the distance a number <span class="math inline">\(t\in\mathbb{R}\)</span> is from the sample <span class="math inline">\(\mathbf{X}\)</span>. One way to do this is with the Euclidean metric. If <span class="math inline">\(\mathbf e\)</span> is the unit vector of length <span class="math inline">\(n\)</span> then the distance between <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(t\)</span> is <span class="math display">\[ \left\lVert\mathbf{X}- t\cdot\mathbf e\right\rVert_2 = \left(\textstyle\sum_{i=1}^n(X_i - t)^2\right)^{1/2}.\]</span> If we define <span class="math inline">\(Q_t = \left\lVert\mathbf{X}- t\cdot\mathbf e\right\rVert_2\)</span>, then <span class="math inline">\(Q = \{Q_t\}_{t\in\mathbb{R}}\)</span> is a stochastic process which maps <span class="math inline">\(\mathbb{R}\)</span> to functions in the space <span class="math inline">\(\mathbb{R}^\mathbb{R}\)</span> (the set of all single variable real functions). Let’s look at 100 simulated values of the process <span class="math inline">\(Q\)</span> where <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma^2 = 1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define random function Q_t</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, t){</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">sum</span>((sample<span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># draw n values and calculate Q_t on a given domain</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(f, domain, n, dist, dist_params, s){</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> domain, </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q =</span> <span class="fu">map_dbl</span>(domain, f, <span class="at">sample =</span> X),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> n</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># draw N realizations of Q_t on the domain</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(N, f, domain, n, dist, dist_params){</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">f =</span> f, <span class="at">domain =</span> domain, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot510" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot510-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot510-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot510-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.13: 100 realizations of an aggregated distance of a real number from a random sample calculated using the Euclidean metric.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In each case the realized value of <span class="math inline">\(Q\)</span> is a parabola which happens to be continuously differentiable, so <span class="math inline">\(Q:\mathbb{R}\to C^2(\mathbb{R})\)</span>. We could also define <span class="math inline">\(Q\)</span> using the the norm <span class="math inline">\(\left\lVert\cdot\right\rVert_1\)</span> (giving the taxi-cab metric) or <span class="math inline">\(\left\lVert\cdot\right\rVert_\infty\)</span> (giving the supremum metric). <span class="math display">\[\begin{align*}
\left\lVert\mathbf{X}- t\cdot\mathbf e\right\rVert_1 &amp;= \left(\textstyle\sum_{i=1}^n\left\lvert X_i - t\right\rvert\right)\\
\left\lVert\mathbf{X}- t\cdot\mathbf e\right\rVert_\infty &amp; = \max_{i}\left\lvert X_i-t\right\rvert
\end{align*}\]</span></p>
<p>In both these cases, the realized value of <span class="math inline">\(Q\)</span> will not be differentiable on all of <span class="math inline">\(\mathbb{R}\)</span> since <span class="math inline">\(\left\lvert x_i - t\right\rvert\)</span> is not differentiable at the point <span class="math inline">\(t=x_i\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample,t){</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(sample<span class="sc">-</span>t))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot511" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot511-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot511-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot511-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.14: 100 realizations of an aggregated distance of a real number from a random sample calculated using the taxi-cab metric. While the realization of the stochastic process appears smooth, it has slight kinks at which it is not differentiable.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample,t){</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">abs</span>(sample<span class="sc">-</span>t))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot512" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot512-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot512-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot512-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.15: 100 realizations of an aggregated distance of a real number from a random sample calculated using the supremum metric.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="moments" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="moments"><span class="header-section-number">5.3</span> Moments</h2>
<p>In some of our examples we saw that if we fix some arbitrary time <span class="math inline">\(t\)</span>, we can think of the stochastic process <span class="math inline">\(X(t)\in S^T\)</span> as a random variable <span class="math inline">\(X_t \in S\)</span>. We can consider the expected value <span class="math inline">\(\text{E}\left[X_t\right]\)</span> and variance <span class="math inline">\(\text{Var}\left(X_t\right)\)</span> of this random variable <span class="math inline">\(X_t\)</span> like we would any other random variable we’re more familiar with. The only thing that is a bit different is that <span class="math inline">\(\text{E}\left[X_t\right]\)</span> and <span class="math inline">\(\text{Var}\left(X_t\right)\)</span> may be functions of <span class="math inline">\(t.\)</span> In the case of the expected value, this function has a specific name.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.3</strong></span> Let <span class="math inline">\(X = \{X_t\}_{t\in \mathbb N}\)</span> be a stochastic process over the state space <span class="math inline">\(\mathbb{R}\)</span>. The <span style="color:red"><strong><em>mean-function</em></strong></span> <span class="math inline">\(\mu(t):T\to \mathbb{R}\)</span> for the process <span class="math inline">\(X\)</span> is defined as <span class="math inline">\(\mu(t) = \text{E}\left[X_t\right]\)</span>.</p>
</div>
<p>We also have a special name for the covariance between two random variables in the event that both are given by the same stochastic process evaluated at two different points in <span class="math inline">\(T\)</span>.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.4</strong></span> Let <span class="math inline">\(X = \{X_t\}_{t\in  T}\)</span> be a stochastic process over the state space <span class="math inline">\(\mathbb{R}\)</span> where <span class="math inline">\(T\subseteq \mathbb{R}\)</span>. The <span style="color:red"><strong><em><span class="math inline">\(j\)</span>th autocovariance</em></strong></span> of <span class="math inline">\(X_t\)</span> is defined as <span class="math display">\[\gamma_{jt} = \text{Cov}\left(X_{t}, X_{t-j}\right) = \text{E}\left[ (X_{t}-\mu(t)) (X_{t-j}-\mu(t-j))\right] = \text{E}\left[X_tX_{t-j}\right] - \mu(t)\mu(t-j)\]</span> for some time <span class="math inline">\(t\)</span> and increment <span class="math inline">\(j\)</span>. For a finite collection of increments <span class="math inline">\(j = 1,\ldots,t\)</span> we can define the <span style="color:red"><strong><em>autocovariance matrix</em></strong></span> <span class="math inline">\(\boldsymbol \Gamma\)</span> as <span class="math display">\[\begin{align*}
\boldsymbol \Gamma &amp;= \text{Var}\left([X_t, X_{t-1}, \ldots, X_{t-j}]'\right),\\
&amp; = \begin{bmatrix}\text{Cov}\left(X_t, X_t\right) &amp; \text{Cov}\left(X_t, X_{t-1}\right) &amp; \cdots &amp; \text{Cov}\left(X_t, X_{t-j}\right)\\
\text{Cov}\left(X_{t-1}, X_{t}\right) &amp; \text{Cov}\left(X_{t-1}, X_{t-1}\right) &amp; \cdots &amp; \text{Cov}\left(X_{t-1}, X_{t-1}\right)\\ \vdots &amp; \vdots &amp; \ddots &amp;\vdots \\
\text{Cov}\left(X_{t-j}, X_{t}\right) &amp; \text{Cov}\left(X_{t-j}, X_{t-1}\right) &amp; \cdots &amp; \text{Cov}\left(X_{t-j}, X_{t-j}\right)\end{bmatrix},\\
&amp; = \begin{bmatrix}
\gamma_{0t} &amp; \gamma_{1t} &amp; \gamma_{2t} &amp; \cdots &amp; \gamma_{jt}\\
\gamma_{1t} &amp; \gamma_{0(t-1)} &amp; \gamma_{1(t-1)} &amp; \cdots &amp; \gamma_{(j-1)(t-1)}\\
\gamma_{2t} &amp; \gamma_{1(t-1)} &amp; \gamma_{0(t-2)} &amp; \cdots &amp; \gamma_{(j-2)(t-2)}\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\gamma_{jt} &amp; \gamma_{(j-1)(t-1)} &amp; \gamma_{(j-2)(t-2)} &amp; \cdots &amp; \gamma_{0(t-j)}
\end{bmatrix}.
\end{align*}\]</span> The <span style="color:red"><strong><em><span class="math inline">\(j\)</span>th autocorrelation</em></strong></span> of <span class="math inline">\(X_t\)</span> is defined as <span class="math display">\[\rho_{jt} = \text{Corr}\left(X_{t}, X_{t-j}\right) = \frac{\gamma_{jt}}{\sqrt{\gamma_{0t}}\sqrt{\gamma_{0(t-j)}}}.\]</span> The <span style="color:red"><strong><em>autocorrelation matrix</em></strong></span> <span class="math inline">\(\mathbf R\)</span> is <span class="math display">\[\mathbf R = \begin{bmatrix}
\rho_{0t} &amp; \rho_{1t} &amp; \rho_{2t} &amp; \cdots &amp; \rho_{jt}\\
\rho_{1t} &amp; \rho_{0(t-1)} &amp; \rho_{1(t-1)} &amp; \cdots &amp; \rho_{(j-1)(t-1)}\\
\rho_{2t} &amp; \rho_{1(t-1)} &amp; \rho_{0(t-2)} &amp; \cdots &amp; \rho_{(j-2)(t-2)}\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\rho_{jt} &amp; \rho_{(j-1)(t-1)} &amp; \rho_{(j-2)(t-2)} &amp; \cdots &amp; \rho_{0(t-j)}
\end{bmatrix}.\]</span></p>
</div>
<p>As the name implies, autocovariance captures how a stochastic function varies with <em>itself</em> (or rather the random variables that arise from fixing a finite collection of elements in <span class="math inline">\(T\)</span>).</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.10 (Gaussian White Noise)</strong></span> If the process <span class="math inline">\(\varepsilon\)</span> is defined at <span class="math inline">\(\varepsilon_t\sim N(0,\sigma^2)\)</span> for <span class="math inline">\(T=\mathbb{R}\)</span>, then <span class="math inline">\(\boldsymbol \Gamma = \sigma^2\mathbf I\)</span> and <span class="math inline">\(\mathbf R = \mathbf I\)</span>.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.11 (Random Walk)</strong></span> Let <span class="math inline">\(X\)</span> be a random walk defined by <span class="math inline">\(X_t = \sum_{i=1}^t Y_i\)</span> for <span class="math inline">\(Y_i \overset{iid}{\sim}F_Y\)</span> where <span class="math inline">\(\mu = \text{E}\left[Y\right]\)</span> and <span class="math inline">\(\sigma^2 = \text{Var}\left(Y\right)\)</span>. When <span class="math inline">\(\mu \neq 0\)</span> we have a random walk <em>with drift</em>, and <span class="math inline">\(X_t\)</span> can be rewritten as <span class="math display">\[X_t =  X_{t-1} + \mu + Y_t^*\]</span> where <span class="math inline">\(Y_t^* = Y_t - \mu\)</span> is shifted such that <span class="math inline">\(\text{E}\left[Y_t^*\right] = 0\)</span>. The expected value and variance of <span class="math inline">\(X_t\)</span> are <span class="math display">\[\begin{align*}
\text{E}\left[X_t\right] &amp;= \text{E}\left[\textstyle \sum_{i=1}^t Y_i\right]= \sum_{i=1}^t \text{E}\left[Y_i\right] = \sum_{i=1}^t \mu = t\mu,\\
\text{Var}\left(X_t\right) &amp;= \text{Var}\left(\textstyle \sum_{i=1}^t Y_i\right)= \sum_{i=1}^t \text{Var}\left(Y_i\right) = \sum_{i=1}^t \sigma^2 = t\sigma^2,
\end{align*}\]</span> since <span class="math inline">\(Y_i\)</span> are IID. We can use these two facts to calculate the autocovariance of <span class="math inline">\(X\)</span>.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
<p><span class="math display">\[\begin{align*}
\text{Cov}\left(X_t, X_{t-j}\right) &amp; = \text{E}\left[X_tX_{t-j}\right] - \text{E}\left[X_t\right]\text{E}\left[X_{t-j}\right]\\
  &amp; = \text{E}\left[\left(\textstyle\sum_{i=1}^t Y_i \right)X_{t-j}\right] - (t\mu)[(t-j)\mu]\\
  &amp; = \text{E}\left[\left(\textstyle\sum_{i=1}^{t-j} Y_i + \textstyle\sum_{i=t-j+1}^{t} Y_i \right)X_{t-j}\right] - (t\mu)[(t-j)\mu]2\\
  &amp; = \text{E}\left[\left(X_{t-j} + \textstyle\sum_{i=t-j+1}^{t} Y_i \right)X_{t-j}\right] - (t\mu)[(t-j)\mu]\\
  &amp; = \text{E}\left[X_{t-j}^2 + X_{t-j}\textstyle\sum_{i=t-j+1}^{t} Y_i\right] - (t\mu)[(t-j)\mu]\\
  &amp; = \text{E}\left[X_{t-j}^2\right] + \text{E}\left[X_{t-j}\textstyle\sum_{i=t-j+1}^{t} Y_i\right]- (t\mu)[(t-j)\mu]\\
  &amp; = \left(\text{Var}\left(X_{t-j}\right) + \text{E}\left[X_{t-j}\right]^2\right) + \text{E}\left[X_{t-j}\right]\textstyle\sum_{i=t-j+1}^{t} \text{E}\left[Y_i\right]- (t\mu)[(t-j)\mu]\\
  &amp; = [(t-j)\sigma^2 + (t\mu)^2] + t\mu\textstyle\sum_{i=t-j+1}^{t} \text{E}\left[Y_i\right] - (t\mu)[(t-j)\mu]\\
  &amp; = (t-j)\sigma^2 + t^2\mu^2 + t\mu\textstyle\sum_{i=t-j+1}^{t} \mu - t^2\mu^2 -tj\mu^2\\
  &amp; = (t-j)\sigma^2 + t^2\mu^2 - t^2\mu^2 + t\mu(j\mu)  -tj\mu^2\\
  &amp; = (t-j)\sigma^2 + \underbrace{t^2\mu^2 - t^2\mu^2}_0 + \underbrace{tj\mu^2  -tj\mu^2}_0\\
  &amp; = (t-j)\sigma^2
\end{align*}\]</span></p>
<p>Let’s confirm our calculation by simulating 100,000 realizations of a random walk where <span class="math inline">\(Y_i \sim N(1, 1)\)</span> and <span class="math inline">\(T=\{1,\cdots,5\}\)</span>. In this case the true autocovariance matrix is <span class="math display">\[ \boldsymbol\Gamma = \begin{bmatrix} 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\\
1 &amp; 2 &amp; 2 &amp; 2 &amp; 2\\
1 &amp;2 &amp; 3 &amp; 3 &amp;3 \\
1 &amp; 2 &amp;3 &amp;4 &amp; 4\\
1 &amp; 2 &amp; 3&amp;4&amp;5
\end{bmatrix}.\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_n_random_walk</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fl">1e5</span>, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">5</span>, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist =</span> rnorm, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist_params =</span> <span class="fu">list</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="dv">1</span>, </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="dv">1</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s calculate the sample autocovariance matrix using our simulated values.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code which generates table</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>step) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> position, <span class="at">names_from =</span> time) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>iter_num,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"X"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"X"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">X1</th>
<th style="text-align: right;">X2</th>
<th style="text-align: right;">X3</th>
<th style="text-align: right;">X4</th>
<th style="text-align: right;">X5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">X1</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">X2</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">1.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">X3</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">2.98</td>
<td style="text-align: right;">2.99</td>
<td style="text-align: right;">2.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">X4</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">2.99</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">X5</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">2.99</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.99</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.12 (Wiener Process)</strong></span> If <span class="math inline">\(W\)</span> is a Wiener process, we’ve already shown that <span class="math display">\[\text{Cov}\left(W_t, W_s\right) = \min\{s,t\}.\]</span> In the event we have <span class="math inline">\(s\le t\)</span> and write <span class="math inline">\(s=t-j\)</span> for some <span class="math inline">\(j\in \mathbb{R}\)</span>, then <span class="math inline">\(\min\{t, t-j\} = t - j\)</span>, giving <span class="math display">\[ \text{Cov}\left(W_t, W_{t-j}\right) = t-j.\]</span> Note that this is identical to the autocovariance of a random walk with unit variance. This is not at all a coincidence, and we’ll return to this when considering asymptotics in the context of stochastic processes.</p>
</div>
</section>
<section id="stationarity" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="stationarity"><span class="header-section-number">5.4</span> Stationarity</h2>
<p>Many phenomenon in the world can be modeled with stochastic processes, so they arise in statistics quite often (whether explicitly or implicitly). Unfortunately, in many of these settings we face a fundamental “missing data” problem. It’s often <em>impossible</em> to observe more than one realization of a stochastic process. For example, we may think of the price of gas over time as a stochastic process <span class="math inline">\(P\)</span>. We can collect data for gas prices over time, giving <span class="math inline">\(P_1, P_2,\ldots\)</span>, but we’re really observing the same realization of a stochastic process evaluated at different points in time. The only way we could observe another realization of <span class="math inline">\(P\)</span> is if we had access to a multidimensional universe where we could look at the progression of gas prices over time in many different universes! How can we possibly hope do anything useful with data if we have a sample size of 1? The solution comes in the form of assuming a stochastic process exhibits certain convenient properties. The first of these is stationary.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; As the name implies, stationary essentially means that a stochastic process “stays in one place” over the course of time. We can formalize this by appealing to the joint distribution of a process evaluated at multiple points in time.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.5</strong></span> Let <span class="math inline">\(X = \{X_t\}_{t\in  T}\)</span> be a stochastic process over the state space <span class="math inline">\(\mathbb{R}\)</span> where <span class="math inline">\(T\subseteq \mathbb{R}\)</span>. The process <span class="math inline">\(X\)</span> is <span style="color:red"><strong><em>strictly stationary</em></strong></span> if <span class="math display">\[ F_{(X_{t_1},\ldots,X_{t_n})}(x_{t_1},\ldots,x_{t_n}) = F_{(X_{t_1}+ \tau,\ldots,X_{t_n}+ \tau)}(x_{t_1} + \tau,\ldots,x_{t_n}+ \tau)\]</span> for all <span class="math inline">\(t_{1},\ldots, t_n\in T\)</span> and <span class="math inline">\(\tau \in \mathbb{R}\)</span>.</p>
</div>
<p>Strict stationarity says that the distribution of <span class="math inline">\(X\)</span> evaluated at a finite collection of times only depends on the relative position of the times. If we were to translate <span class="math inline">\(t_1,\ldots,t_n\)</span> by some <span class="math inline">\(\tau\)</span>, we would end up with the same distribution!</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.13 (Process of IID Variables)</strong></span> Suppose we have some process <span class="math inline">\(X(t)\)</span> defined as <span class="math inline">\(X_t\overset{iid}{\sim}F_X\)</span>. Since the process is defined via an IID sequence of random variables it is strictly stationary.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.14 (Gaussian White Noise)</strong></span> The process <span class="math inline">\(\varepsilon\)</span> defined by <span class="math inline">\(\varepsilon_t\sim N(0,\sigma^2)\)</span> is strictly stationary by virtue of it being an IID sequence of random variables.</p>
</div>
<p>Strict stationarity is a very strong condition since it requires a distribution itself to obey a specific property. It can be weakened by appealing only to the moments of a distribution (which still have some bearing on the “shape” and “evolution” of a process).</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.6</strong></span> Let <span class="math inline">\(X = \{X_t\}_{t\in  T}\)</span> be a stochastic process over the state space <span class="math inline">\(\mathbb{R}\)</span> where <span class="math inline">\(T\subseteq \mathbb{R}\)</span>. The process <span class="math inline">\(X\)</span> is <span style="color:red"><strong><em>covariance/weakly stationary</em></strong></span> if <span class="math display">\[\begin{align*}
\text{E}\left[X_t\right] &amp;= \mu &amp; \forall t \in T,\\
\text{Cov}\left(X_t, X_{t-j}\right) &amp; = \gamma_j &amp;\forall t,t-j\in T.
\end{align*}\]</span> In other words, neither the expected value nor the autocovariance depend on the time <span class="math inline">\(t\)</span>, and the latter is only a function of <span class="math inline">\(j\)</span>.</p>
</div>
<p>The key property of a covariance stationary process involves the autocovariance. The particular time <span class="math inline">\(t\)</span> is completely moot. The only thing that has any bearing on the autocovariance is the relative distance <span class="math inline">\(j\)</span> between two time intervals. This also simplifies the notation around autocovariance a great deal as we can eliminate any reference to <span class="math inline">\(t\)</span>. <span class="math display">\[\begin{align*}
\boldsymbol \Gamma &amp;= \begin{bmatrix}
\gamma_{0} &amp; \gamma_{1} &amp; \gamma_{2} &amp; \cdots &amp; \gamma_{j}\\
\gamma_{1} &amp; \gamma_{0} &amp; \gamma_{1} &amp; \cdots &amp; \gamma_{j-1}\\
\gamma_{2} &amp; \gamma_{1} &amp; \gamma_{0} &amp; \cdots &amp; \gamma_{j-2}\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\gamma_{j} &amp; \gamma_{j-1} &amp; \gamma_{j-2} &amp; \cdots &amp; \gamma_{0}
\end{bmatrix}
\end{align*}\]</span> Another useful equality that arises from covariance stationarity is <span class="math inline">\(\gamma_{-j}=\gamma_j\)</span> since <span class="math display">\[\begin{align*}
\gamma_j = \text{Cov}\left(X_t, X_{t-j}\right) = \text{Cov}\left(X_{t-j}, X_t\right) = \text{Cov}\left(X_{t-j + j}, X_{t+j}\right) = \text{Cov}\left(X_{t}, X_{t-(-j)}\right) = \gamma_{-j}.
\end{align*}\]</span> The definition of autocorrelation also simplifies to <span class="math display">\[ \rho_j = \frac{\gamma_j}{\sqrt{\gamma_0}\sqrt{\gamma_0}} = \frac{\gamma_j}{\gamma_0}.\]</span> Furhtermore, the autocorrelation matrix simplifies to <span class="math inline">\(\mathbf R = \gamma_0\boldsymbol\Gamma\)</span>.</p>
<div id="prp-" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 5.1 (Strictly Stationarity Implies Weak Stationarity)</strong></span> Let <span class="math inline">\(X = \{X_t\}_{t\in  T}\)</span> be a stochastic process over the state space <span class="math inline">\(\mathbb{R}\)</span> where <span class="math inline">\(T\subseteq \mathbb{R}\)</span>. If <span class="math inline">\(X\)</span> is strictly stationary, then it is weakly stationary</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>For any <span class="math inline">\(t,t-j\in T\)</span> we have <span class="math inline">\(F_{X_t}(x_t) = F_{X_{t-j}}(x_{t-j})\)</span>, giving <span class="math inline">\(\text{E}\left[X_t\right] = \text{E}\left[X_{t-j}\right]\)</span>. Since <span class="math inline">\(T\subseteq \mathbb{R}\)</span>, we can write any <span class="math inline">\(s\in T\)</span> as <span class="math inline">\(s=t-j\)</span> for some <span class="math inline">\(j\in \mathbb{R}\)</span>. This gives <span class="math inline">\(\text{E}\left[X_t\right] = \text{E}\left[X_s\right]\)</span> for all <span class="math inline">\(s,t\in T\)</span>, so <span class="math inline">\(\text{E}\left[X_t\right]\)</span> has a common value <span class="math inline">\(\mu\)</span> for all <span class="math inline">\(t\in T\)</span>. By strict stationarity we have <span class="math display">\[F_{(X_{t+\tau}, X_{t-j+\tau})}=F_{(X_{t}, X_{t-j})} \]</span> for all <span class="math inline">\(\tau\in \mathbb{R}\)</span>, so <span class="math inline">\(\text{Cov}\left(X_{t}, X_{t-j}\right) = \text{Cov}\left(X_{t+\tau}, X_{(t+\tau) - j}\right)\)</span> for all <span class="math inline">\(\tau \in \mathbb{R}\)</span>. Again, since we can write any element of <span class="math inline">\(T\)</span> in the form <span class="math inline">\(t-j\)</span>, we have the desired result.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.15 (Random Walk is Not Covariance Stationary)</strong></span> We showed that a random walk with drift has an autocovariance function of <span class="math inline">\(\gamma_{tj} = (t-j)\sigma^2\)</span>. This is a function of <span class="math inline">\(t\)</span>, so the process is not covariance stationary.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.16 (Wiener Process is Not Covariance Stationary)</strong></span> Similar to the random walk, the Wiener process is not covariance stationary because <span class="math inline">\(\gamma_{tj} = (t-j)\sigma^2\)</span>. What <em>are</em> stationary are the increments <span class="math inline">\(W_{t}-W_{t-j}\)</span> since <span class="math inline">\(W_{t}-W_{t-j}\overset{iid}{\sim}N(0,j)\)</span>. These increments happen to be strictly stationary and Gaussian.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.17 (AR1 Process)</strong></span> Let’s look at a classic stationary process that will play a very important role when we start talking about time series. We’ll start with some Gaussian white noise <span class="math inline">\(\varepsilon_t \sim N(0,\sigma^2)\)</span> and two constants <span class="math inline">\(c\)</span> and <span class="math inline">\(\phi\)</span>. We can use these to define the process <span class="math inline">\(X_t\)</span> recursively: <span class="math display">\[ X_t = c + \phi X_{t-1} + \varepsilon_t.\]</span> We refer to this process as an autoregressive process of order one (AR1), since the definition of <span class="math inline">\(X_t\)</span> resembles a regression equation with <span class="math inline">\(X_t\)</span> as the dependent variable and the lagged <span class="math inline">\(X_{t-1}\)</span> as the independent variable. Intuitively, the process <span class="math inline">\(X\)</span> has some “memory”, as the value at <span class="math inline">\(t\)</span> is the previous value scaled with some white noise added. The definition of <span class="math inline">\(X_t\)</span> is also a difference equation that we can solve given the initial value of the process <span class="math inline">\(X_0\)</span>.</p>
<p><span class="math display">\[\begin{align*}
X_t &amp;= c + \phi X_{t-1} + \varepsilon_t\\
  &amp;= c + \phi (c + \phi X_{t-2} + \varepsilon_{t-1}) + \varepsilon_{t} &amp; (X_{t-1} &amp;= c + \phi X_{t-2} + \varepsilon_{t-1})\\
  &amp; = (c+\varepsilon_t) + \phi(c + \varepsilon_{t-1}) + \phi^2 X_{t-2}\\
  &amp; =(c+\varepsilon_t) + \phi(c + \varepsilon_{t-1}) + \phi^2(c + \phi X_{t-3} + \varepsilon_{t-2}) &amp; (X_{t-2} &amp;= c + \phi X_{t-3} + \varepsilon_{t-2})\\
  &amp; = (c+\varepsilon_t) + \phi(c + \varepsilon_{t-1}) + \phi^2(c + \varepsilon_{t-2}) + \phi^3 X_{t-3} \\
  &amp; = \ldots \\
  &amp; = (c+\varepsilon_t) + \phi(c + \varepsilon_{t-1}) + \phi^2(c + \varepsilon_{t-2}) + \phi^3(c + \varepsilon_{t-3}) + \ldots + \phi^{t-1}(c + \phi +X_0 + \varepsilon_1 ) \\
  &amp; = \phi^tX_0 + c\sum_{j=0}^{t-1}\phi^j + \sum_{j=0}^{t-1}\phi^j\varepsilon_{t-j}
\end{align*}\]</span> Let’s simulate some realizations of <span class="math inline">\(X\)</span> for <span class="math inline">\(\phi = 0.5\)</span>, <span class="math inline">\(c = 0\)</span>, <span class="math inline">\(\sigma = 1\)</span>, and <span class="math inline">\(X_0 = 0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ar1 <span class="ot">&lt;-</span> <span class="cf">function</span>(t, phi, c, sigma, initial_condition, s){</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(t, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="dv">0</span><span class="sc">:</span>t,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">accumulate</span>(<span class="dv">1</span><span class="sc">:</span>t, <span class="sc">~</span> c <span class="sc">+</span> phi <span class="sc">*</span> .x <span class="sc">+</span> u[.y], <span class="at">.init =</span> initial_condition),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma =</span> sigma,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi =</span> phi,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">c =</span> c</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>draw_N_ar1 <span class="ot">&lt;-</span> <span class="cf">function</span>(N, t, phi, c, sigma, initial_condition){</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(ar1, <span class="at">t =</span> t, <span class="at">phi =</span> phi, <span class="at">c =</span> c, <span class="at">sigma =</span> sigma, <span class="at">initial_condition =</span> initial_condition) <span class="sc">%&gt;%</span> </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_N_ar1</span>(</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="dv">100</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> <span class="fl">0.5</span>,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> <span class="dv">100</span>, </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="dv">0</span>, </span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="dv">1</span>, </span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_condition =</span> <span class="dv">0</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot513" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot513-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot513-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot513-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.16: 100 realizations of an AR1 process.
</figcaption>
</figure>
</div>
</div>
</div>
<p>If we assume that <span class="math inline">\(T\)</span> is infinite, then we have <span class="math display">\[ X_t = \phi^tX_0 + c\sum_{j=0}^{\infty}\phi^j + \sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}.\]</span> At this point the behavior of <span class="math inline">\(\phi\)</span> becomes <em>very</em> important. If <span class="math inline">\(|\phi|&lt;1\)</span> then the middle term (which is a geometric series) will converge to <span class="math inline">\(c[1/(1-\phi)]\)</span> and <span class="math inline">\(\phi^tX_0 \to 0\)</span> giving <span class="math display">\[X_t = \frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}.\]</span> In the event <span class="math inline">\(|\phi|&lt;1\)</span> we will have the following moments:<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></p>
<p><span class="math display">\[\begin{align*}
\text{E}\left[X_t\right] &amp;= \text{E}\left[\frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}\right] \\
&amp; = \frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j\text{E}\left[\varepsilon_{t-j}\right] \\
&amp; = \frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j 0 \\
&amp; = \frac{c}{1-\phi} \\
\text{Var}\left(X_t\right) &amp; = \text{Var}\left( \frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}\right)\\
&amp; = \text{Var}\left(\sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}\right)\\
&amp; = \sum_{j=0}^{\infty}\text{Var}\left(\phi^j\varepsilon_{t-j}\right)\\
&amp; = \sum_{j=0}^{\infty}\phi^{2j}\text{Var}\left(\varepsilon_{t-j}\right)\\
&amp; = \sum_{j=0}^{\infty}(\phi^{2})^j\sigma^2\\
&amp; = \frac{\sigma^2}{1-\phi^2}\\
\text{Cov}\left(X_t, X_{t-j}\right) &amp;=  \text{Cov}\left((c + \phi c + \cdots + \phi^jc) + (\varepsilon_t + \phi\varepsilon_{t-1} + \cdots + \phi^j\varepsilon_{t-j}) + \phi^j X_{t-j}  ,X_{t-j}\right) \\
&amp;=  \text{Cov}\left((\varepsilon_t + \phi\varepsilon_{t-1} + \cdots + \phi^j\varepsilon_{t-j}) + \phi^j X_{t-j}  ,X_{t-j}\right) &amp; (\textstyle\sum_{k=0}^j \phi^kc\text{ constant})\\
&amp; = \text{Cov}\left(\phi^j X_{t-j}, X_{t-j}\right) + \text{Cov}\left( \varepsilon_t + \phi\varepsilon_{t-1} + \cdots + \phi^j\varepsilon_{t-j},  X_{t-j}\right)\\
&amp; = \text{Cov}\left(\phi^j X_{t-j}, X_{t-j}\right) &amp; (\textstyle\sum_{k=0}^j \phi^k\varepsilon_{t-k}\perp X_{t-j})\\
&amp; = \phi^j \text{Cov}\left(X_{t-j}, X_{t-j}\right) \\
&amp; = \phi^j \text{Var}\left(X_{t-j}\right)\\
&amp; = \frac{\phi^j\sigma^2}{1-\phi^2}
\end{align*}\]</span></p>
<p>Since <span class="math inline">\(\text{Cov}\left(X_t, X_{t-j}\right)\)</span> only depends on <span class="math inline">\(j\)</span> (oppossed to <span class="math inline">\(t\)</span> and <span class="math inline">\(j\)</span>), and <span class="math inline">\(\text{E}\left[X_t\right]\)</span> is constant over <span class="math inline">\(t\)</span>, <span class="math inline">\(X\)</span> is covariance stationary. <span class="math display">\[\begin{align*}
\mu &amp;= \frac{c}{1-\phi}\\
\gamma_j &amp; = \frac{\phi^j\sigma^2}{1-\phi^2}
\end{align*}\]</span> The autocorrelation of <span class="math inline">\(X\)</span> is <span class="math display">\[ \rho_j = \frac{\frac{\phi^j\sigma^2}{1-\phi^2}}{\frac{\sigma^2}{1-\phi^2}} = \phi^j.\]</span></p>
<p>The autocorrelation will decay geometrically as <span class="math inline">\(j\)</span> increases. This is evident by looking at the <span class="math inline">\(\rho_j\)</span> for various values of <span class="math inline">\(\phi\)</span>. These types of figures are known as correlograms.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expand_grid</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.75</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.25</span>, <span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">j =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rho =</span> phi<span class="sc">^</span>j,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi_neg =</span> <span class="fu">ifelse</span>(phi <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">"φ &lt; 0"</span>, <span class="st">"φ &gt;= 0"</span>),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(j, rho, <span class="at">color =</span> <span class="fu">as.factor</span>(phi))) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>phi_neg, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Relative Time, j"</span>, <span class="at">y =</span> <span class="st">"Autocorrelation, ρ"</span>, <span class="at">color =</span> <span class="st">"φ"</span>) <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot514" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot514-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot514-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot514-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.17: .
</figcaption>
</figure>
</div>
</div>
</div>
<p>The stationarity of <span class="math inline">\(X\)</span> hinges on the crucial assumption that <span class="math inline">\(\left\lvert\phi\right\rvert &lt;1\)</span>, otherwise the geometric series <span class="math inline">\(\sum_{j=0}^{\infty}\phi^j\)</span> diverges and we have an “explosive” AR1 process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_N_ar1</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="dv">100</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> <span class="fl">1.1</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> <span class="fl">1e2</span>, </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="dv">0</span>, </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="dv">1</span>, </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_condition =</span> <span class="dv">0</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show code which generates figure</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot515" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot515-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="stochastic_files/figure-html/fig-plot515-1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot515-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.18: 100 realizations of an explosive AR1 process with φ = 1.1.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Two special cases of the AR1 process worth mentioning arise when <span class="math inline">\(\phi \in\{-1, 0, 1\}\)</span>. If <span class="math inline">\(\phi = 0\)</span> then <span class="math display">\[ X_t = c + 0\cdot X_{t-1} + \varepsilon_t = c + \varepsilon_t\]</span> which leaves us with Gaussian white noise shifted by some constant <span class="math inline">\(c\)</span>. If <span class="math inline">\(\phi = 1\)</span>, then the process actually becomes a random walk with drift. <span class="math display">\[X_t = \phi^tX_0 + c\sum_{j=0}^{t-1}\phi^j + \sum_{j=0}^{t-1}\phi^j\varepsilon_{t-j}
= X_0 + c\cdot\frac{t(t+1)}{2} + \sum_{j=0}^{t-1}\varepsilon_{t-j}\]</span></p>
<p>Since <span class="math inline">\(\varepsilon_t\overset{iid}{\sim}N(0, \sigma^2)\)</span>, we have a random walk with Gaussian steps. A similar result arises where <span class="math inline">\(\phi = -1\)</span>, but the signs differ slightly. The key takeaway from these two special cases is that they are consistent with the fact that <span class="math inline">\(X\)</span> is covariance stationary when <span class="math inline">\(\left\lvert\phi\right\rvert&lt;1\)</span>, since Gaussian white noise is covariance stationary, and random walks are not.</p>
</div>
</section>
<section id="ergodicity" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="ergodicity"><span class="header-section-number">5.5</span> Ergodicity</h2>
<p>A second property that makes stochastic processes much easier to work with in statistical applications is ergodicity. Fully defining ergodicity, let alone understanding it fully, requires diving into the bowels of measure theory. Loosely speaking, ergodicity means that a stochastic process never gets “stuck” in one place and</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ar1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, phi, t){</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">accumulate</span>(<span class="dv">2</span><span class="sc">:</span>n, <span class="sc">~</span> phi <span class="sc">*</span> .x <span class="sc">+</span> u[.y], <span class="at">.init =</span> u[<span class="dv">1</span>]),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> t</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>draw_N_ar1 <span class="ot">&lt;-</span> <span class="cf">function</span>(N, n, phi){</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(ar1, <span class="at">n =</span> n, <span class="at">phi =</span> phi) <span class="sc">%&gt;%</span> </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_N_ar1</span>(<span class="at">N =</span> <span class="fl">5e3</span>, <span class="at">n =</span> <span class="fl">5e3</span>, <span class="at">phi =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fixed_i <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(iter_num <span class="sc">==</span><span class="dv">3</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">"t_to_infty"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">index =</span> time</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>fixed_t <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">==</span> <span class="fl">2.5e3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">"n_to_infty"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">index =</span> iter_num</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> fixed_i <span class="sc">%&gt;%</span> </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> fixed_t, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> fixed_i <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"#4280FC"</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Realizations of X_i(t) for Fixed t = 500"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> fixed_t <span class="sc">%&gt;%</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"#FC4242"</span>) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Realizations of X_i(t) for Fixed i = 1"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  plot1,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggarrange</span>(plot2, plot3, <span class="at">ncol =</span> <span class="dv">2</span>), </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stochastic_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fixed_i <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(fixed_t) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(g) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(index) <span class="sc">%&gt;%</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">cummean</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(index, value, <span class="at">color =</span> g)) <span class="sc">+</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span> </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stochastic_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-billingsley2008probability" class="csl-entry" role="listitem">
Billingsley, Patrick. 2008. <em>Probability and Measure</em>. John Wiley &amp; Sons.
</div>
<div id="ref-glasserman2004monte" class="csl-entry" role="listitem">
Glasserman, Paul. 2004. <em>Monte Carlo Methods in Financial Engineering</em>. Vol. 53. Springer.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>We’re brushing over how products of sets play with sigma-algebras here, but the underlying math isn’t trivial.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This notation is not standard, but eliminates a great deal of ambiguity when working with random matrices and vectors.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>We usually suppress the argument of a random variable, but in this case it’s helpful to illustrate the additional time dimension.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>In general, the process of translating a function of two arguments to a function that takes on values in a space of functions is called “currying”. For example, define <span class="math inline">\(f:\mathbb{R}^2\to \mathbb{R}\)</span> as <span class="math inline">\(f(x,y)=x+y\)</span>. We can write this as <span class="math inline">\((g(x))(y)\)</span> where <span class="math inline">\(g:\mathbb{R}\to \mathbb{R}^{\mathbb{R}}\)</span>. If we fix an input like <span class="math inline">\(x=2\)</span>, we have <span class="math inline">\((g(2))(y)=2+y\)</span>, which is an element of <span class="math inline">\(\mathbb{R}^{\mathbb{R}}\)</span> since <span class="math inline">\(g(2):\mathbb{R}\to \mathbb{R}\)</span>. This works for general sets since the set of functions from <span class="math inline">\(X\times Y\)</span> to <span class="math inline">\(Z\)</span>, written as <span class="math inline">\(Z^{X\times Y}\)</span>, is isomorphic to the set <span class="math inline">\((Z^Y)^X\)</span>. <span class="math display">\[Z^{X\times Y}\cong (Z^Y)^X\]</span><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The distribution corresponding to this random variable is known as the Rademacher distribution.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Rather, the first 20 terms of the random sequence.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>An interesting feature of this figure is that it emphasizes the combinatorial nature of a random walk. At time <span class="math inline">\(t=20\)</span> we’ve flipped the coin 20 times, with each flip having 2 outcomes. This means there are <span class="math inline">\(2^{20}\)</span> possible paths the random walk can take.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The term “Brownian motion” is often used in place of “Wiener process”.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>See Section 37 of <span class="citation" data-cites="billingsley2008probability">Billingsley (<a href="#ref-billingsley2008probability" role="doc-biblioref">2008</a>)</span> for a proof.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>If we wanted to graph <span class="math inline">\(f(x) = \sqrt x\)</span> on <span class="math inline">\([0,1]\)</span>, we would need to evaluate <span class="math inline">\(f(x)\)</span> at many points in <span class="math inline">\([0,1]\)</span> and then plot the results. <em>Technically</em> we’re approximating the graph of <span class="math inline">\(f(x)\)</span> via linear interpolation between the points at which we evaluated <span class="math inline">\(f\)</span> using <code>geom_line()</code>. It just happens that it’s easy to pick such a sufficiently large number of points to evaluate <span class="math inline">\(f\)</span> at that we get the desired graph of <span class="math inline">\(f\)</span>.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Of course as we look at smaller and smaller intervals, the number of discrete points used to visualize the process will shrink, so the path may not appear quite as “jagged”.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>Reference to john cook article<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>We’ll calculate the autocovariance in a more “direct” fashion, but there are a few tricks that can employed such that things fall into place much quicker.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>When calculating these moments we’ll appeal a key equalities: <span class="math display">\[\begin{align*}
\text{E}\left[\textstyle\sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}\right] &amp;= \sum_{j=0}^{\infty} \text{E}\left[\phi^j\varepsilon_{t-j}\right]\\
  \text{Var}\left(\textstyle\sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}\right) &amp;= \sum_{j=0}^{\infty} \text{Var}\left(\phi^j\varepsilon_{t-j}\right)\\
\end{align*}\]</span> For fans of real analysis, these equalities should raise eyebrows, as we’re really interchanging the order of an infinite series and an integral. The monotone convergence theorem and dominated convergence theorem outline conditions under which this is permissible.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./exp_fam.html" class="pagination-link" aria-label="Exponential Families">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Exponential Families</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./adv_asymptotics.html" class="pagination-link" aria-label="Advanced Asymptotics">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Asymptotics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb42" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>\DeclareMathOperator{\plim}{plim}</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>\DeclareMathOperator{\argmin}{argmin}</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>\DeclareMathOperator{\argmax}{argmax}</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>\newcommand{\var}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{Var}\left(#1\right)}</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>\newcommand{\avar}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{Avar}\left(#1\right)}</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>\newcommand{\E}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{E}\left<span class="co">[</span><span class="ot">#1\right</span><span class="co">]</span>}</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>\newcommand{\cov}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{Cov}\left(#1\right)}</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>\newcommand{\corr}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{Corr}\left(#1\right)}</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>\newcommand{\mse}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{MSE}\left(#1\right)}</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>\newcommand{\se}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\text{se}\left(#1\right)}</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>\newcommand{\limfunc}{lim} </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>\newcommand{\X}{\mathbf{X}}</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>\newcommand{\Xm}{\mathbb{X}}</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>\newcommand{\EER}{\bar{\thet}_\text{EE}}</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>\newcommand{\NLS}{\hat{\bet}_\text{NLLS}}</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>\newcommand{\z}{\mathbf{z}}</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>\newcommand{\rr}{\mathbf{r}}</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>\newcommand{\C}{\mathbf{C}}</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>\newcommand{\Pe}{\mathbf{P}}</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>\newcommand{\y}{\mathbf{y}}</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>\newcommand{\Y}{\mathbf{Y}}</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>\newcommand{\uu}{\mathbf{u}}</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>\newcommand{\e}{\mathbf{e}}</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>\newcommand{\D}{\mathbf{D}}</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>\newcommand{\x}{\mathbf{x}}</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>\newcommand{\xm}{\mathbb{x}}</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>\newcommand{\Zm}{\mathbb{Z}}</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>\newcommand{\Wm}{\mathbb{W}}</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>\newcommand{\Hm}{\mathbb{H}}</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>\newcommand{\W}{\mathbf{W}}</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>\newcommand{\Z}{\mathbf{Z}}</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>\newcommand{\Hess}{\mathbf{H}(\mathbf{\Z\mid\thet})}</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>\newcommand{\Score}{\mathbf{S}(\mathbf{\Z\mid\thet})}</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>\newcommand{\A}{\mathbf{A}}</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>\newcommand{\h}{\mathbf{h}}</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>\newcommand{\Q}{\mathbf{Q}}</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>\newcommand{\F}{\mathbf{F}}</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>\newcommand{\G}{\mathbf{G}}</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>\newcommand{\I}{\mathbf{I}}</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>\renewcommand{\D}{\mathbf{D}}</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>\renewcommand{\C}{\mathbf{C}}</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>\newcommand{\zer}{\mathbf{0}}</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>\newcommand{\OLS}{\hat{\boldsymbol\beta}_\text{OLS} }</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>\newcommand{\OLSOV}{\hat{\boldsymbol\beta}_\text{OLS,OV} }</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>\newcommand{\OLSME}{\hat{\boldsymbol\beta}_\text{OLS,ME} }</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>\newcommand{\EE}{\hat{\boldsymbol\theta}_\text{EX} }</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>\newcommand{\ME}{\hat{\boldsymbol\theta}_\text{M} }</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>\newcommand{\MDE}{\hat{\boldsymbol\theta}_\text{MDE} }</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>\newcommand{\IV}{\hat{\boldsymbol\beta}_\text{IV} }</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>\newcommand{\TSLS}{\hat{\boldsymbol\beta}_\text{2SLS} }</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>\newcommand{\thet}{\boldsymbol{\theta}}</span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>\newcommand{\et}{\boldsymbol{\eta}}</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>\newcommand{\R}{\mathbb{R}}</span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>\newcommand{\Sig}{\boldsymbol{\Sigma}}</span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>\newcommand{\ep}{\boldsymbol{\varepsilon}}</span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>\newcommand{\Omeg}{\boldsymbol{\Omega}}</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>\newcommand{\Thet}{\boldsymbol{\Theta}}</span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>\newcommand{\bet}{\boldsymbol{\beta}}</span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>\newcommand{\rk}{rank}</span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>\newcommand{\tsum}{\sum}</span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>\newcommand{\tr}{tr}</span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>\newcommand{\norm}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\left\lVert#1\right\rVert}</span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>\newcommand{\abs}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\left\lvert#1\right\rvert}</span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>\newcommand{\ms}{\overset{ms}{\to}}</span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>\newcommand{\pto}{\overset{p}{\to}}</span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>\newcommand{\asto}{\overset{as}{\to}}</span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>\newcommand{\iid}{\overset{iid}{\sim}}</span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>\newcommand{\dto}{\overset{d}{\to}}</span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>\newcommand{\asim}{\overset{a}{\sim}}</span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stochastic Processes</span></span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb42-86"><a href="#cb42-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb42-87"><a href="#cb42-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reviewing More Probability Theory</span></span>
<span id="cb42-92"><a href="#cb42-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-93"><a href="#cb42-93" aria-hidden="true" tabindex="-1"></a>Given a probability space $(\mathcal X, \mathcal F, P)$ and a set $E$ equipped with a sigma-algebra $\mathcal E$, a random variable is some function $X:\mathcal X\to E$ such that $X^{-1}(I) \in \mathcal F$ for all $I\in \mathcal E$. Until now, we've only dealt with the case $E = \R$ and $\mathcal E = \mathcal B(\R)$, so let's look at random variables on other spaces. In particular, we're interested in random variables defined on metric spaces. </span>
<span id="cb42-94"><a href="#cb42-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-95"><a href="#cb42-95" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-96"><a href="#cb42-96" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random Vectors</span></span>
<span id="cb42-97"><a href="#cb42-97" aria-hidden="true" tabindex="-1"></a>We've been interpreting a random vector $\X = (X_1,\ldots,X_n)$ as a collection of $n$ random scalars $X_1:\mathcal X_1\to E_1,\ldots,X_n:\mathcal X_n\to E_n$. Alternatively, we could consider $\X$ to be a random variable mapping $\mathcal X_1\times\cdots\times \mathcal X_n$ to $E^n$.^<span class="co">[</span><span class="ot">We're brushing over how products of sets play with sigma-algebras here, but the underlying math isn't trivial.</span><span class="co">]</span> A special case of this is when we draw a sample of $n$ observations of $X_i \iid F_X$. If we execute ```rnorm(10)```, it will return $n$ realizations of $X:\R\to\R$ which can also be interpreted as one realization of a random vector $\X:\R^{10}\to\R^{10}$. Whether you think of the resulting data as 10 realizations of iid random variables or a single random vector will depend on the application. It's usually easier to model problems with random vectors when random scalars aren't iid. If we have $X_1 \sim N(0,1)$, $X_2 \sim N(1,2)$, and $\cov{X_1, X_2} = 1$, then all the information about $X_1$ and $X_2$ can easily be summarized by $\X = (X_1,X_2)$ where $$\X \sim N\left(\begin{bmatrix} 0<span class="sc">\\</span> 1\end{bmatrix}, \begin{bmatrix} 1 &amp; 1<span class="sc">\\</span> 1 &amp; 2\end{bmatrix}\right)$$</span>
<span id="cb42-98"><a href="#cb42-98" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-99"><a href="#cb42-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-100"><a href="#cb42-100" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-101"><a href="#cb42-101" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random Matrices</span></span>
<span id="cb42-102"><a href="#cb42-102" aria-hidden="true" tabindex="-1"></a>We can combine random vectors into a single random matrix just like we combined random scalars into a random vector. For the sake of ease, we'll only consider real valued random vectors here. Suppose we have $k$ random vectors $\X_1,\ldots,\X_k$, each of length $n$. We can form a $n\times k$ matrix using these vectors as column vectors. We'll denote this random matrix with $\Xm$.^<span class="co">[</span><span class="ot">This notation is not standard, but eliminates a great deal of ambiguity when working with random matrices and vectors.</span><span class="co">]</span> </span>
<span id="cb42-103"><a href="#cb42-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-104"><a href="#cb42-104" aria-hidden="true" tabindex="-1"></a>$$\Xm = \begin{bmatrix}\X_1 &amp; \cdots &amp;\X_k \end{bmatrix} =  \begin{bmatrix}X_{11} &amp; \cdots &amp;X_{k1} <span class="sc">\\</span> \vdots &amp; \ddots &amp; \vdots<span class="sc">\\</span> X_{1n} &amp; \cdots &amp;X_{kn} \end{bmatrix}$$ In this case, the random variable $\Xm$ takes on a value in the set of all $n\times k$ real matrices, $\R^{n\times k}$. We could also consider $\Xm$ to be comprised of $n$ random vectors of length $k$. </span>
<span id="cb42-105"><a href="#cb42-105" aria-hidden="true" tabindex="-1"></a>$$ \Xm = \begin{bmatrix}\X_1<span class="sc">\\</span> \vdots <span class="sc">\\</span> \X_k \end{bmatrix}.$$ This interpretation is particularly important when considering regression models where we observe $n$ realizations of $k$ regressors $X_1,\ldots,X_k$.</span>
<span id="cb42-106"><a href="#cb42-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-107"><a href="#cb42-107" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-108"><a href="#cb42-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-109"><a href="#cb42-109" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A random object we've yet to talk about are stochastic processes. These will make for an excellent example in abstracting random variables beyond $\R$.</span></span>
<span id="cb42-110"><a href="#cb42-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-111"><a href="#cb42-111" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb42-112"><a href="#cb42-112" aria-hidden="true" tabindex="-1"></a>Given a probability space $(\mathcal X, \mathcal F, P)$, suppose we have a collection of random variables $<span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in T}$ indexed by some set $T$ which take on values in the measurable space $(S, \mathcal S)$. The collection $\{X_t\}_{t\in T}$ is a [***stochastic process***]{style="color:red"}. We refer to $S$ as the [***state space***]{style="color:red"} and $T$ as the [***index set***]{style="color:red"}. If $T = \mathbb N$ then $\{X_t\}_{t\in T}$ is a <span class="co">[</span><span class="ot">***discrete-time stochastic process***</span><span class="co">]</span>{style="color:red"}. If $T = \R^+$ <span class="co">[</span><span class="ot">***continuous-time stochastic process***</span><span class="co">]</span>{style="color:red"}</span>
<span id="cb42-113"><a href="#cb42-113" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-114"><a href="#cb42-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-115"><a href="#cb42-115" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The index set is almost always denoted by $T$ because the main application of stochastic processes is modeling the evolution of random phenomena over time periods $t\in T$. Each value $t\in T$ is mapped to a random variable $X_t$, which takes on a realized value $X_t(\omega)\in S$ for some outcome $\omega\in\mathcal X$.^[We usually suppress the argument of a random variable, but in this case it's helpful to illustrate the additional time dimension.] Since $X_t$ is indexed by $T$, we can actually think of a stochastic process as a function $t\mapsto X_t$, and opt to write $X(t)$ or $X(t,\omega)$.^[In general, the process of translating a function of two arguments to a function that takes on values in a space of functions is called "currying". For example, define $f:\R^2\to \R$ as $f(x,y)=x+y$. We can write this as $(g(x))(y)$ where $g:\R\to \R^{\R}$. If we fix an input like $x=2$, we have $(g(2))(y)=2+y$, which is an element of $\R^{\R}$ since $g(2):\R\to \R$. This works for general sets since the set of functions from $X\times Y$ to $Z$, written as $Z^{X\times Y}$, is isomorphic to the set $(Z^Y)^X$. $$Z^{X\times Y}\cong (Z^Y)^X$$] This interpretation is how we'll be able to define a stochastic process as a random variable.</span></span>
<span id="cb42-116"><a href="#cb42-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-117"><a href="#cb42-117" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-118"><a href="#cb42-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stochastic Processes as RVs</span></span>
<span id="cb42-119"><a href="#cb42-119" aria-hidden="true" tabindex="-1"></a>Given a state space $S$ and an index set $T$, consider the set $S^T$ of all functions mapping $T$ to $S$. A stochastic process $<span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in T}$ defined on the probability space $(\mathcal X, \mathcal F, P)$ is a random variable $X:\mathcal X\to S^T$. One realization of $X(\omega)\in S^T$ is a function from $T$ to $S$. In the event that $T =\mathbb N$, $S^\mathbb N$ is the set of sequences in $S$, as a sequence in $S$ is just a function which assigns natural numbers to the elements of $S$. This means that $X:\mathcal X\to S^{\mathbb N}$ is a random sequence. We often refer to realizations of stochastic processes as sample paths to emphasize the additional dimension given by $T$.</span>
<span id="cb42-120"><a href="#cb42-120" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-121"><a href="#cb42-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-122"><a href="#cb42-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## Examples of Stochastic Processes</span></span>
<span id="cb42-123"><a href="#cb42-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-124"><a href="#cb42-124" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-125"><a href="#cb42-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-126"><a href="#cb42-126" aria-hidden="true" tabindex="-1"></a><span class="fu">## IID draws</span></span>
<span id="cb42-127"><a href="#cb42-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-128"><a href="#cb42-128" aria-hidden="true" tabindex="-1"></a>Suppose we have observe $n$ values of $X_1,\ldots, X_n$ where $X_i\iid F_X$. This is a discrete time stochastic process where the index set $i=1,\ldots,n$ is the set of units for which we observe $X_i$. Whether it makes sense to interpret the $n$ realizations of $X_i$ as a stochastic process or not very much depends on the context in which we're collecting our data and the phenomena we may be trying to model. </span>
<span id="cb42-129"><a href="#cb42-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-130"><a href="#cb42-130" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-131"><a href="#cb42-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-132"><a href="#cb42-132" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-133"><a href="#cb42-133" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple Random Walk</span></span>
<span id="cb42-134"><a href="#cb42-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-135"><a href="#cb42-135" aria-hidden="true" tabindex="-1"></a>Suppose we have a sequence of iid random variables $Y_1,Y_2,\ldots$ defined on the sample space $<span class="sc">\{</span>-1,1<span class="sc">\}</span>$ such that $\Pr(Y_t = 1) = p$ and $\Pr(Y_t = -1) = 1-p$ for all $t$. We can think of $Y_t$ as a modified Bernoulli random variable where a "failure" corresponds to the value $-1$ instead of $0$.^<span class="co">[</span><span class="ot">The distribution corresponding to this random variable is known as the Rademacher distribution.</span><span class="co">]</span> Using the sequence $Y_t$ we can define a new sequence of random variables $X_t$ as </span>
<span id="cb42-136"><a href="#cb42-136" aria-hidden="true" tabindex="-1"></a>$$ X_t = \sum_{i=1}^t Y_i.$$ The sequence $X_n$ is a random walk. The name is due to a thought experiment corresponding to $Y_n$ and $X_n$. Suppose someone is standing at a reference point (the origin $0$) at time $t=0$. At $t=1$ they flip a coin. If the flip results in a head they will take one step forward, but if the flip results in a tail they will take a step backwards. This is repeated for $t=2,3,\ldots$. The outcome of the coin flip at time $t$ corresponds to the random variable $Y_t$. At any time $t$, the person's position relative to the reference points is given as $X_t$. Instead of considering $X_1,X_2,\ldots$ to be a sequence of separate random variables, we can think of $X=(X_1,X_2,\ldots)$ to be a single random variable defined on the space $\mathbb Z^{\mathbb N}$. Let's look at one realized value of $X$ taking $p = 1/2$,^<span class="co">[</span><span class="ot">Rather, the first 20 terms of the random sequence.</span><span class="co">]</span> in which case our random walk is symmetric.</span>
<span id="cb42-137"><a href="#cb42-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-140"><a href="#cb42-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-141"><a href="#cb42-141" aria-hidden="true" tabindex="-1"></a>random_walk <span class="ot">&lt;-</span> <span class="cf">function</span>(n, dist, dist_params, t){</span>
<span id="cb42-142"><a href="#cb42-142" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb42-143"><a href="#cb42-143" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">step =</span> X) <span class="sc">%&gt;%</span></span>
<span id="cb42-144"><a href="#cb42-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb42-145"><a href="#cb42-145" aria-hidden="true" tabindex="-1"></a>      <span class="at">time =</span> <span class="fu">row_number</span>(),</span>
<span id="cb42-146"><a href="#cb42-146" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">cumsum</span>(step),</span>
<span id="cb42-147"><a href="#cb42-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> t</span>
<span id="cb42-148"><a href="#cb42-148" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb42-149"><a href="#cb42-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(</span>
<span id="cb42-150"><a href="#cb42-150" aria-hidden="true" tabindex="-1"></a>      <span class="at">time =</span> <span class="dv">0</span>,</span>
<span id="cb42-151"><a href="#cb42-151" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="dv">0</span>,</span>
<span id="cb42-152"><a href="#cb42-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> t,</span>
<span id="cb42-153"><a href="#cb42-153" aria-hidden="true" tabindex="-1"></a>      <span class="at">.before =</span> <span class="dv">0</span></span>
<span id="cb42-154"><a href="#cb42-154" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-155"><a href="#cb42-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-156"><a href="#cb42-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-157"><a href="#cb42-157" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-158"><a href="#cb42-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-159"><a href="#cb42-159" aria-hidden="true" tabindex="-1"></a>rredmacher <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p){</span>
<span id="cb42-160"><a href="#cb42-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p, p)))</span>
<span id="cb42-161"><a href="#cb42-161" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-162"><a href="#cb42-162" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">random_walk</span>(<span class="dv">20</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>), <span class="dv">1</span>)</span>
<span id="cb42-163"><a href="#cb42-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-164"><a href="#cb42-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-165"><a href="#cb42-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-168"><a href="#cb42-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-169"><a href="#cb42-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-170"><a href="#cb42-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-171"><a href="#cb42-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot51</span></span>
<span id="cb42-172"><a href="#cb42-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb42-173"><a href="#cb42-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-174"><a href="#cb42-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-175"><a href="#cb42-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "One simulated realization of a random walk"</span></span>
<span id="cb42-176"><a href="#cb42-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-177"><a href="#cb42-177" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-178"><a href="#cb42-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>iter_num) <span class="sc">%&gt;%</span> </span>
<span id="cb42-179"><a href="#cb42-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>time) <span class="sc">%&gt;%</span> </span>
<span id="cb42-180"><a href="#cb42-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"step"</span>, <span class="st">"position"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Step Y_t"</span>, <span class="st">"Position X_t"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb42-181"><a href="#cb42-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb42-182"><a href="#cb42-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb42-183"><a href="#cb42-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb42-184"><a href="#cb42-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-185"><a href="#cb42-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb42-186"><a href="#cb42-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(time, <span class="at">transition_length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb42-187"><a href="#cb42-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>() <span class="sc">+</span></span>
<span id="cb42-188"><a href="#cb42-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time, t"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb42-189"><a href="#cb42-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-190"><a href="#cb42-190" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb42-191"><a href="#cb42-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-192"><a href="#cb42-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-193"><a href="#cb42-193" aria-hidden="true" tabindex="-1"></a>Since this is just one realization, it's analogous to illustrating a random variable with a standard normal distribution with a histogram of a single value generated by <span class="in">`rnorm(n = 1)`</span>. Let's look at 1,000 simulated realizations of our random walk $X=(X_1,X_2,\ldots)$.^<span class="co">[</span><span class="ot">An interesting feature of this figure is that it emphasizes the combinatorial nature of a random walk. At time $t=20$ we've flipped the coin 20 times, with each flip having 2 outcomes. This means there are $2^{20}$ possible paths the random walk can take.</span><span class="co">]</span> </span>
<span id="cb42-194"><a href="#cb42-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-195"><a href="#cb42-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-198"><a href="#cb42-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-199"><a href="#cb42-199" aria-hidden="true" tabindex="-1"></a>draw_n_random_walk <span class="ot">&lt;-</span> <span class="cf">function</span>(N, n, dist, dist_params){</span>
<span id="cb42-200"><a href="#cb42-200" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span>  </span>
<span id="cb42-201"><a href="#cb42-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(random_walk, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb42-202"><a href="#cb42-202" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb42-203"><a href="#cb42-203" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-204"><a href="#cb42-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-205"><a href="#cb42-205" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-206"><a href="#cb42-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-207"><a href="#cb42-207" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_n_random_walk</span>(<span class="fl">1e3</span>, <span class="dv">20</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>))</span>
<span id="cb42-208"><a href="#cb42-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-209"><a href="#cb42-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-212"><a href="#cb42-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-213"><a href="#cb42-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-214"><a href="#cb42-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-215"><a href="#cb42-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot52</span></span>
<span id="cb42-216"><a href="#cb42-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-217"><a href="#cb42-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-218"><a href="#cb42-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-219"><a href="#cb42-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1,000 simulated realizations of the random walk."</span></span>
<span id="cb42-220"><a href="#cb42-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-221"><a href="#cb42-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-222"><a href="#cb42-222" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-223"><a href="#cb42-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb42-224"><a href="#cb42-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">factor</span>(iter_num))) <span class="sc">+</span></span>
<span id="cb42-225"><a href="#cb42-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-226"><a href="#cb42-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb42-227"><a href="#cb42-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb42-228"><a href="#cb42-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Position"</span>) </span>
<span id="cb42-229"><a href="#cb42-229" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-230"><a href="#cb42-230" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb42-231"><a href="#cb42-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-232"><a href="#cb42-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-233"><a href="#cb42-233" aria-hidden="true" tabindex="-1"></a>We can also investigate the individual terms of the random sequence $X = (X_1,X_2,\ldots)$ by treating them like their own random variables defined on $\mathbb Z$. For 100,000 simulated realizations of $X$, let's look at the distribution of the realized values of $X_1$, $X_{10}$, $X_{20}$, and $X_{30}$.</span>
<span id="cb42-234"><a href="#cb42-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-237"><a href="#cb42-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-238"><a href="#cb42-238" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_n_random_walk</span>(<span class="fl">1e5</span>, <span class="dv">30</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-239"><a href="#cb42-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>))</span>
<span id="cb42-240"><a href="#cb42-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-241"><a href="#cb42-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-242"><a href="#cb42-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-245"><a href="#cb42-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-246"><a href="#cb42-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-247"><a href="#cb42-247" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot53</span></span>
<span id="cb42-248"><a href="#cb42-248" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-249"><a href="#cb42-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-250"><a href="#cb42-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-251"><a href="#cb42-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of simulated positions at various times."</span></span>
<span id="cb42-252"><a href="#cb42-252" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-253"><a href="#cb42-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-254"><a href="#cb42-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-255"><a href="#cb42-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-256"><a href="#cb42-256" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb42-257"><a href="#cb42-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, position) <span class="sc">%&gt;%</span> </span>
<span id="cb42-258"><a href="#cb42-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fl">1e5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-259"><a href="#cb42-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"t = 1"</span>, <span class="st">"t =10"</span>, <span class="st">"t = 20"</span>, <span class="st">"t = 30"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb42-260"><a href="#cb42-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(position, freq)) <span class="sc">+</span></span>
<span id="cb42-261"><a href="#cb42-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-262"><a href="#cb42-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">xend =</span> position, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> freq)) <span class="sc">+</span></span>
<span id="cb42-263"><a href="#cb42-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>time) <span class="sc">+</span></span>
<span id="cb42-264"><a href="#cb42-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-265"><a href="#cb42-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"position"</span>, <span class="at">y =</span> <span class="st">"frequency"</span>)</span>
<span id="cb42-266"><a href="#cb42-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-267"><a href="#cb42-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-268"><a href="#cb42-268" aria-hidden="true" tabindex="-1"></a>It is no coincidence that as $t$ increases, the distribution of $X_t$ appears to resemble a normal distribution. To show this we'll need to find the probability mass function of $X_t$ which gives $\Pr(X_t = x)$ for $x\in<span class="sc">\{</span>-t,-t+1,\ldots,t-1,t<span class="sc">\}</span>\subset \mathbb Z$. First note that the probability that $k$ steps forward and $t-k$ steps backwards are taken follows a binomial distribution, since $I(Y_i = 1)\sim \text{Ber}(p)$. </span>
<span id="cb42-269"><a href="#cb42-269" aria-hidden="true" tabindex="-1"></a>$$ \Pr(\textstyle\sum_{i=1}^t I(Y_i = 1)) = \binom{t}{k}p^k(1-p)^{t-k}$$</span>
<span id="cb42-270"><a href="#cb42-270" aria-hidden="true" tabindex="-1"></a>We can write the number of steps forward $k$ in position $x$ by noting that $x = k - (t-k) = 2k-t,$ so $k = (t+x)/2$.</span>
<span id="cb42-271"><a href="#cb42-271" aria-hidden="true" tabindex="-1"></a>$$f_{X_t}(x \mid t, p) = \binom{t}{(t+x)/2}p^{(t+x)/2}(1-p)^{t-(t+x)/2}.$$</span>
<span id="cb42-272"><a href="#cb42-272" aria-hidden="true" tabindex="-1"></a>Since $X_t$ follows a variant of the binomial distribution, as $t\to\infty$ the normal approximation of the binomial distribution holds with increasing accuracy. The parameters of this normal distribution are given by the expected value and variance of $X_t$. These are</span>
<span id="cb42-273"><a href="#cb42-273" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-274"><a href="#cb42-274" aria-hidden="true" tabindex="-1"></a>\E{X_t} &amp;= \E{\sum_{i=1}^t Y_i} <span class="sc">\\</span>&amp;= \sum_{i=1}^t \E{Y_i} &amp; (\E{\cdot}\text{ linear})<span class="sc">\\</span> &amp;= t\left<span class="co">[</span><span class="ot">p\cdot 1 + (1-p)(-1) \right</span><span class="co">]</span> &amp; (Y_i\text{ iid})<span class="sc">\\</span> &amp; = t(2p-1)<span class="sc">\\</span></span>
<span id="cb42-275"><a href="#cb42-275" aria-hidden="true" tabindex="-1"></a>\var{X_t} &amp;= \var{\sum_{i=1}^t Y_i}<span class="sc">\\</span></span>
<span id="cb42-276"><a href="#cb42-276" aria-hidden="true" tabindex="-1"></a>        &amp; = \sum_{i=1}^t \var{Y_i} &amp; (Y_i\text{ iid})<span class="sc">\\</span></span>
<span id="cb42-277"><a href="#cb42-277" aria-hidden="true" tabindex="-1"></a>        &amp; = t\left<span class="co">[</span><span class="ot">\E{Y_i^2} - \E{Y_i}^2\right</span><span class="co">]</span> <span class="sc">\\</span> </span>
<span id="cb42-278"><a href="#cb42-278" aria-hidden="true" tabindex="-1"></a>        &amp; = t<span class="co">[</span><span class="ot">1 - (2p-1)^2</span><span class="co">]</span> &amp; (Y_i^2 = 1)<span class="sc">\\</span></span>
<span id="cb42-279"><a href="#cb42-279" aria-hidden="true" tabindex="-1"></a>        &amp; = 4tp(1-p)</span>
<span id="cb42-280"><a href="#cb42-280" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-281"><a href="#cb42-281" aria-hidden="true" tabindex="-1"></a>If $p = 1/2$ and $t = 100$, we should expect that the distribution of $X_t$ resembles $N(0,100)$. </span>
<span id="cb42-282"><a href="#cb42-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-285"><a href="#cb42-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-286"><a href="#cb42-286" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_n_random_walk</span>(<span class="fl">1e5</span>, <span class="dv">100</span>, rredmacher, <span class="fu">list</span>(<span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-287"><a href="#cb42-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb42-288"><a href="#cb42-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-289"><a href="#cb42-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-292"><a href="#cb42-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-293"><a href="#cb42-293" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-294"><a href="#cb42-294" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot54</span></span>
<span id="cb42-295"><a href="#cb42-295" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-296"><a href="#cb42-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-297"><a href="#cb42-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-298"><a href="#cb42-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Position of random walk at time t=100 for 100,000 simulations with a normal distribution with µ=0 and σ=10 overlaid."</span></span>
<span id="cb42-299"><a href="#cb42-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-300"><a href="#cb42-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-301"><a href="#cb42-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-302"><a href="#cb42-302" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb42-303"><a href="#cb42-303" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb42-304"><a href="#cb42-304" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-305"><a href="#cb42-305" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb42-306"><a href="#cb42-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(position)) <span class="sc">+</span></span>
<span id="cb42-307"><a href="#cb42-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">colour =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">binwidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb42-308"><a href="#cb42-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-309"><a href="#cb42-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> t<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>p <span class="sc">-</span> <span class="dv">1</span>), <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">*</span>t<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb42-310"><a href="#cb42-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">x =</span> <span class="st">"Random Walk Position at t=100"</span>)</span>
<span id="cb42-311"><a href="#cb42-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-312"><a href="#cb42-312" aria-hidden="true" tabindex="-1"></a>This entire examples happens to be just one very stylized example of a random walk. There exists numerous interesting extensions with valuable applications.</span>
<span id="cb42-313"><a href="#cb42-313" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-314"><a href="#cb42-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-315"><a href="#cb42-315" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-316"><a href="#cb42-316" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wiener Process</span></span>
<span id="cb42-317"><a href="#cb42-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-318"><a href="#cb42-318" aria-hidden="true" tabindex="-1"></a>One of the most famous random function is the the Wiener process. This continuous-time stochastic process plays a key role in physics as it's a mathematical formalization of Brownian motion.^<span class="co">[</span><span class="ot">The term "Brownian motion" is often used in place of "Wiener process".</span><span class="co">]</span> Brownian motion refers to the behavior of particles that are continuously moving randomly about. For instance, gas molecules move rapidly about colliding with other molecules, resulting in seemingly random movement. Formally, the Weiner process $W = <span class="sc">\{</span>W_t<span class="sc">\}</span>_{t\in \R^+}$ is a random variable $W:\mathcal X\to C( \R^+)$ for some probability space $(\mathcal X, \mathcal F, P)$ where $C( \R^+)$ is the set of all real continuous functions defined on the unit interval $ \R^+$.\The process $\{W_t\}_{t\in \R^+}$ satisfies:</span>
<span id="cb42-319"><a href="#cb42-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-320"><a href="#cb42-320" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$W_0 = 0$. The process' initial value at time $t=0$ is always $0$.</span>
<span id="cb42-321"><a href="#cb42-321" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>For all $t\in \R^+$, $W_{t+u} - W_t \perp W_s$ for $u \ge 0$ and $s &lt; t$. The process has independent increments. In other words, the "movement" of the process between times $t$ and $t+u$ is independent of the processes location prior to $t$ (at time $s$). Another way to think of this property is that the process is "memoryless" in the sense that future movement of the process only depends on its current position and not how it got to that position.</span>
<span id="cb42-322"><a href="#cb42-322" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>For all $t\in \R^+$, $W_{t+u}-W_t\sim N(0,u)$ for $u \ge 0$. This is equivalent to $W_t - W_s \sim N(0,t-s)$ for $s\le t$, which can also be written as $W_t-W_s\sim \sqrt{t-s}\cdot N(0,1)$</span>
<span id="cb42-323"><a href="#cb42-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-324"><a href="#cb42-324" aria-hidden="true" tabindex="-1"></a>A fourth property that we've implicitly assumed by defining $W$ to be a $C( \R^+)$-valued random variable is that $W$ is continuous. *A priori*, it isn't obvious that there exists a process which satisfies all of these properties, but we will take its existence as given.^<span class="co">[</span><span class="ot">See Section 37 of @billingsley2008probability for a proof.</span><span class="co">]</span> </span>
<span id="cb42-325"><a href="#cb42-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-326"><a href="#cb42-326" aria-hidden="true" tabindex="-1"></a>One of the limitations of turning to simulations to illlustrate $W$ is that we aren't able to graph a truly continuous (non-linear) function on a computer.^<span class="co">[</span><span class="ot">If we wanted to graph $f(x) = \sqrt x$ on $[0,1]$, we would need to evaluate $f(x)$ at many points in $[0,1]$ and then plot the results. *Technically* we're approximating the graph of $f(x)$ via linear interpolation between the points at which we evaluated $f$ using `geom_line()`. It just happens that it's easy to pick such a sufficiently large number of points to evaluate $f$ at that we get the desired graph of $f$.</span><span class="co">]</span> You may be thinking" "well no duh, this is obvious! Why are you bringing up something so basic and trivial?" It's worth emphasizing because this entire example is meant to illustrate a continuous stochastic process, which unfortunately we need to do by simulating a discrete analog. Suppose we have $N$ evenly spaced points in $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$, such that time increments are $dt = 1/N$. We have </span>
<span id="cb42-327"><a href="#cb42-327" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-328"><a href="#cb42-328" aria-hidden="true" tabindex="-1"></a>W_0 &amp; = 0,<span class="sc">\\</span></span>
<span id="cb42-329"><a href="#cb42-329" aria-hidden="true" tabindex="-1"></a>W_j &amp; = W_{j-1} + dW_{j}, &amp; (j = 1,\ldots, N)<span class="sc">\\</span></span>
<span id="cb42-330"><a href="#cb42-330" aria-hidden="true" tabindex="-1"></a>dW_j &amp; \iid N(0, dt).</span>
<span id="cb42-331"><a href="#cb42-331" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-332"><a href="#cb42-332" aria-hidden="true" tabindex="-1"></a>We'll set $N = 1\times10^7$, which is such a large value that we'll be able to just treat $W$ as if it was truly continuous. Let's simulate a single realization of $W$.</span>
<span id="cb42-333"><a href="#cb42-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-336"><a href="#cb42-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-337"><a href="#cb42-337" aria-hidden="true" tabindex="-1"></a><span class="co"># draw one realization of wiener process</span></span>
<span id="cb42-338"><a href="#cb42-338" aria-hidden="true" tabindex="-1"></a><span class="co">#   N = number of discrete points to calculate process at</span></span>
<span id="cb42-339"><a href="#cb42-339" aria-hidden="true" tabindex="-1"></a><span class="co">#   T_max = maximum time value to calculate process at</span></span>
<span id="cb42-340"><a href="#cb42-340" aria-hidden="true" tabindex="-1"></a><span class="co">#   s = parameter to iterate over if we want to draw multiple realizations</span></span>
<span id="cb42-341"><a href="#cb42-341" aria-hidden="true" tabindex="-1"></a>wiener <span class="ot">&lt;-</span> <span class="cf">function</span>(N, T_max, s){</span>
<span id="cb42-342"><a href="#cb42-342" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> T_max<span class="sc">/</span>N</span>
<span id="cb42-343"><a href="#cb42-343" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-344"><a href="#cb42-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">dW =</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> <span class="fu">sqrt</span>(dt)),</span>
<span id="cb42-345"><a href="#cb42-345" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">seq</span>(dt, T_max, dt),</span>
<span id="cb42-346"><a href="#cb42-346" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s</span>
<span id="cb42-347"><a href="#cb42-347" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-348"><a href="#cb42-348" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">cumsum</span>(dW)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-349"><a href="#cb42-349" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">value =</span> <span class="dv">0</span>, <span class="at">time =</span> <span class="dv">0</span>, <span class="at">iter_num =</span> s, <span class="at">.before =</span> <span class="dv">0</span>)</span>
<span id="cb42-350"><a href="#cb42-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-351"><a href="#cb42-351" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-352"><a href="#cb42-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-353"><a href="#cb42-353" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">wiener</span>(<span class="fl">1e5</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb42-354"><a href="#cb42-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-355"><a href="#cb42-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-358"><a href="#cb42-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-359"><a href="#cb42-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-360"><a href="#cb42-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot55</span></span>
<span id="cb42-361"><a href="#cb42-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-362"><a href="#cb42-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-363"><a href="#cb42-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-364"><a href="#cb42-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "One realization of the Wiener process on the unit interval [0,1]."</span></span>
<span id="cb42-365"><a href="#cb42-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-366"><a href="#cb42-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-367"><a href="#cb42-367" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb42-368"><a href="#cb42-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb42-369"><a href="#cb42-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-370"><a href="#cb42-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-371"><a href="#cb42-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">"Value of W at t"</span>) </span>
<span id="cb42-372"><a href="#cb42-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-373"><a href="#cb42-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-374"><a href="#cb42-374" aria-hidden="true" tabindex="-1"></a>Since $W$ is continuous it's defined for all values in the interval $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$, so we can "zoom" in on increasingly small subsets of $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$, and $W$ will still be defined for all $t$.^<span class="co">[</span><span class="ot">Of course as we look at smaller and smaller intervals, the number of discrete points used to visualize the process will shrink, so the path may not appear quite as "jagged".</span><span class="co">]</span>  </span>
<span id="cb42-375"><a href="#cb42-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-378"><a href="#cb42-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-379"><a href="#cb42-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-380"><a href="#cb42-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot56</span></span>
<span id="cb42-381"><a href="#cb42-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-382"><a href="#cb42-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb42-383"><a href="#cb42-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-384"><a href="#cb42-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "``Zooming in'' on the Wiener process."</span></span>
<span id="cb42-385"><a href="#cb42-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-386"><a href="#cb42-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-387"><a href="#cb42-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-388"><a href="#cb42-388" aria-hidden="true" tabindex="-1"></a>zoom_in <span class="ot">&lt;-</span> <span class="cf">function</span>(W, t){</span>
<span id="cb42-389"><a href="#cb42-389" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb42-390"><a href="#cb42-390" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(time <span class="sc">&lt;=</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb42-391"><a href="#cb42-391" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb42-392"><a href="#cb42-392" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_time =</span> t,</span>
<span id="cb42-393"><a href="#cb42-393" aria-hidden="true" tabindex="-1"></a>      <span class="at">zoom_factor =</span> <span class="dv">1</span><span class="sc">/</span>t</span>
<span id="cb42-394"><a href="#cb42-394" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-395"><a href="#cb42-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-396"><a href="#cb42-396" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-397"><a href="#cb42-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-398"><a href="#cb42-398" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb42-399"><a href="#cb42-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(zoom_in, <span class="at">W =</span> results) <span class="sc">%&gt;%</span> </span>
<span id="cb42-400"><a href="#cb42-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-401"><a href="#cb42-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb42-402"><a href="#cb42-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb42-403"><a href="#cb42-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(zoom_factor) <span class="sc">+</span></span>
<span id="cb42-404"><a href="#cb42-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view_follow</span>() <span class="sc">+</span></span>
<span id="cb42-405"><a href="#cb42-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-406"><a href="#cb42-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">"Value of W at t"</span>)</span>
<span id="cb42-407"><a href="#cb42-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-408"><a href="#cb42-408" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">nframes =</span> <span class="dv">300</span>)</span>
<span id="cb42-409"><a href="#cb42-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-410"><a href="#cb42-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-411"><a href="#cb42-411" aria-hidden="true" tabindex="-1"></a>Note that as we "zoom in" the sample path has the same jagged appearance of $W$ on all of $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$. This is because the Wiener process is closely linked to the idea of a fractal.^<span class="co">[</span><span class="ot">Reference to john cook article</span><span class="co">]</span> Another interesting feature is that $W$ is nowhere differentiable despite being continuous on account of it being comprised of an infinite number of "kinks".</span>
<span id="cb42-412"><a href="#cb42-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-413"><a href="#cb42-413" aria-hidden="true" tabindex="-1"></a>Now that we've seen one sample path, let's draw 100 realizations of $W$ to get a sense of the relative frequency of certain paths.</span>
<span id="cb42-414"><a href="#cb42-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-417"><a href="#cb42-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-418"><a href="#cb42-418" aria-hidden="true" tabindex="-1"></a>draw_wiener <span class="ot">&lt;-</span> <span class="cf">function</span>(M, N, T_max){</span>
<span id="cb42-419"><a href="#cb42-419" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb42-420"><a href="#cb42-420" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(wiener, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max) <span class="sc">%&gt;%</span> </span>
<span id="cb42-421"><a href="#cb42-421" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>() </span>
<span id="cb42-422"><a href="#cb42-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-423"><a href="#cb42-423" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-424"><a href="#cb42-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-425"><a href="#cb42-425" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener</span>(<span class="fl">1e2</span>, <span class="fl">1e4</span>, <span class="dv">1</span>)</span>
<span id="cb42-426"><a href="#cb42-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-427"><a href="#cb42-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-430"><a href="#cb42-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-431"><a href="#cb42-431" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-432"><a href="#cb42-432" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot57</span></span>
<span id="cb42-433"><a href="#cb42-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-434"><a href="#cb42-434" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-435"><a href="#cb42-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-436"><a href="#cb42-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1,000 simulated realizations of the Wiener process"</span></span>
<span id="cb42-437"><a href="#cb42-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-438"><a href="#cb42-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-439"><a href="#cb42-439" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-440"><a href="#cb42-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb42-441"><a href="#cb42-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb42-442"><a href="#cb42-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-443"><a href="#cb42-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb42-444"><a href="#cb42-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-445"><a href="#cb42-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb42-446"><a href="#cb42-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-447"><a href="#cb42-447" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb42-448"><a href="#cb42-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-449"><a href="#cb42-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-450"><a href="#cb42-450" aria-hidden="true" tabindex="-1"></a>Another way to visualize these realizations is by looking at the distribution of the simulated values of $W$ at various values of $t$. Since $W_t - W_s \sim N(0, t-s)$ and $W_0 = 0$, we should expect that $$W_t = W_t - 0  = W_t - W_0 \sim N(0,t-0) = N(0,t).$$</span>
<span id="cb42-451"><a href="#cb42-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-454"><a href="#cb42-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-455"><a href="#cb42-455" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw one realization of wiener process at times t (approximately)</span></span>
<span id="cb42-456"><a href="#cb42-456" aria-hidden="true" tabindex="-1"></a>wiener_t <span class="ot">&lt;-</span> <span class="cf">function</span>(N, T_max, t, s){ </span>
<span id="cb42-457"><a href="#cb42-457" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-458"><a href="#cb42-458" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">wiener</span>(N, T_max, s)</span>
<span id="cb42-459"><a href="#cb42-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-460"><a href="#cb42-460" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pick the values where W_t is calculated that are closest to the times of interest</span></span>
<span id="cb42-461"><a href="#cb42-461" aria-hidden="true" tabindex="-1"></a>  t_filter <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb42-462"><a href="#cb42-462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb42-463"><a href="#cb42-463" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand_grid</span>(<span class="at">given_t =</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb42-464"><a href="#cb42-464" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dist =</span> <span class="fu">abs</span>(time <span class="sc">-</span> given_t)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-465"><a href="#cb42-465" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(given_t) <span class="sc">%&gt;%</span> </span>
<span id="cb42-466"><a href="#cb42-466" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dist <span class="sc">==</span> <span class="fu">min</span>(dist)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-467"><a href="#cb42-467" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-468"><a href="#cb42-468" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb42-469"><a href="#cb42-469" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>()</span>
<span id="cb42-470"><a href="#cb42-470" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-471"><a href="#cb42-471" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb42-472"><a href="#cb42-472" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(time <span class="sc">%in%</span> t_filter) <span class="sc">%&gt;%</span> </span>
<span id="cb42-473"><a href="#cb42-473" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>dW)</span>
<span id="cb42-474"><a href="#cb42-474" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-475"><a href="#cb42-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-476"><a href="#cb42-476" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-477"><a href="#cb42-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-478"><a href="#cb42-478" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw M realizations of wiener process at vector of times t_vals</span></span>
<span id="cb42-479"><a href="#cb42-479" aria-hidden="true" tabindex="-1"></a>draw_wiener_t <span class="ot">&lt;-</span> <span class="cf">function</span>(M, t, T_max, N){</span>
<span id="cb42-480"><a href="#cb42-480" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M <span class="sc">%&gt;%</span> </span>
<span id="cb42-481"><a href="#cb42-481" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(wiener_t, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max, <span class="at">t =</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb42-482"><a href="#cb42-482" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb42-483"><a href="#cb42-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-484"><a href="#cb42-484" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-485"><a href="#cb42-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-486"><a href="#cb42-486" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(<span class="fl">1e5</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span>
<span id="cb42-487"><a href="#cb42-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-488"><a href="#cb42-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-491"><a href="#cb42-491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-492"><a href="#cb42-492" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-493"><a href="#cb42-493" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot58</span></span>
<span id="cb42-494"><a href="#cb42-494" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-495"><a href="#cb42-495" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb42-496"><a href="#cb42-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-497"><a href="#cb42-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The top panel shows the density of the Wiener process at 10 fixed times calculated using 100,000 simulations. The bottom panel shows the sample analogs of expectation and variance for the process calculated at the fixed times, along with the theoretical values for comparison."</span></span>
<span id="cb42-498"><a href="#cb42-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-499"><a href="#cb42-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-500"><a href="#cb42-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-501"><a href="#cb42-501" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-502"><a href="#cb42-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> time, <span class="at">group =</span> time)) <span class="sc">+</span></span>
<span id="cb42-503"><a href="#cb42-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges2</span>(<span class="at">scale =</span> <span class="dv">5</span>, <span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">rel_min_height =</span> <span class="fl">0.007</span>) <span class="sc">+</span></span>
<span id="cb42-504"><a href="#cb42-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb42-505"><a href="#cb42-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb42-506"><a href="#cb42-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb42-507"><a href="#cb42-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"W_t"</span>, <span class="at">y =</span> <span class="st">"Time t"</span>)</span>
<span id="cb42-508"><a href="#cb42-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-509"><a href="#cb42-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-510"><a href="#cb42-510" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-511"><a href="#cb42-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb42-512"><a href="#cb42-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb42-513"><a href="#cb42-513" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample Mean'</span> <span class="ot">=</span> <span class="fu">mean</span>(value),</span>
<span id="cb42-514"><a href="#cb42-514" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample Variance'</span> <span class="ot">=</span> <span class="fu">var</span>(value)</span>
<span id="cb42-515"><a href="#cb42-515" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-516"><a href="#cb42-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>time) <span class="sc">%&gt;%</span> </span>
<span id="cb42-517"><a href="#cb42-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb42-518"><a href="#cb42-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb42-519"><a href="#cb42-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb42-520"><a href="#cb42-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-521"><a href="#cb42-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb42-522"><a href="#cb42-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb42-523"><a href="#cb42-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-524"><a href="#cb42-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">label=</span> <span class="st">"Var(W_t) = t"</span>) <span class="sc">+</span></span>
<span id="cb42-525"><a href="#cb42-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label=</span> <span class="st">"E[W_t] = 0"</span>) <span class="sc">+</span></span>
<span id="cb42-526"><a href="#cb42-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb42-527"><a href="#cb42-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time t"</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb42-528"><a href="#cb42-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) </span>
<span id="cb42-529"><a href="#cb42-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-530"><a href="#cb42-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-531"><a href="#cb42-531" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb42-532"><a href="#cb42-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-533"><a href="#cb42-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-534"><a href="#cb42-534" aria-hidden="true" tabindex="-1"></a>For further confirmation that $W_t - W_s \sim N(0, t-s)$, let's calculate the sample variance associated with our realizations of $W_t - W_s$ for all $s,t\in<span class="co">[</span><span class="ot">0.1, 0.2,\ldots,0.9,1</span><span class="co">]</span>$ satisfying $s \le t$.</span>
<span id="cb42-535"><a href="#cb42-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-538"><a href="#cb42-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-539"><a href="#cb42-539" aria-hidden="true" tabindex="-1"></a><span class="co"># For a grid of time values, calculate var_st at each point {(s,t) ∈ t_grid² | s ≤ t} over M simulations</span></span>
<span id="cb42-540"><a href="#cb42-540" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(M, t_grid, T_max, N){</span>
<span id="cb42-541"><a href="#cb42-541" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-542"><a href="#cb42-542" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define function to calculate variance</span></span>
<span id="cb42-543"><a href="#cb42-543" aria-hidden="true" tabindex="-1"></a>  var_st <span class="ot">&lt;-</span> <span class="cf">function</span>(W, s, t){</span>
<span id="cb42-544"><a href="#cb42-544" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(t <span class="sc">==</span> s){</span>
<span id="cb42-545"><a href="#cb42-545" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb42-546"><a href="#cb42-546" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb42-547"><a href="#cb42-547" aria-hidden="true" tabindex="-1"></a>      output <span class="ot">&lt;-</span> W <span class="sc">%&gt;%</span> </span>
<span id="cb42-548"><a href="#cb42-548" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(s,t)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-549"><a href="#cb42-549" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(iter_num) <span class="sc">%&gt;%</span> </span>
<span id="cb42-550"><a href="#cb42-550" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">diff =</span> value <span class="sc">-</span> <span class="fu">lag</span>(value, <span class="at">order_by =</span> time)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-551"><a href="#cb42-551" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-552"><a href="#cb42-552" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarize</span>(<span class="fu">var</span>(diff, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-553"><a href="#cb42-553" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb42-554"><a href="#cb42-554" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb42-555"><a href="#cb42-555" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(output)</span>
<span id="cb42-556"><a href="#cb42-556" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-557"><a href="#cb42-557" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-558"><a href="#cb42-558" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-559"><a href="#cb42-559" aria-hidden="true" tabindex="-1"></a>  <span class="co"># draw M realizations of W at grid of times</span></span>
<span id="cb42-560"><a href="#cb42-560" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(M, t_grid, T_max, N)</span>
<span id="cb42-561"><a href="#cb42-561" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-562"><a href="#cb42-562" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply var_st to all combinations of times</span></span>
<span id="cb42-563"><a href="#cb42-563" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb42-564"><a href="#cb42-564" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">unique</span>(W<span class="sc">$</span>time),</span>
<span id="cb42-565"><a href="#cb42-565" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">unique</span>(W<span class="sc">$</span>time)</span>
<span id="cb42-566"><a href="#cb42-566" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-567"><a href="#cb42-567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(s <span class="sc">&lt;=</span> t) <span class="sc">%&gt;%</span> </span>
<span id="cb42-568"><a href="#cb42-568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-569"><a href="#cb42-569" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">var =</span> <span class="fu">var_st</span>(W, s, t))</span>
<span id="cb42-570"><a href="#cb42-570" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-571"><a href="#cb42-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-572"><a href="#cb42-572" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-573"><a href="#cb42-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-574"><a href="#cb42-574" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="fl">1e5</span>, (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span>
<span id="cb42-575"><a href="#cb42-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-576"><a href="#cb42-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-579"><a href="#cb42-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-580"><a href="#cb42-580" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-581"><a href="#cb42-581" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot59</span></span>
<span id="cb42-582"><a href="#cb42-582" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-583"><a href="#cb42-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-584"><a href="#cb42-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-585"><a href="#cb42-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The sample variance associated with W_t - W_s calculated using 100,000 simulations."</span></span>
<span id="cb42-586"><a href="#cb42-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-587"><a href="#cb42-587" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-588"><a href="#cb42-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-589"><a href="#cb42-589" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb42-590"><a href="#cb42-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(s,t, <span class="at">fill =</span> var)) <span class="sc">+</span></span>
<span id="cb42-591"><a href="#cb42-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">lwd =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-592"><a href="#cb42-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(var,<span class="dv">3</span>)), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb42-593"><a href="#cb42-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-594"><a href="#cb42-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb42-595"><a href="#cb42-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb42-596"><a href="#cb42-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb42-597"><a href="#cb42-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Var(W_t - W_s)"</span>) <span class="sc">+</span></span>
<span id="cb42-598"><a href="#cb42-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.line =</span> <span class="fu">element_blank</span>())</span>
<span id="cb42-599"><a href="#cb42-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-600"><a href="#cb42-600" aria-hidden="true" tabindex="-1"></a>We have $\widehat{\text{Var}}(W_t-W_s) \approx t-s$ as anticipated! Finally, we can provide visual evidence that $W_{t+u} - W_t \perp W_s$ for $u \ge 0$ and $s &lt; t$. We'll let $t = 0.3$, $u=0.1$, and $s = 0.2$.</span>
<span id="cb42-601"><a href="#cb42-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-604"><a href="#cb42-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-605"><a href="#cb42-605" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_wiener_t</span>(<span class="fl">1e5</span>, (<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">1e3</span>)</span>
<span id="cb42-606"><a href="#cb42-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-607"><a href="#cb42-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-610"><a href="#cb42-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-611"><a href="#cb42-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-612"><a href="#cb42-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot595</span></span>
<span id="cb42-613"><a href="#cb42-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-614"><a href="#cb42-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-615"><a href="#cb42-615" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-616"><a href="#cb42-616" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100,000 realized values of (W_4 - W_3) plotted against the corresponding 100,000 realized values of W_2."</span></span>
<span id="cb42-617"><a href="#cb42-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-618"><a href="#cb42-618" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-619"><a href="#cb42-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-620"><a href="#cb42-620" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb42-621"><a href="#cb42-621" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.4</span>] <span class="sc">-</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.3</span>],</span>
<span id="cb42-622"><a href="#cb42-622" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> results<span class="sc">$</span>value[results<span class="sc">$</span>time <span class="sc">==</span> <span class="fl">0.2</span>]</span>
<span id="cb42-623"><a href="#cb42-623" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-624"><a href="#cb42-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb42-625"><a href="#cb42-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-626"><a href="#cb42-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-627"><a href="#cb42-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"W_4 - W_3"</span>, <span class="at">y =</span> <span class="st">"W_2"</span>)</span>
<span id="cb42-628"><a href="#cb42-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-629"><a href="#cb42-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-630"><a href="#cb42-630" aria-hidden="true" tabindex="-1"></a>From this figure, the two random variables certainly appear to be independent. </span>
<span id="cb42-631"><a href="#cb42-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-632"><a href="#cb42-632" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-633"><a href="#cb42-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-634"><a href="#cb42-634" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Wiener process is just one instance of a stochastic process that "looks like" a normal distribution at specific points $t\in T$. These types of processes are so special that they are simply known as Gaussian.</span></span>
<span id="cb42-635"><a href="#cb42-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-636"><a href="#cb42-636" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb42-637"><a href="#cb42-637" aria-hidden="true" tabindex="-1"></a>Let $<span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in T}$ be a stochastic process over the state space $\R$. The process is a [***Gaussian process***]{style="color:red"} if for any finite set of indices $t_1,\ldots,t_k\in T$, the random vector $\X = (X_{t_1},\ldots, X_{t_k})$ is distributed according to a multivariate normal distribution. </span>
<span id="cb42-638"><a href="#cb42-638" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-639"><a href="#cb42-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-640"><a href="#cb42-640" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The defining properties of the Wiener process immediately establish it as a Gaussian process. To find the explicit normal distribution referenced in the definition of a Gaussian process we need to calculate the covariance of $W_t$ and $W_s$.</span></span>
<span id="cb42-641"><a href="#cb42-641" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-642"><a href="#cb42-642" aria-hidden="true" tabindex="-1"></a>\cov{W_t,W_s} &amp;= \begin{cases} \cov{W_t-0, W_s} &amp; t &gt; s<span class="sc">\\</span> \cov{W_t, W_s + 0} &amp; s\le t \end{cases} <span class="sc">\\</span>&amp;= \begin{cases} \cov{W_t-W_s+W_s, W_s} &amp; t &gt; s<span class="sc">\\</span> \cov{W_t, W_s + W_t- W_t} &amp; s\le t\end{cases}<span class="sc">\\</span></span>
<span id="cb42-643"><a href="#cb42-643" aria-hidden="true" tabindex="-1"></a>&amp;= \begin{cases} \cov{W_t-W_s, W_s}+\cov{W_s,W_s} &amp; t &gt; s<span class="sc">\\</span> \cov{W_t, W_s-W_t} + \cov{W_t,W_t}&amp; s\le t \end{cases}<span class="sc">\\</span></span>
<span id="cb42-644"><a href="#cb42-644" aria-hidden="true" tabindex="-1"></a>&amp; = \begin{cases} 0 + \var{W_s} &amp; t &gt; s<span class="sc">\\</span> 0 + \var{W_t}&amp; s\le t \end{cases} &amp; (\text{independent increments})<span class="sc">\\</span></span>
<span id="cb42-645"><a href="#cb42-645" aria-hidden="true" tabindex="-1"></a>&amp; = \begin{cases} s &amp; t &gt; s<span class="sc">\\</span> t&amp; s\le t \end{cases}<span class="sc">\\</span></span>
<span id="cb42-646"><a href="#cb42-646" aria-hidden="true" tabindex="-1"></a>&amp; = \min<span class="sc">\{</span>s,t<span class="sc">\}</span></span>
<span id="cb42-647"><a href="#cb42-647" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-648"><a href="#cb42-648" aria-hidden="true" tabindex="-1"></a>Therefore, for any $\mathbf W = (W_{t_1},\ldots, W_{t_k})$ where $t_1,\ldots,t_k \in <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$ we have </span>
<span id="cb42-649"><a href="#cb42-649" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-650"><a href="#cb42-650" aria-hidden="true" tabindex="-1"></a>\mathbf W &amp;\sim N(\zer,\Sig),<span class="sc">\\</span></span>
<span id="cb42-651"><a href="#cb42-651" aria-hidden="true" tabindex="-1"></a>\Sig_{j\ell}&amp;=\begin{cases}t_j &amp; j = \ell <span class="sc">\\</span> \min<span class="sc">\{</span>t_j,t_{\ell}<span class="sc">\}</span> &amp; \text{otherwise} \end{cases}.</span>
<span id="cb42-652"><a href="#cb42-652" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-653"><a href="#cb42-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-654"><a href="#cb42-654" aria-hidden="true" tabindex="-1"></a>Let's look at another example of a Gaussian process by tweaking the Wiener process. </span>
<span id="cb42-655"><a href="#cb42-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-656"><a href="#cb42-656" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-657"><a href="#cb42-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-658"><a href="#cb42-658" aria-hidden="true" tabindex="-1"></a><span class="fu">## Brownian Bridge</span></span>
<span id="cb42-659"><a href="#cb42-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-660"><a href="#cb42-660" aria-hidden="true" tabindex="-1"></a>A process closely related to the Wiener Process is a Brownian bridge. For all intents and purposes, a Brownian bridge is a Wiener-like process which "bridges" two points $a,b\in \R$ on on the interval $<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$. The simplest form of the Brownian bridge has $a=b=0$, and is defined via conditioning as </span>
<span id="cb42-661"><a href="#cb42-661" aria-hidden="true" tabindex="-1"></a>$$ B(t)  = (W(t) \mid W(T) = 0)$$ for $t\in <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$. This is often called the "standard" Brownian bridge, and often has $T=1$. We can construct this process by defining $B(t)$ as </span>
<span id="cb42-662"><a href="#cb42-662" aria-hidden="true" tabindex="-1"></a>$$B(t) = W(t) - \frac{t}{T}W(T).$$ To bridge a general choice of $a,b\in\R$, we'll start by connecting the two points with a straight line parameterized by $t\in<span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$, $(1-t/T)a+(t/T)b$. To modify this line, we'll add the standard Brownian bridge $B(t)$.</span>
<span id="cb42-663"><a href="#cb42-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-664"><a href="#cb42-664" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-665"><a href="#cb42-665" aria-hidden="true" tabindex="-1"></a>B(t\mid a,b) &amp;= \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + B(t)<span class="sc">\\</span></span>
<span id="cb42-666"><a href="#cb42-666" aria-hidden="true" tabindex="-1"></a>&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W(t) - \frac{t}{T}W(T)</span>
<span id="cb42-667"><a href="#cb42-667" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-668"><a href="#cb42-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-671"><a href="#cb42-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-672"><a href="#cb42-672" aria-hidden="true" tabindex="-1"></a>brownian_bridge <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">T_max =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, s){</span>
<span id="cb42-673"><a href="#cb42-673" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Start by drawing standard Wiener process on [0,T]</span></span>
<span id="cb42-674"><a href="#cb42-674" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">wiener</span>(N, T_max, <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-675"><a href="#cb42-675" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb42-676"><a href="#cb42-676" aria-hidden="true" tabindex="-1"></a>      <span class="co"># define B(t) using W(t)</span></span>
<span id="cb42-677"><a href="#cb42-677" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> (<span class="dv">1</span> <span class="sc">-</span> time<span class="sc">/</span>T_max)<span class="sc">*</span>a <span class="sc">+</span> (time<span class="sc">/</span>T_max)<span class="sc">*</span>b <span class="sc">+</span> value <span class="sc">-</span> (time<span class="sc">/</span>T_max)<span class="sc">*</span><span class="fu">last</span>(value, <span class="at">order_by =</span> time),</span>
<span id="cb42-678"><a href="#cb42-678" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> s</span>
<span id="cb42-679"><a href="#cb42-679" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-680"><a href="#cb42-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-681"><a href="#cb42-681" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-682"><a href="#cb42-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-683"><a href="#cb42-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-684"><a href="#cb42-684" aria-hidden="true" tabindex="-1"></a>draw_brownian_bridge <span class="ot">&lt;-</span> <span class="cf">function</span>(n, N, <span class="at">T_max =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>){</span>
<span id="cb42-685"><a href="#cb42-685" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n <span class="sc">%&gt;%</span></span>
<span id="cb42-686"><a href="#cb42-686" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(brownian_bridge, <span class="at">N =</span> N, <span class="at">T_max =</span> T_max, <span class="at">a =</span> a, <span class="at">b =</span> b) <span class="sc">%&gt;%</span></span>
<span id="cb42-687"><a href="#cb42-687" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb42-688"><a href="#cb42-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-689"><a href="#cb42-689" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-690"><a href="#cb42-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-691"><a href="#cb42-691" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_brownian_bridge</span>(<span class="fl">7e3</span>, <span class="fl">1e4</span>, <span class="at">T_max =</span> <span class="dv">2</span>, <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">3</span>)</span>
<span id="cb42-692"><a href="#cb42-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-693"><a href="#cb42-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-696"><a href="#cb42-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-697"><a href="#cb42-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-698"><a href="#cb42-698" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot5952</span></span>
<span id="cb42-699"><a href="#cb42-699" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-700"><a href="#cb42-700" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-701"><a href="#cb42-701" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-702"><a href="#cb42-702" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of the standard Brownian bridge"</span></span>
<span id="cb42-703"><a href="#cb42-703" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-704"><a href="#cb42-704" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb42-705"><a href="#cb42-705" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-706"><a href="#cb42-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(iter_num <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-707"><a href="#cb42-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb42-708"><a href="#cb42-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span> </span>
<span id="cb42-709"><a href="#cb42-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb42-710"><a href="#cb42-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb42-711"><a href="#cb42-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-712"><a href="#cb42-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb42-713"><a href="#cb42-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-714"><a href="#cb42-714" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb42-715"><a href="#cb42-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-716"><a href="#cb42-716" aria-hidden="true" tabindex="-1"></a>Let's consider the random variable given by the Brownian bridge takes on at a specific point in time $t\in<span class="co">[</span><span class="ot">t_1,t_2</span><span class="co">]</span>$ which we will write as $B_{t\mid a,b, t_1, t_2}$. We can derive the distribution of this random variable using properties of the normal distribution and $W_t\sim N(0,t)$.</span>
<span id="cb42-717"><a href="#cb42-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-718"><a href="#cb42-718" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-719"><a href="#cb42-719" aria-hidden="true" tabindex="-1"></a>B_{t\mid a,b}&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W(t) - \frac{t}{T}W(T) <span class="sc">\\</span></span>
<span id="cb42-720"><a href="#cb42-720" aria-hidden="true" tabindex="-1"></a>&amp; \sim \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t) - \frac{t}{T}N(0,T)<span class="sc">\\</span></span>
<span id="cb42-721"><a href="#cb42-721" aria-hidden="true" tabindex="-1"></a>&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t) - N(0,t^2/T)<span class="sc">\\</span></span>
<span id="cb42-722"><a href="#cb42-722" aria-hidden="true" tabindex="-1"></a>&amp; = \left(1-\frac{t}{T}\right)a + \frac{t}{T}b + N(0,t(T - t)/T)<span class="sc">\\</span></span>
<span id="cb42-723"><a href="#cb42-723" aria-hidden="true" tabindex="-1"></a>&amp; = N\left( \left(1-\frac{t}{T}\right)a + \frac{t}{T}b, \left(\frac{t(T-t)}{T}\right)\right)</span>
<span id="cb42-724"><a href="#cb42-724" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-725"><a href="#cb42-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-726"><a href="#cb42-726" aria-hidden="true" tabindex="-1"></a>To calculate the covariance of the Brownian bridge at two points, we first need to calculate the covariance </span>
<span id="cb42-727"><a href="#cb42-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-728"><a href="#cb42-728" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-729"><a href="#cb42-729" aria-hidden="true" tabindex="-1"></a>\cov{B_{t\mid a,b}, B_{s\mid a,b}} &amp;= \cov{\left(1-\frac{t}{T}\right)a + \frac{t}{T}b + W_t - \frac{t}{T}W_T, \left(1-\frac{s}{T}\right)a + \frac{s}{T}b + W_s - \frac{s}{T}W_T}<span class="sc">\\</span></span>
<span id="cb42-730"><a href="#cb42-730" aria-hidden="true" tabindex="-1"></a>&amp; = \cov{W_t - \frac{t}{T}W_T, W_s - \frac{s}{T}W_T} <span class="sc">\\</span> </span>
<span id="cb42-731"><a href="#cb42-731" aria-hidden="true" tabindex="-1"></a>&amp; = \cov{W_t, W_s} - \frac{s}{T}\cov{W_t, W_T} - \frac{t}{T}\cov{W_T, W_s} + \frac{st}{T^2}\cov{W_T, W_T}<span class="sc">\\</span></span>
<span id="cb42-732"><a href="#cb42-732" aria-hidden="true" tabindex="-1"></a>&amp; = \min<span class="sc">\{</span>t,s<span class="sc">\}</span> - \frac{s}{T}\min<span class="sc">\{</span>t, T<span class="sc">\}</span> - \frac{t}{T}\min<span class="sc">\{</span>s, T<span class="sc">\}</span> + \frac{st}{T^2}\var{W_T}<span class="sc">\\</span></span>
<span id="cb42-733"><a href="#cb42-733" aria-hidden="true" tabindex="-1"></a>&amp; = \min<span class="sc">\{</span>t,s<span class="sc">\}</span> - \frac{st}{T} - \frac{st}{T} - \frac{stT}{T^2}<span class="sc">\\</span></span>
<span id="cb42-734"><a href="#cb42-734" aria-hidden="true" tabindex="-1"></a>&amp; = \min<span class="sc">\{</span>t,s<span class="sc">\}</span> - \frac{st}{T}</span>
<span id="cb42-735"><a href="#cb42-735" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-736"><a href="#cb42-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-737"><a href="#cb42-737" aria-hidden="true" tabindex="-1"></a>If we combine these two calculations, we can conclude that for any $t_1,\ldots,t_k\in <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$ we have </span>
<span id="cb42-738"><a href="#cb42-738" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-739"><a href="#cb42-739" aria-hidden="true" tabindex="-1"></a>\mathbf W &amp;\sim N(\boldsymbol{\mu},\Sig),<span class="sc">\\</span></span>
<span id="cb42-740"><a href="#cb42-740" aria-hidden="true" tabindex="-1"></a>\boldsymbol{\mu}_j &amp;= \left(1-\frac{t}{T}\right)a + \frac{t}{T}b,<span class="sc">\\</span></span>
<span id="cb42-741"><a href="#cb42-741" aria-hidden="true" tabindex="-1"></a>\Sig_{j\ell}&amp;=\begin{cases}\frac{t_j(T-t_j)}{T} &amp; j = \ell <span class="sc">\\</span> \min<span class="sc">\{</span>t_j,t_{\ell}<span class="sc">\}</span> - \frac{t_jt_\ell}{T} &amp; \text{otherwise} \end{cases},</span>
<span id="cb42-742"><a href="#cb42-742" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-743"><a href="#cb42-743" aria-hidden="true" tabindex="-1"></a>making $B(t\mid a,b)$ a Gaussian process. The Brownian bridge is an important tool and can be generalized to arbitrary intervals $<span class="co">[</span><span class="ot">t_1,t_2</span><span class="co">]</span>\subseteq <span class="co">[</span><span class="ot">0,T</span><span class="co">]</span>$. For details see pages 82-86 of @glasserman2004monte. </span>
<span id="cb42-744"><a href="#cb42-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-745"><a href="#cb42-745" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-746"><a href="#cb42-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-747"><a href="#cb42-747" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-748"><a href="#cb42-748" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gaussian White Noise </span></span>
<span id="cb42-749"><a href="#cb42-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-750"><a href="#cb42-750" aria-hidden="true" tabindex="-1"></a>The simplest of Gaussian processes is a discrete-time white noise process $\varepsilon$ where $\varepsilon_t \iid N(0, \sigma^2)$. </span>
<span id="cb42-751"><a href="#cb42-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-754"><a href="#cb42-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-755"><a href="#cb42-755" aria-hidden="true" tabindex="-1"></a>gaussian_wn <span class="ot">&lt;-</span> <span class="cf">function</span>(T_max, <span class="at">sigma =</span> <span class="dv">1</span>, s){</span>
<span id="cb42-756"><a href="#cb42-756" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(T_max, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb42-757"><a href="#cb42-757" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-758"><a href="#cb42-758" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb42-759"><a href="#cb42-759" aria-hidden="true" tabindex="-1"></a>      <span class="at">t =</span> <span class="fu">row_number</span>(),</span>
<span id="cb42-760"><a href="#cb42-760" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_num =</span> s</span>
<span id="cb42-761"><a href="#cb42-761" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-762"><a href="#cb42-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-763"><a href="#cb42-763" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-764"><a href="#cb42-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-765"><a href="#cb42-765" aria-hidden="true" tabindex="-1"></a>draw_gaussian_wn <span class="ot">&lt;-</span> <span class="cf">function</span>(n, T_max, <span class="at">sigma =</span> <span class="dv">1</span>){</span>
<span id="cb42-766"><a href="#cb42-766" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n <span class="sc">%&gt;%</span> </span>
<span id="cb42-767"><a href="#cb42-767" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(gaussian_wn, <span class="at">T_max =</span> T_max, <span class="at">sigma =</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb42-768"><a href="#cb42-768" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb42-769"><a href="#cb42-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-770"><a href="#cb42-770" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-771"><a href="#cb42-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-772"><a href="#cb42-772" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_gaussian_wn</span>(</span>
<span id="cb42-773"><a href="#cb42-773" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb42-774"><a href="#cb42-774" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_max =</span> <span class="fl">1e4</span></span>
<span id="cb42-775"><a href="#cb42-775" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-776"><a href="#cb42-776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-777"><a href="#cb42-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-778"><a href="#cb42-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-781"><a href="#cb42-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-782"><a href="#cb42-782" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-783"><a href="#cb42-783" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot5953</span></span>
<span id="cb42-784"><a href="#cb42-784" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-785"><a href="#cb42-785" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-786"><a href="#cb42-786" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-787"><a href="#cb42-787" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of a Gaussian white noise process."</span></span>
<span id="cb42-788"><a href="#cb42-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-789"><a href="#cb42-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb42-790"><a href="#cb42-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-791"><a href="#cb42-791" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb42-792"><a href="#cb42-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, value)) <span class="sc">+</span> </span>
<span id="cb42-793"><a href="#cb42-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span> </span>
<span id="cb42-794"><a href="#cb42-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb42-795"><a href="#cb42-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb42-796"><a href="#cb42-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-797"><a href="#cb42-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb42-798"><a href="#cb42-798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-799"><a href="#cb42-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-800"><a href="#cb42-800" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-801"><a href="#cb42-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-802"><a href="#cb42-802" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One last example of a stochastic process is especially important in econometrics and is much easier to think of as a random function than more traditional examples of stochastic processes which are typically given as an indexed collection of random variables. </span></span>
<span id="cb42-803"><a href="#cb42-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-804"><a href="#cb42-804" aria-hidden="true" tabindex="-1"></a>:::{#exm-rf}</span>
<span id="cb42-805"><a href="#cb42-805" aria-hidden="true" tabindex="-1"></a><span class="fu">## A Random Function</span></span>
<span id="cb42-806"><a href="#cb42-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-807"><a href="#cb42-807" aria-hidden="true" tabindex="-1"></a>Imagine we observe an iid random sample $\X = (X_1,\ldots, X_n)$ where $X_i\iid N(\mu,\sigma^2)$, and we want to measure the distance a number $t\in\R$ is from the sample $\X$. One way to do this is with the Euclidean metric. If $\mathbf e$ is the unit vector of length $n$ then the distance between $\X$ and $t$ is </span>
<span id="cb42-808"><a href="#cb42-808" aria-hidden="true" tabindex="-1"></a>$$ \norm{\X - t\cdot\mathbf e}_2 = \left(\textstyle\sum_{i=1}^n(X_i - t)^2\right)^{1/2}.$$ If we define $Q_t = \norm{\X - t\cdot\mathbf e}_2$, then $Q = \{Q_t\}_{t\in\R}$ is a stochastic process which maps $\R$ to functions in the space $\R^\R$ (the set of all single variable real functions). Let's look at 100 simulated values of the process $Q$ where $\mu = 0$ and $\sigma^2 = 1$.</span>
<span id="cb42-809"><a href="#cb42-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-812"><a href="#cb42-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-813"><a href="#cb42-813" aria-hidden="true" tabindex="-1"></a><span class="co"># define random function Q_t</span></span>
<span id="cb42-814"><a href="#cb42-814" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, t){</span>
<span id="cb42-815"><a href="#cb42-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">sum</span>((sample<span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb42-816"><a href="#cb42-816" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-817"><a href="#cb42-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-818"><a href="#cb42-818" aria-hidden="true" tabindex="-1"></a><span class="co"># draw n values and calculate Q_t on a given domain</span></span>
<span id="cb42-819"><a href="#cb42-819" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(f, domain, n, dist, dist_params, s){</span>
<span id="cb42-820"><a href="#cb42-820" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">do.call</span>(dist, <span class="fu">append</span>(n, dist_params))</span>
<span id="cb42-821"><a href="#cb42-821" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-822"><a href="#cb42-822" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> domain, </span>
<span id="cb42-823"><a href="#cb42-823" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s,</span>
<span id="cb42-824"><a href="#cb42-824" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q =</span> <span class="fu">map_dbl</span>(domain, f, <span class="at">sample =</span> X),</span>
<span id="cb42-825"><a href="#cb42-825" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> n</span>
<span id="cb42-826"><a href="#cb42-826" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-827"><a href="#cb42-827" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-828"><a href="#cb42-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-829"><a href="#cb42-829" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-830"><a href="#cb42-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-831"><a href="#cb42-831" aria-hidden="true" tabindex="-1"></a><span class="co"># draw N realizations of Q_t on the domain</span></span>
<span id="cb42-832"><a href="#cb42-832" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cf">function</span>(N, f, domain, n, dist, dist_params){</span>
<span id="cb42-833"><a href="#cb42-833" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb42-834"><a href="#cb42-834" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(iter, <span class="at">f =</span> f, <span class="at">domain =</span> domain, <span class="at">n =</span> n, <span class="at">dist =</span> dist, <span class="at">dist_params =</span> dist_params) <span class="sc">%&gt;%</span> </span>
<span id="cb42-835"><a href="#cb42-835" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb42-836"><a href="#cb42-836" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-837"><a href="#cb42-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-838"><a href="#cb42-838" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-839"><a href="#cb42-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-840"><a href="#cb42-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-841"><a href="#cb42-841" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb42-842"><a href="#cb42-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-843"><a href="#cb42-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-846"><a href="#cb42-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-847"><a href="#cb42-847" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-848"><a href="#cb42-848" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot510</span></span>
<span id="cb42-849"><a href="#cb42-849" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-850"><a href="#cb42-850" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-851"><a href="#cb42-851" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-852"><a href="#cb42-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of an aggregated distance of a real number from a random sample calculated using the Euclidean metric."</span></span>
<span id="cb42-853"><a href="#cb42-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-854"><a href="#cb42-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb42-855"><a href="#cb42-855" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-856"><a href="#cb42-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb42-857"><a href="#cb42-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb42-858"><a href="#cb42-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-859"><a href="#cb42-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>) <span class="sc">+</span></span>
<span id="cb42-860"><a href="#cb42-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb42-861"><a href="#cb42-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-862"><a href="#cb42-862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb42-863"><a href="#cb42-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-864"><a href="#cb42-864" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb42-865"><a href="#cb42-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-866"><a href="#cb42-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-867"><a href="#cb42-867" aria-hidden="true" tabindex="-1"></a>In each case the realized value of $Q$ is a parabola which happens to be continuously differentiable, so $Q:\R\to C^2(\R)$. We could also define $Q$ using the the norm $\norm{\cdot}_1$ (giving the taxi-cab metric) or $\norm{\cdot}_\infty$ (giving the supremum metric).</span>
<span id="cb42-868"><a href="#cb42-868" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-869"><a href="#cb42-869" aria-hidden="true" tabindex="-1"></a>\norm{\X - t\cdot\mathbf e}_1 &amp;= \left(\textstyle\sum_{i=1}^n\abs{X_i - t}\right)<span class="sc">\\</span></span>
<span id="cb42-870"><a href="#cb42-870" aria-hidden="true" tabindex="-1"></a>\norm{\X - t\cdot\mathbf e}_\infty &amp; = \max_{i}\abs{X_i-t}</span>
<span id="cb42-871"><a href="#cb42-871" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-872"><a href="#cb42-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-873"><a href="#cb42-873" aria-hidden="true" tabindex="-1"></a>In both these cases, the realized value of $Q$ will not be differentiable on all of $\R$ since $\abs{x_i - t}$ is not differentiable at the point $t=x_i$.</span>
<span id="cb42-874"><a href="#cb42-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-877"><a href="#cb42-877" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-878"><a href="#cb42-878" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample,t){</span>
<span id="cb42-879"><a href="#cb42-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(sample<span class="sc">-</span>t))</span>
<span id="cb42-880"><a href="#cb42-880" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-881"><a href="#cb42-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-882"><a href="#cb42-882" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb42-883"><a href="#cb42-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-884"><a href="#cb42-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-887"><a href="#cb42-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-888"><a href="#cb42-888" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-889"><a href="#cb42-889" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot511</span></span>
<span id="cb42-890"><a href="#cb42-890" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-891"><a href="#cb42-891" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-892"><a href="#cb42-892" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-893"><a href="#cb42-893" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of an aggregated distance of a real number from a random sample calculated using the taxi-cab metric. While the realization of the stochastic process appears smooth, it has slight kinks at which it is not differentiable."</span></span>
<span id="cb42-894"><a href="#cb42-894" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-895"><a href="#cb42-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb42-896"><a href="#cb42-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb42-897"><a href="#cb42-897" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-898"><a href="#cb42-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb42-899"><a href="#cb42-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb42-900"><a href="#cb42-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-901"><a href="#cb42-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>) <span class="sc">+</span></span>
<span id="cb42-902"><a href="#cb42-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb42-903"><a href="#cb42-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-904"><a href="#cb42-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb42-905"><a href="#cb42-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-906"><a href="#cb42-906" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb42-907"><a href="#cb42-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-908"><a href="#cb42-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-911"><a href="#cb42-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-912"><a href="#cb42-912" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(sample,t){</span>
<span id="cb42-913"><a href="#cb42-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">abs</span>(sample<span class="sc">-</span>t))</span>
<span id="cb42-914"><a href="#cb42-914" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-915"><a href="#cb42-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-916"><a href="#cb42-916" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="dv">100</span>, obj, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>), <span class="dv">100</span>, rnorm, <span class="fu">list</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb42-917"><a href="#cb42-917" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-918"><a href="#cb42-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-921"><a href="#cb42-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-922"><a href="#cb42-922" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-923"><a href="#cb42-923" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot512</span></span>
<span id="cb42-924"><a href="#cb42-924" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-925"><a href="#cb42-925" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-926"><a href="#cb42-926" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-927"><a href="#cb42-927" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of an aggregated distance of a real number from a random sample calculated using the supremum metric."</span></span>
<span id="cb42-928"><a href="#cb42-928" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-929"><a href="#cb42-929" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb42-930"><a href="#cb42-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-931"><a href="#cb42-931" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-932"><a href="#cb42-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, Q)) <span class="sc">+</span></span>
<span id="cb42-933"><a href="#cb42-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb42-934"><a href="#cb42-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-935"><a href="#cb42-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Objective Function'</span>, <span class="at">x =</span> <span class="st">'t'</span>) <span class="sc">+</span></span>
<span id="cb42-936"><a href="#cb42-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span></span>
<span id="cb42-937"><a href="#cb42-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-938"><a href="#cb42-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) </span>
<span id="cb42-939"><a href="#cb42-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-940"><a href="#cb42-940" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb42-941"><a href="#cb42-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-942"><a href="#cb42-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-943"><a href="#cb42-943" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-944"><a href="#cb42-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-945"><a href="#cb42-945" aria-hidden="true" tabindex="-1"></a><span class="fu">## Moments</span></span>
<span id="cb42-946"><a href="#cb42-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-947"><a href="#cb42-947" aria-hidden="true" tabindex="-1"></a>In some of our examples we saw that if we fix some arbitrary time $t$, we can think of the stochastic process $X(t)\in S^T$ as a random variable $X_t \in S$. We can consider the expected value $\E{X_t}$ and variance $\var{X_t}$ of this random variable $X_t$ like we would any other random variable we're more familiar with. The only thing that is a bit different is that $\E{X_t}$ and $\var{X_t}$ may be functions of $t.$ In the case of the expected value, this function has a specific name.</span>
<span id="cb42-948"><a href="#cb42-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-949"><a href="#cb42-949" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb42-950"><a href="#cb42-950" aria-hidden="true" tabindex="-1"></a>Let $X = <span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in \mathbb N}$ be a stochastic process over the state space $\R$. The <span class="co">[</span><span class="ot">***mean-function***</span><span class="co">]</span>{style="color:red"} $\mu(t):T\to \R$ for the process $X$ is defined as $\mu(t) = \E{X_t}$.</span>
<span id="cb42-951"><a href="#cb42-951" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-952"><a href="#cb42-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-953"><a href="#cb42-953" aria-hidden="true" tabindex="-1"></a>We also have a special name for the covariance between two random variables in the event that both are given by the same stochastic process evaluated at two different points in $T$.</span>
<span id="cb42-954"><a href="#cb42-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-955"><a href="#cb42-955" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb42-956"><a href="#cb42-956" aria-hidden="true" tabindex="-1"></a>Let $X = <span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in  T}$ be a stochastic process over the state space $\R$ where $T\subseteq \R$. The <span class="co">[</span><span class="ot">***$j$th autocovariance***</span><span class="co">]</span>{style="color:red"} of $X_t$ is defined as </span>
<span id="cb42-957"><a href="#cb42-957" aria-hidden="true" tabindex="-1"></a>$$\gamma_{jt} = \cov{X_{t}, X_{t-j}} = \E{ (X_{t}-\mu(t)) (X_{t-j}-\mu(t-j))} = \E{X_tX_{t-j}} - \mu(t)\mu(t-j)$$ for some time $t$ and increment $j$. For a finite collection of increments $j = 1,\ldots,t$ we can define the <span class="co">[</span><span class="ot">***autocovariance matrix***</span><span class="co">]</span>{style="color:red"} $\boldsymbol \Gamma$ as </span>
<span id="cb42-958"><a href="#cb42-958" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-959"><a href="#cb42-959" aria-hidden="true" tabindex="-1"></a>\boldsymbol \Gamma &amp;= \var{<span class="co">[</span><span class="ot">X_t, X_{t-1}, \ldots, X_{t-j}</span><span class="co">]</span>'},<span class="sc">\\</span></span>
<span id="cb42-960"><a href="#cb42-960" aria-hidden="true" tabindex="-1"></a>&amp; = \begin{bmatrix}\cov{X_t, X_t} &amp; \cov{X_t, X_{t-1}} &amp; \cdots &amp; \cov{X_t, X_{t-j}}<span class="sc">\\</span> </span>
<span id="cb42-961"><a href="#cb42-961" aria-hidden="true" tabindex="-1"></a>\cov{X_{t-1}, X_{t}} &amp; \cov{X_{t-1}, X_{t-1}} &amp; \cdots &amp; \cov{X_{t-1}, X_{t-1}}<span class="sc">\\</span> \vdots &amp; \vdots &amp; \ddots &amp;\vdots <span class="sc">\\</span></span>
<span id="cb42-962"><a href="#cb42-962" aria-hidden="true" tabindex="-1"></a>\cov{X_{t-j}, X_{t}} &amp; \cov{X_{t-j}, X_{t-1}} &amp; \cdots &amp; \cov{X_{t-j}, X_{t-j}}\end{bmatrix},<span class="sc">\\</span></span>
<span id="cb42-963"><a href="#cb42-963" aria-hidden="true" tabindex="-1"></a>&amp; = \begin{bmatrix}</span>
<span id="cb42-964"><a href="#cb42-964" aria-hidden="true" tabindex="-1"></a>\gamma_{0t} &amp; \gamma_{1t} &amp; \gamma_{2t} &amp; \cdots &amp; \gamma_{jt}<span class="sc">\\</span></span>
<span id="cb42-965"><a href="#cb42-965" aria-hidden="true" tabindex="-1"></a>\gamma_{1t} &amp; \gamma_{0(t-1)} &amp; \gamma_{1(t-1)} &amp; \cdots &amp; \gamma_{(j-1)(t-1)}<span class="sc">\\</span></span>
<span id="cb42-966"><a href="#cb42-966" aria-hidden="true" tabindex="-1"></a>\gamma_{2t} &amp; \gamma_{1(t-1)} &amp; \gamma_{0(t-2)} &amp; \cdots &amp; \gamma_{(j-2)(t-2)}<span class="sc">\\</span></span>
<span id="cb42-967"><a href="#cb42-967" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span> </span>
<span id="cb42-968"><a href="#cb42-968" aria-hidden="true" tabindex="-1"></a>\gamma_{jt} &amp; \gamma_{(j-1)(t-1)} &amp; \gamma_{(j-2)(t-2)} &amp; \cdots &amp; \gamma_{0(t-j)}</span>
<span id="cb42-969"><a href="#cb42-969" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}.</span>
<span id="cb42-970"><a href="#cb42-970" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-971"><a href="#cb42-971" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">***$j$th autocorrelation***</span><span class="co">]</span>{style="color:red"} of $X_t$ is defined as </span>
<span id="cb42-972"><a href="#cb42-972" aria-hidden="true" tabindex="-1"></a>$$\rho_{jt} = \corr{X_{t}, X_{t-j}} = \frac{\gamma_{jt}}{\sqrt{\gamma_{0t}}\sqrt{\gamma_{0(t-j)}}}.$$</span>
<span id="cb42-973"><a href="#cb42-973" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">***autocorrelation matrix***</span><span class="co">]</span>{style="color:red"} $\mathbf R$ is </span>
<span id="cb42-974"><a href="#cb42-974" aria-hidden="true" tabindex="-1"></a>$$\mathbf R = \begin{bmatrix}</span>
<span id="cb42-975"><a href="#cb42-975" aria-hidden="true" tabindex="-1"></a>\rho_{0t} &amp; \rho_{1t} &amp; \rho_{2t} &amp; \cdots &amp; \rho_{jt}<span class="sc">\\</span></span>
<span id="cb42-976"><a href="#cb42-976" aria-hidden="true" tabindex="-1"></a>\rho_{1t} &amp; \rho_{0(t-1)} &amp; \rho_{1(t-1)} &amp; \cdots &amp; \rho_{(j-1)(t-1)}<span class="sc">\\</span></span>
<span id="cb42-977"><a href="#cb42-977" aria-hidden="true" tabindex="-1"></a>\rho_{2t} &amp; \rho_{1(t-1)} &amp; \rho_{0(t-2)} &amp; \cdots &amp; \rho_{(j-2)(t-2)}<span class="sc">\\</span></span>
<span id="cb42-978"><a href="#cb42-978" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span> </span>
<span id="cb42-979"><a href="#cb42-979" aria-hidden="true" tabindex="-1"></a>\rho_{jt} &amp; \rho_{(j-1)(t-1)} &amp; \rho_{(j-2)(t-2)} &amp; \cdots &amp; \rho_{0(t-j)}</span>
<span id="cb42-980"><a href="#cb42-980" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}.$$</span>
<span id="cb42-981"><a href="#cb42-981" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-982"><a href="#cb42-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-983"><a href="#cb42-983" aria-hidden="true" tabindex="-1"></a>As the name implies, autocovariance captures how a stochastic function varies with *itself* (or rather the random variables that arise from fixing a finite collection of elements in $T$).</span>
<span id="cb42-984"><a href="#cb42-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-985"><a href="#cb42-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-986"><a href="#cb42-986" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-987"><a href="#cb42-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-988"><a href="#cb42-988" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gaussian White Noise </span></span>
<span id="cb42-989"><a href="#cb42-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-990"><a href="#cb42-990" aria-hidden="true" tabindex="-1"></a>If the process $\varepsilon$ is defined at $\varepsilon_t\sim N(0,\sigma^2)$ for $T=\R$, then $\boldsymbol \Gamma = \sigma^2\mathbf I$ and $\mathbf R = \mathbf I$.</span>
<span id="cb42-991"><a href="#cb42-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-992"><a href="#cb42-992" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-993"><a href="#cb42-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-994"><a href="#cb42-994" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-995"><a href="#cb42-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-996"><a href="#cb42-996" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random Walk </span></span>
<span id="cb42-997"><a href="#cb42-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-998"><a href="#cb42-998" aria-hidden="true" tabindex="-1"></a>Let $X$ be a random walk defined by $X_t = \sum_{i=1}^t Y_i$ for $Y_i \iid F_Y$ where $\mu = \E{Y}$ and $\sigma^2 = \var{Y}$. When $\mu \neq 0$ we have a random walk *with drift*, and $X_t$ can be rewritten as </span>
<span id="cb42-999"><a href="#cb42-999" aria-hidden="true" tabindex="-1"></a>$$X_t =  X_{t-1} + \mu + Y_t^*$$ where $Y_t^* = Y_t - \mu$ is shifted such that $\E{Y_t^*} = 0$. The expected value and variance of $X_t$ are</span>
<span id="cb42-1000"><a href="#cb42-1000" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1001"><a href="#cb42-1001" aria-hidden="true" tabindex="-1"></a>\E{X_t} &amp;= \E{\textstyle \sum_{i=1}^t Y_i}= \sum_{i=1}^t \E{Y_i} = \sum_{i=1}^t \mu = t\mu,<span class="sc">\\</span></span>
<span id="cb42-1002"><a href="#cb42-1002" aria-hidden="true" tabindex="-1"></a>\var{X_t} &amp;= \var{\textstyle \sum_{i=1}^t Y_i}= \sum_{i=1}^t \var{Y_i} = \sum_{i=1}^t \sigma^2 = t\sigma^2, </span>
<span id="cb42-1003"><a href="#cb42-1003" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-1004"><a href="#cb42-1004" aria-hidden="true" tabindex="-1"></a>since $Y_i$ are IID. We can use these two facts to calculate the autocovariance of $X$.^<span class="co">[</span><span class="ot">We'll calculate the autocovariance in a more "direct" fashion, but there are a few tricks that can employed such that things fall into place much quicker.</span><span class="co">]</span></span>
<span id="cb42-1005"><a href="#cb42-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1006"><a href="#cb42-1006" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1007"><a href="#cb42-1007" aria-hidden="true" tabindex="-1"></a>\cov{X_t, X_{t-j}} &amp; = \E{X_tX_{t-j}} - \E{X_t}\E{X_{t-j}}<span class="sc">\\</span></span>
<span id="cb42-1008"><a href="#cb42-1008" aria-hidden="true" tabindex="-1"></a>  &amp; = \E{\left(\textstyle\sum_{i=1}^t Y_i \right)X_{t-j}} - (t\mu)<span class="co">[</span><span class="ot">(t-j)\mu</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb42-1009"><a href="#cb42-1009" aria-hidden="true" tabindex="-1"></a>  &amp; = \E{\left(\textstyle\sum_{i=1}^{t-j} Y_i + \textstyle\sum_{i=t-j+1}^{t} Y_i \right)X_{t-j}} - (t\mu)<span class="co">[</span><span class="ot">(t-j)\mu</span><span class="co">]</span>2<span class="sc">\\</span></span>
<span id="cb42-1010"><a href="#cb42-1010" aria-hidden="true" tabindex="-1"></a>  &amp; = \E{\left(X_{t-j} + \textstyle\sum_{i=t-j+1}^{t} Y_i \right)X_{t-j}} - (t\mu)<span class="co">[</span><span class="ot">(t-j)\mu</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb42-1011"><a href="#cb42-1011" aria-hidden="true" tabindex="-1"></a>  &amp; = \E{X_{t-j}^2 + X_{t-j}\textstyle\sum_{i=t-j+1}^{t} Y_i} - (t\mu)<span class="co">[</span><span class="ot">(t-j)\mu</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb42-1012"><a href="#cb42-1012" aria-hidden="true" tabindex="-1"></a>  &amp; = \E{X_{t-j}^2} + \E{X_{t-j}\textstyle\sum_{i=t-j+1}^{t} Y_i}- (t\mu)<span class="co">[</span><span class="ot">(t-j)\mu</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb42-1013"><a href="#cb42-1013" aria-hidden="true" tabindex="-1"></a>  &amp; = \left(\var{X_{t-j}} + \E{X_{t-j}}^2\right) + \E{X_{t-j}}\textstyle\sum_{i=t-j+1}^{t} \E{Y_i}- (t\mu)<span class="co">[</span><span class="ot">(t-j)\mu</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb42-1014"><a href="#cb42-1014" aria-hidden="true" tabindex="-1"></a>  &amp; = <span class="co">[</span><span class="ot">(t-j)\sigma^2 + (t\mu)^2</span><span class="co">]</span> + t\mu\textstyle\sum_{i=t-j+1}^{t} \E{Y_i} - (t\mu)<span class="co">[</span><span class="ot">(t-j)\mu</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb42-1015"><a href="#cb42-1015" aria-hidden="true" tabindex="-1"></a>  &amp; = (t-j)\sigma^2 + t^2\mu^2 + t\mu\textstyle\sum_{i=t-j+1}^{t} \mu - t^2\mu^2 -tj\mu^2<span class="sc">\\</span></span>
<span id="cb42-1016"><a href="#cb42-1016" aria-hidden="true" tabindex="-1"></a>  &amp; = (t-j)\sigma^2 + t^2\mu^2 - t^2\mu^2 + t\mu(j\mu)  -tj\mu^2<span class="sc">\\</span></span>
<span id="cb42-1017"><a href="#cb42-1017" aria-hidden="true" tabindex="-1"></a>  &amp; = (t-j)\sigma^2 + \underbrace{t^2\mu^2 - t^2\mu^2}_0 + \underbrace{tj\mu^2  -tj\mu^2}_0<span class="sc">\\</span></span>
<span id="cb42-1018"><a href="#cb42-1018" aria-hidden="true" tabindex="-1"></a>  &amp; = (t-j)\sigma^2</span>
<span id="cb42-1019"><a href="#cb42-1019" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-1020"><a href="#cb42-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1021"><a href="#cb42-1021" aria-hidden="true" tabindex="-1"></a>Let's confirm our calculation by simulating 100,000 realizations of a random walk where $Y_i \sim N(1, 1)$ and $T=<span class="sc">\{</span>1,\cdots,5<span class="sc">\}</span>$. In this case the true autocovariance matrix is </span>
<span id="cb42-1022"><a href="#cb42-1022" aria-hidden="true" tabindex="-1"></a>$$ \boldsymbol\Gamma = \begin{bmatrix} 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1<span class="sc">\\</span></span>
<span id="cb42-1023"><a href="#cb42-1023" aria-hidden="true" tabindex="-1"></a>1 &amp; 2 &amp; 2 &amp; 2 &amp; 2<span class="sc">\\</span></span>
<span id="cb42-1024"><a href="#cb42-1024" aria-hidden="true" tabindex="-1"></a>1 &amp;2 &amp; 3 &amp; 3 &amp;3 <span class="sc">\\</span></span>
<span id="cb42-1025"><a href="#cb42-1025" aria-hidden="true" tabindex="-1"></a>1 &amp; 2 &amp;3 &amp;4 &amp; 4<span class="sc">\\</span></span>
<span id="cb42-1026"><a href="#cb42-1026" aria-hidden="true" tabindex="-1"></a>1 &amp; 2 &amp; 3&amp;4&amp;5</span>
<span id="cb42-1027"><a href="#cb42-1027" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}.$$</span>
<span id="cb42-1028"><a href="#cb42-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1031"><a href="#cb42-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1032"><a href="#cb42-1032" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_n_random_walk</span>(</span>
<span id="cb42-1033"><a href="#cb42-1033" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fl">1e5</span>, </span>
<span id="cb42-1034"><a href="#cb42-1034" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">5</span>, </span>
<span id="cb42-1035"><a href="#cb42-1035" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist =</span> rnorm, </span>
<span id="cb42-1036"><a href="#cb42-1036" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist_params =</span> <span class="fu">list</span>(</span>
<span id="cb42-1037"><a href="#cb42-1037" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="dv">1</span>, </span>
<span id="cb42-1038"><a href="#cb42-1038" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="dv">1</span></span>
<span id="cb42-1039"><a href="#cb42-1039" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-1040"><a href="#cb42-1040" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-1041"><a href="#cb42-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1042"><a href="#cb42-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1043"><a href="#cb42-1043" aria-hidden="true" tabindex="-1"></a>Now let's calculate the sample autocovariance matrix using our simulated values.</span>
<span id="cb42-1044"><a href="#cb42-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1047"><a href="#cb42-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1048"><a href="#cb42-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-1049"><a href="#cb42-1049" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates table"</span></span>
<span id="cb42-1050"><a href="#cb42-1050" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-1051"><a href="#cb42-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>step) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1052"><a href="#cb42-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> position, <span class="at">names_from =</span> time) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1053"><a href="#cb42-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb42-1054"><a href="#cb42-1054" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>iter_num,</span>
<span id="cb42-1055"><a href="#cb42-1055" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb42-1056"><a href="#cb42-1056" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1057"><a href="#cb42-1057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-1058"><a href="#cb42-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb42-1059"><a href="#cb42-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1060"><a href="#cb42-1060" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"X"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb42-1061"><a href="#cb42-1061" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"X"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb42-1062"><a href="#cb42-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1063"><a href="#cb42-1063" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb42-1064"><a href="#cb42-1064" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1065"><a href="#cb42-1065" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1066"><a href="#cb42-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1067"><a href="#cb42-1067" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-1068"><a href="#cb42-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1069"><a href="#cb42-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wiener Process</span></span>
<span id="cb42-1070"><a href="#cb42-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1071"><a href="#cb42-1071" aria-hidden="true" tabindex="-1"></a>If $W$ is a Wiener process, we've already shown that $$\cov{W_t, W_s} = \min<span class="sc">\{</span>s,t<span class="sc">\}</span>.$$ In the event we have $s\le t$ and write $s=t-j$ for some $j\in \R$, then $\min<span class="sc">\{</span>t, t-j<span class="sc">\}</span> = t - j$, giving </span>
<span id="cb42-1072"><a href="#cb42-1072" aria-hidden="true" tabindex="-1"></a>$$ \cov{W_t, W_{t-j}} = t-j.$$ Note that this is identical to the autocovariance of a random walk with unit variance. This is not at all a coincidence, and we'll return to this when considering asymptotics in the context of stochastic processes.</span>
<span id="cb42-1073"><a href="#cb42-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1074"><a href="#cb42-1074" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1075"><a href="#cb42-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1076"><a href="#cb42-1076" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stationarity </span></span>
<span id="cb42-1077"><a href="#cb42-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1078"><a href="#cb42-1078" aria-hidden="true" tabindex="-1"></a>Many phenomenon in the world can be modeled with stochastic processes, so they arise in statistics quite often (whether explicitly or implicitly). Unfortunately, in many of these settings we face a fundamental "missing data" problem. It's often *impossible* to observe more than one realization of a stochastic process. For example, we may think of the price of gas over time as a stochastic process $P$. We can collect data for gas prices over time, giving $P_1, P_2,\ldots$, but we're really observing the same realization of a stochastic process evaluated at different points in time. The only way we could observe another realization of $P$ is if we had access to a multidimensional universe where we could look at the progression of gas prices over time in many different universes! How can we possibly hope do anything useful with data if we have a sample size of 1? The solution comes in the form of assuming a stochastic process exhibits certain convenient properties. The first of these is stationary. </span>
<span id="cb42-1079"><a href="#cb42-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1080"><a href="#cb42-1080" aria-hidden="true" tabindex="-1"></a><span class="in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; As the name implies, stationary essentially means that a stochastic process "stays in one place" over the course of time. We can formalize this by appealing to the joint distribution of a process evaluated at multiple points in time. </span></span>
<span id="cb42-1081"><a href="#cb42-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1082"><a href="#cb42-1082" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb42-1083"><a href="#cb42-1083" aria-hidden="true" tabindex="-1"></a>Let $X = <span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in  T}$ be a stochastic process over the state space $\R$ where $T\subseteq \R$. The process $X$ is <span class="co">[</span><span class="ot">***strictly stationary***</span><span class="co">]</span>{style="color:red"} if </span>
<span id="cb42-1084"><a href="#cb42-1084" aria-hidden="true" tabindex="-1"></a>$$ F_{(X_{t_1},\ldots,X_{t_n})}(x_{t_1},\ldots,x_{t_n}) = F_{(X_{t_1}+ \tau,\ldots,X_{t_n}+ \tau)}(x_{t_1} + \tau,\ldots,x_{t_n}+ \tau)$$ for all $t_{1},\ldots, t_n\in T$ and $\tau \in \R$.</span>
<span id="cb42-1085"><a href="#cb42-1085" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1086"><a href="#cb42-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1087"><a href="#cb42-1087" aria-hidden="true" tabindex="-1"></a>Strict stationarity says that the distribution of $X$ evaluated at a finite collection of times only depends on the relative position of the times. If we were to translate $t_1,\ldots,t_n$ by some $\tau$, we would end up with the same distribution!</span>
<span id="cb42-1088"><a href="#cb42-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1089"><a href="#cb42-1089" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-1090"><a href="#cb42-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1091"><a href="#cb42-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">## Process of IID Variables</span></span>
<span id="cb42-1092"><a href="#cb42-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1093"><a href="#cb42-1093" aria-hidden="true" tabindex="-1"></a>Suppose we have some process $X(t)$ defined as $X_t\iid F_X$. Since the process is defined via an IID sequence of random variables it is strictly stationary. </span>
<span id="cb42-1094"><a href="#cb42-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1095"><a href="#cb42-1095" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1096"><a href="#cb42-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1097"><a href="#cb42-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1098"><a href="#cb42-1098" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-1099"><a href="#cb42-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1100"><a href="#cb42-1100" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gaussian White Noise</span></span>
<span id="cb42-1101"><a href="#cb42-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1102"><a href="#cb42-1102" aria-hidden="true" tabindex="-1"></a>The process $\varepsilon$ defined by $\varepsilon_t\sim N(0,\sigma^2)$ is strictly stationary by virtue of it being an IID sequence of random variables. </span>
<span id="cb42-1103"><a href="#cb42-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1104"><a href="#cb42-1104" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1105"><a href="#cb42-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1106"><a href="#cb42-1106" aria-hidden="true" tabindex="-1"></a>Strict stationarity is a very strong condition since it requires a distribution itself to obey a specific property. It can be weakened by appealing only to the moments of a distribution (which still have some bearing on the "shape" and "evolution" of a process).  </span>
<span id="cb42-1107"><a href="#cb42-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1108"><a href="#cb42-1108" aria-hidden="true" tabindex="-1"></a>:::{#def-}</span>
<span id="cb42-1109"><a href="#cb42-1109" aria-hidden="true" tabindex="-1"></a>Let $X = <span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in  T}$ be a stochastic process over the state space $\R$ where $T\subseteq \R$. The process $X$ is <span class="co">[</span><span class="ot">***covariance/weakly stationary***</span><span class="co">]</span>{style="color:red"} if </span>
<span id="cb42-1110"><a href="#cb42-1110" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1111"><a href="#cb42-1111" aria-hidden="true" tabindex="-1"></a>\E{X_t} &amp;= \mu &amp; \forall t \in T,<span class="sc">\\</span></span>
<span id="cb42-1112"><a href="#cb42-1112" aria-hidden="true" tabindex="-1"></a>\cov{X_t, X_{t-j}} &amp; = \gamma_j &amp;\forall t,t-j\in T.</span>
<span id="cb42-1113"><a href="#cb42-1113" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-1114"><a href="#cb42-1114" aria-hidden="true" tabindex="-1"></a>In other words, neither the expected value nor the autocovariance depend on the time $t$, and the latter is only a function of $j$. </span>
<span id="cb42-1115"><a href="#cb42-1115" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1116"><a href="#cb42-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1117"><a href="#cb42-1117" aria-hidden="true" tabindex="-1"></a>The key property of a covariance stationary process involves the autocovariance. The particular time $t$ is completely moot. The only thing that has any bearing on the autocovariance is the relative distance $j$ between two time intervals. This also simplifies the notation around autocovariance a great deal as we can eliminate any reference to $t$. </span>
<span id="cb42-1118"><a href="#cb42-1118" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1119"><a href="#cb42-1119" aria-hidden="true" tabindex="-1"></a>\boldsymbol \Gamma &amp;= \begin{bmatrix}</span>
<span id="cb42-1120"><a href="#cb42-1120" aria-hidden="true" tabindex="-1"></a>\gamma_{0} &amp; \gamma_{1} &amp; \gamma_{2} &amp; \cdots &amp; \gamma_{j}<span class="sc">\\</span></span>
<span id="cb42-1121"><a href="#cb42-1121" aria-hidden="true" tabindex="-1"></a>\gamma_{1} &amp; \gamma_{0} &amp; \gamma_{1} &amp; \cdots &amp; \gamma_{j-1}<span class="sc">\\</span></span>
<span id="cb42-1122"><a href="#cb42-1122" aria-hidden="true" tabindex="-1"></a>\gamma_{2} &amp; \gamma_{1} &amp; \gamma_{0} &amp; \cdots &amp; \gamma_{j-2}<span class="sc">\\</span></span>
<span id="cb42-1123"><a href="#cb42-1123" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span> </span>
<span id="cb42-1124"><a href="#cb42-1124" aria-hidden="true" tabindex="-1"></a>\gamma_{j} &amp; \gamma_{j-1} &amp; \gamma_{j-2} &amp; \cdots &amp; \gamma_{0}</span>
<span id="cb42-1125"><a href="#cb42-1125" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb42-1126"><a href="#cb42-1126" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-1127"><a href="#cb42-1127" aria-hidden="true" tabindex="-1"></a>Another useful equality that arises from covariance stationarity is $\gamma_{-j}=\gamma_j$ since </span>
<span id="cb42-1128"><a href="#cb42-1128" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1129"><a href="#cb42-1129" aria-hidden="true" tabindex="-1"></a>\gamma_j = \cov{X_t, X_{t-j}} = \cov{X_{t-j}, X_t} = \cov{X_{t-j + j}, X_{t+j}} = \cov{X_{t}, X_{t-(-j)}} = \gamma_{-j}. </span>
<span id="cb42-1130"><a href="#cb42-1130" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-1131"><a href="#cb42-1131" aria-hidden="true" tabindex="-1"></a>The definition of autocorrelation also simplifies to </span>
<span id="cb42-1132"><a href="#cb42-1132" aria-hidden="true" tabindex="-1"></a>$$ \rho_j = \frac{\gamma_j}{\sqrt{\gamma_0}\sqrt{\gamma_0}} = \frac{\gamma_j}{\gamma_0}.$$ Furhtermore, the autocorrelation matrix simplifies to $\mathbf R = \gamma_0\boldsymbol\Gamma$.</span>
<span id="cb42-1133"><a href="#cb42-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1134"><a href="#cb42-1134" aria-hidden="true" tabindex="-1"></a>:::{#prp-}</span>
<span id="cb42-1135"><a href="#cb42-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1136"><a href="#cb42-1136" aria-hidden="true" tabindex="-1"></a><span class="fu">## Strictly Stationarity Implies Weak Stationarity</span></span>
<span id="cb42-1137"><a href="#cb42-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1138"><a href="#cb42-1138" aria-hidden="true" tabindex="-1"></a>Let $X = <span class="sc">\{</span>X_t<span class="sc">\}</span>_{t\in  T}$ be a stochastic process over the state space $\R$ where $T\subseteq \R$. If $X$ is strictly stationary, then it is weakly stationary</span>
<span id="cb42-1139"><a href="#cb42-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1140"><a href="#cb42-1140" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1141"><a href="#cb42-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1142"><a href="#cb42-1142" aria-hidden="true" tabindex="-1"></a>:::{.proof}</span>
<span id="cb42-1143"><a href="#cb42-1143" aria-hidden="true" tabindex="-1"></a>For any $t,t-j\in T$ we have $F_{X_t}(x_t) = F_{X_{t-j}}(x_{t-j})$, giving $\E{X_t} = \E{X_{t-j}}$. Since $T\subseteq \R$, we can write any $s\in T$ as $s=t-j$ for some $j\in \R$. This gives $\E{X_t} = \E{X_s}$ for all $s,t\in T$, so $\E{X_t}$ has a common value $\mu$ for all $t\in T$. By strict stationarity we have $$F_{(X_{t+\tau}, X_{t-j+\tau})}=F_{(X_{t}, X_{t-j})} $$ for all $\tau\in \R$, so $\cov{X_{t}, X_{t-j}} = \cov{X_{t+\tau}, X_{(t+\tau) - j}}$ for all $\tau \in \R$. Again, since we can write any element of $T$ in the form $t-j$, we have the desired result.</span>
<span id="cb42-1144"><a href="#cb42-1144" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1145"><a href="#cb42-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1146"><a href="#cb42-1146" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-1147"><a href="#cb42-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1148"><a href="#cb42-1148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random Walk is Not Covariance Stationary</span></span>
<span id="cb42-1149"><a href="#cb42-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1150"><a href="#cb42-1150" aria-hidden="true" tabindex="-1"></a>We showed that a random walk with drift has an autocovariance function of $\gamma_{tj} = (t-j)\sigma^2$. This is a function of $t$, so the process is not covariance stationary.</span>
<span id="cb42-1151"><a href="#cb42-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1152"><a href="#cb42-1152" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1153"><a href="#cb42-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1154"><a href="#cb42-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1155"><a href="#cb42-1155" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-1156"><a href="#cb42-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1157"><a href="#cb42-1157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wiener Process is Not Covariance Stationary</span></span>
<span id="cb42-1158"><a href="#cb42-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1159"><a href="#cb42-1159" aria-hidden="true" tabindex="-1"></a>Similar to the random walk, the Wiener process is not covariance stationary because $\gamma_{tj} = (t-j)\sigma^2$. What *are* stationary are the increments $W_{t}-W_{t-j}$ since $W_{t}-W_{t-j}\iid N(0,j)$. These increments happen to be strictly stationary and Gaussian.  </span>
<span id="cb42-1160"><a href="#cb42-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1161"><a href="#cb42-1161" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1162"><a href="#cb42-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1163"><a href="#cb42-1163" aria-hidden="true" tabindex="-1"></a>:::{#exm-}</span>
<span id="cb42-1164"><a href="#cb42-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1165"><a href="#cb42-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR1 Process </span></span>
<span id="cb42-1166"><a href="#cb42-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1167"><a href="#cb42-1167" aria-hidden="true" tabindex="-1"></a>Let's look at a classic stationary process that will play a very important role when we start talking about time series. We'll start with some Gaussian white noise $\varepsilon_t \sim N(0,\sigma^2)$ and two constants $c$ and $\phi$. We can use these to define the process $X_t$ recursively:</span>
<span id="cb42-1168"><a href="#cb42-1168" aria-hidden="true" tabindex="-1"></a>$$ X_t = c + \phi X_{t-1} + \varepsilon_t.$$ We refer to this process as an autoregressive process of order one (AR1), since the definition of $X_t$ resembles a regression equation with $X_t$ as the dependent variable and the lagged $X_{t-1}$ as the independent variable. Intuitively, the process $X$ has some "memory", as the value at $t$ is the previous value scaled with some white noise added. The definition of $X_t$ is also a difference equation that we can solve given the initial value of the process $X_0$. </span>
<span id="cb42-1169"><a href="#cb42-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1170"><a href="#cb42-1170" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1171"><a href="#cb42-1171" aria-hidden="true" tabindex="-1"></a> X_t &amp;= c + \phi X_{t-1} + \varepsilon_t<span class="sc">\\</span></span>
<span id="cb42-1172"><a href="#cb42-1172" aria-hidden="true" tabindex="-1"></a>  &amp;= c + \phi (c + \phi X_{t-2} + \varepsilon_{t-1}) + \varepsilon_{t} &amp; (X_{t-1} &amp;= c + \phi X_{t-2} + \varepsilon_{t-1})<span class="sc">\\</span></span>
<span id="cb42-1173"><a href="#cb42-1173" aria-hidden="true" tabindex="-1"></a>  &amp; = (c+\varepsilon_t) + \phi(c + \varepsilon_{t-1}) + \phi^2 X_{t-2}<span class="sc">\\</span></span>
<span id="cb42-1174"><a href="#cb42-1174" aria-hidden="true" tabindex="-1"></a>  &amp; =(c+\varepsilon_t) + \phi(c + \varepsilon_{t-1}) + \phi^2(c + \phi X_{t-3} + \varepsilon_{t-2}) &amp; (X_{t-2} &amp;= c + \phi X_{t-3} + \varepsilon_{t-2})<span class="sc">\\</span></span>
<span id="cb42-1175"><a href="#cb42-1175" aria-hidden="true" tabindex="-1"></a>  &amp; = (c+\varepsilon_t) + \phi(c + \varepsilon_{t-1}) + \phi^2(c + \varepsilon_{t-2}) + \phi^3 X_{t-3} <span class="sc">\\</span></span>
<span id="cb42-1176"><a href="#cb42-1176" aria-hidden="true" tabindex="-1"></a>  &amp; = \ldots <span class="sc">\\</span></span>
<span id="cb42-1177"><a href="#cb42-1177" aria-hidden="true" tabindex="-1"></a>  &amp; = (c+\varepsilon_t) + \phi(c + \varepsilon_{t-1}) + \phi^2(c + \varepsilon_{t-2}) + \phi^3(c + \varepsilon_{t-3}) + \ldots + \phi^{t-1}(c + \phi +X_0 + \varepsilon_1 ) <span class="sc">\\</span></span>
<span id="cb42-1178"><a href="#cb42-1178" aria-hidden="true" tabindex="-1"></a>  &amp; = \phi^tX_0 + c\sum_{j=0}^{t-1}\phi^j + \sum_{j=0}^{t-1}\phi^j\varepsilon_{t-j}</span>
<span id="cb42-1179"><a href="#cb42-1179" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-1180"><a href="#cb42-1180" aria-hidden="true" tabindex="-1"></a>Let's simulate some realizations of $X$ for $\phi = 0.5$, $c = 0$, $\sigma = 1$, and $X_0 = 0$.</span>
<span id="cb42-1181"><a href="#cb42-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1184"><a href="#cb42-1184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1185"><a href="#cb42-1185" aria-hidden="true" tabindex="-1"></a>ar1 <span class="ot">&lt;-</span> <span class="cf">function</span>(t, phi, c, sigma, initial_condition, s){</span>
<span id="cb42-1186"><a href="#cb42-1186" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(t, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma)</span>
<span id="cb42-1187"><a href="#cb42-1187" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-1188"><a href="#cb42-1188" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="dv">0</span><span class="sc">:</span>t,</span>
<span id="cb42-1189"><a href="#cb42-1189" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">accumulate</span>(<span class="dv">1</span><span class="sc">:</span>t, <span class="sc">~</span> c <span class="sc">+</span> phi <span class="sc">*</span> .x <span class="sc">+</span> u[.y], <span class="at">.init =</span> initial_condition),</span>
<span id="cb42-1190"><a href="#cb42-1190" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> s,</span>
<span id="cb42-1191"><a href="#cb42-1191" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma =</span> sigma,</span>
<span id="cb42-1192"><a href="#cb42-1192" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi =</span> phi,</span>
<span id="cb42-1193"><a href="#cb42-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">c =</span> c</span>
<span id="cb42-1194"><a href="#cb42-1194" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-1195"><a href="#cb42-1195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-1196"><a href="#cb42-1196" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1197"><a href="#cb42-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1198"><a href="#cb42-1198" aria-hidden="true" tabindex="-1"></a>draw_N_ar1 <span class="ot">&lt;-</span> <span class="cf">function</span>(N, t, phi, c, sigma, initial_condition){</span>
<span id="cb42-1199"><a href="#cb42-1199" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb42-1200"><a href="#cb42-1200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(ar1, <span class="at">t =</span> t, <span class="at">phi =</span> phi, <span class="at">c =</span> c, <span class="at">sigma =</span> sigma, <span class="at">initial_condition =</span> initial_condition) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1201"><a href="#cb42-1201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb42-1202"><a href="#cb42-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-1203"><a href="#cb42-1203" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1204"><a href="#cb42-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1205"><a href="#cb42-1205" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_N_ar1</span>(</span>
<span id="cb42-1206"><a href="#cb42-1206" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="dv">100</span>,</span>
<span id="cb42-1207"><a href="#cb42-1207" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> <span class="fl">0.5</span>,</span>
<span id="cb42-1208"><a href="#cb42-1208" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> <span class="dv">100</span>, </span>
<span id="cb42-1209"><a href="#cb42-1209" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="dv">0</span>, </span>
<span id="cb42-1210"><a href="#cb42-1210" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="dv">1</span>, </span>
<span id="cb42-1211"><a href="#cb42-1211" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_condition =</span> <span class="dv">0</span></span>
<span id="cb42-1212"><a href="#cb42-1212" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb42-1213"><a href="#cb42-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1214"><a href="#cb42-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1217"><a href="#cb42-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1218"><a href="#cb42-1218" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-1219"><a href="#cb42-1219" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot513</span></span>
<span id="cb42-1220"><a href="#cb42-1220" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-1221"><a href="#cb42-1221" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-1222"><a href="#cb42-1222" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-1223"><a href="#cb42-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of an AR1 process."</span></span>
<span id="cb42-1224"><a href="#cb42-1224" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-1225"><a href="#cb42-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb42-1226"><a href="#cb42-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1227"><a href="#cb42-1227" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-1228"><a href="#cb42-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb42-1229"><a href="#cb42-1229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb42-1230"><a href="#cb42-1230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-1231"><a href="#cb42-1231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span> </span>
<span id="cb42-1232"><a href="#cb42-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-1233"><a href="#cb42-1233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>)</span>
<span id="cb42-1234"><a href="#cb42-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1235"><a href="#cb42-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb42-1236"><a href="#cb42-1236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1237"><a href="#cb42-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1238"><a href="#cb42-1238" aria-hidden="true" tabindex="-1"></a>If we assume that $T$ is infinite, then we have </span>
<span id="cb42-1239"><a href="#cb42-1239" aria-hidden="true" tabindex="-1"></a>$$ X_t = \phi^tX_0 + c\sum_{j=0}^{\infty}\phi^j + \sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}.$$ At this point the behavior of $\phi$ becomes *very* important. If $|\phi|&lt;1$ then the middle term (which is a geometric series) will converge to $c<span class="co">[</span><span class="ot">1/(1-\phi)</span><span class="co">]</span>$ and $\phi^tX_0 \to 0$ giving</span>
<span id="cb42-1240"><a href="#cb42-1240" aria-hidden="true" tabindex="-1"></a>$$X_t = \frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}.$$ In the event $|\phi|&lt;1$ we will have the following moments:^[When calculating these moments we'll appeal a key equalities:</span>
<span id="cb42-1241"><a href="#cb42-1241" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1242"><a href="#cb42-1242" aria-hidden="true" tabindex="-1"></a> \E{\textstyle\sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}} &amp;= \sum_{j=0}^{\infty} \E{\phi^j\varepsilon_{t-j}}<span class="sc">\\</span></span>
<span id="cb42-1243"><a href="#cb42-1243" aria-hidden="true" tabindex="-1"></a>  \var{\textstyle\sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}} &amp;= \sum_{j=0}^{\infty} \var{\phi^j\varepsilon_{t-j}}<span class="sc">\\</span></span>
<span id="cb42-1244"><a href="#cb42-1244" aria-hidden="true" tabindex="-1"></a>\end{align*} For fans of real analysis, these equalities should raise eyebrows, as we're really interchanging the order of an infinite series and an integral. The monotone convergence theorem and dominated convergence theorem outline conditions under which this is permissible.]</span>
<span id="cb42-1245"><a href="#cb42-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1246"><a href="#cb42-1246" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1247"><a href="#cb42-1247" aria-hidden="true" tabindex="-1"></a>\E{X_t} &amp;= \E{\frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}} <span class="sc">\\</span></span>
<span id="cb42-1248"><a href="#cb42-1248" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j\E{\varepsilon_{t-j}} <span class="sc">\\</span></span>
<span id="cb42-1249"><a href="#cb42-1249" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j 0 <span class="sc">\\</span></span>
<span id="cb42-1250"><a href="#cb42-1250" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{c}{1-\phi} <span class="sc">\\</span></span>
<span id="cb42-1251"><a href="#cb42-1251" aria-hidden="true" tabindex="-1"></a>\var{X_t} &amp; = \var{ \frac{c}{1-\phi} + \sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}}<span class="sc">\\</span></span>
<span id="cb42-1252"><a href="#cb42-1252" aria-hidden="true" tabindex="-1"></a>&amp; = \var{\sum_{j=0}^{\infty}\phi^j\varepsilon_{t-j}}<span class="sc">\\</span> </span>
<span id="cb42-1253"><a href="#cb42-1253" aria-hidden="true" tabindex="-1"></a>&amp; = \sum_{j=0}^{\infty}\var{\phi^j\varepsilon_{t-j}}<span class="sc">\\</span></span>
<span id="cb42-1254"><a href="#cb42-1254" aria-hidden="true" tabindex="-1"></a>&amp; = \sum_{j=0}^{\infty}\phi^{2j}\var{\varepsilon_{t-j}}<span class="sc">\\</span></span>
<span id="cb42-1255"><a href="#cb42-1255" aria-hidden="true" tabindex="-1"></a>&amp; = \sum_{j=0}^{\infty}(\phi^{2})^j\sigma^2<span class="sc">\\</span></span>
<span id="cb42-1256"><a href="#cb42-1256" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\sigma^2}{1-\phi^2}<span class="sc">\\</span></span>
<span id="cb42-1257"><a href="#cb42-1257" aria-hidden="true" tabindex="-1"></a>\cov{X_t, X_{t-j}} &amp;=  \cov{(c + \phi c + \cdots + \phi^jc) + (\varepsilon_t + \phi\varepsilon_{t-1} + \cdots + \phi^j\varepsilon_{t-j}) + \phi^j X_{t-j}  ,X_{t-j}} <span class="sc">\\</span></span>
<span id="cb42-1258"><a href="#cb42-1258" aria-hidden="true" tabindex="-1"></a>&amp;=  \cov{(\varepsilon_t + \phi\varepsilon_{t-1} + \cdots + \phi^j\varepsilon_{t-j}) + \phi^j X_{t-j}  ,X_{t-j}} &amp; (\textstyle\sum_{k=0}^j \phi^kc\text{ constant})<span class="sc">\\</span></span>
<span id="cb42-1259"><a href="#cb42-1259" aria-hidden="true" tabindex="-1"></a>&amp; = \cov{\phi^j X_{t-j}, X_{t-j}} + \cov{ \varepsilon_t + \phi\varepsilon_{t-1} + \cdots + \phi^j\varepsilon_{t-j},  X_{t-j}}<span class="sc">\\</span> </span>
<span id="cb42-1260"><a href="#cb42-1260" aria-hidden="true" tabindex="-1"></a>&amp; = \cov{\phi^j X_{t-j}, X_{t-j}} &amp; (\textstyle\sum_{k=0}^j \phi^k\varepsilon_{t-k}\perp X_{t-j})<span class="sc">\\</span></span>
<span id="cb42-1261"><a href="#cb42-1261" aria-hidden="true" tabindex="-1"></a>&amp; = \phi^j \cov{X_{t-j}, X_{t-j}} <span class="sc">\\</span></span>
<span id="cb42-1262"><a href="#cb42-1262" aria-hidden="true" tabindex="-1"></a>&amp; = \phi^j \var{X_{t-j}}<span class="sc">\\</span></span>
<span id="cb42-1263"><a href="#cb42-1263" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\phi^j\sigma^2}{1-\phi^2}</span>
<span id="cb42-1264"><a href="#cb42-1264" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-1265"><a href="#cb42-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1266"><a href="#cb42-1266" aria-hidden="true" tabindex="-1"></a>Since $\cov{X_t, X_{t-j}}$ only depends on $j$ (oppossed to $t$ and $j$), and $\E{X_t}$ is constant over $t$, $X$ is covariance stationary. </span>
<span id="cb42-1267"><a href="#cb42-1267" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb42-1268"><a href="#cb42-1268" aria-hidden="true" tabindex="-1"></a>\mu &amp;= \frac{c}{1-\phi}<span class="sc">\\</span></span>
<span id="cb42-1269"><a href="#cb42-1269" aria-hidden="true" tabindex="-1"></a>\gamma_j &amp; = \frac{\phi^j\sigma^2}{1-\phi^2}</span>
<span id="cb42-1270"><a href="#cb42-1270" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb42-1271"><a href="#cb42-1271" aria-hidden="true" tabindex="-1"></a>The autocorrelation of $X$ is </span>
<span id="cb42-1272"><a href="#cb42-1272" aria-hidden="true" tabindex="-1"></a>$$ \rho_j = \frac{\frac{\phi^j\sigma^2}{1-\phi^2}}{\frac{\sigma^2}{1-\phi^2}} = \phi^j.$$</span>
<span id="cb42-1273"><a href="#cb42-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1274"><a href="#cb42-1274" aria-hidden="true" tabindex="-1"></a>The autocorrelation will decay geometrically as $j$ increases. This is evident by looking at the $\rho_j$ for various values of $\phi$. These types of figures are known as correlograms.</span>
<span id="cb42-1275"><a href="#cb42-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1278"><a href="#cb42-1278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1279"><a href="#cb42-1279" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-1280"><a href="#cb42-1280" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot514</span></span>
<span id="cb42-1281"><a href="#cb42-1281" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-1282"><a href="#cb42-1282" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-1283"><a href="#cb42-1283" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-1284"><a href="#cb42-1284" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "."</span></span>
<span id="cb42-1285"><a href="#cb42-1285" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-1286"><a href="#cb42-1286" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb42-1287"><a href="#cb42-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1288"><a href="#cb42-1288" aria-hidden="true" tabindex="-1"></a><span class="fu">expand_grid</span>(</span>
<span id="cb42-1289"><a href="#cb42-1289" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.75</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.25</span>, <span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>),</span>
<span id="cb42-1290"><a href="#cb42-1290" aria-hidden="true" tabindex="-1"></a>  <span class="at">j =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb42-1291"><a href="#cb42-1291" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1292"><a href="#cb42-1292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1293"><a href="#cb42-1293" aria-hidden="true" tabindex="-1"></a>    <span class="at">rho =</span> phi<span class="sc">^</span>j,</span>
<span id="cb42-1294"><a href="#cb42-1294" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi_neg =</span> <span class="fu">ifelse</span>(phi <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">"φ &lt; 0"</span>, <span class="st">"φ &gt;= 0"</span>),</span>
<span id="cb42-1295"><a href="#cb42-1295" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1296"><a href="#cb42-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(j, rho, <span class="at">color =</span> <span class="fu">as.factor</span>(phi))) <span class="sc">+</span></span>
<span id="cb42-1297"><a href="#cb42-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-1298"><a href="#cb42-1298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb42-1299"><a href="#cb42-1299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>phi_neg, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-1300"><a href="#cb42-1300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Relative Time, j"</span>, <span class="at">y =</span> <span class="st">"Autocorrelation, ρ"</span>, <span class="at">color =</span> <span class="st">"φ"</span>) <span class="sc">+</span></span>
<span id="cb42-1301"><a href="#cb42-1301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb42-1302"><a href="#cb42-1302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb42-1303"><a href="#cb42-1303" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1304"><a href="#cb42-1304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1305"><a href="#cb42-1305" aria-hidden="true" tabindex="-1"></a>The stationarity of $X$ hinges on the crucial assumption that $\abs{\phi} &lt;1$, otherwise the geometric series $\sum_{j=0}^{\infty}\phi^j$ diverges and we have an "explosive" AR1 process. </span>
<span id="cb42-1306"><a href="#cb42-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1309"><a href="#cb42-1309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1310"><a href="#cb42-1310" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_N_ar1</span>(</span>
<span id="cb42-1311"><a href="#cb42-1311" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="dv">100</span>,</span>
<span id="cb42-1312"><a href="#cb42-1312" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> <span class="fl">1.1</span>,</span>
<span id="cb42-1313"><a href="#cb42-1313" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> <span class="fl">1e2</span>, </span>
<span id="cb42-1314"><a href="#cb42-1314" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="dv">0</span>, </span>
<span id="cb42-1315"><a href="#cb42-1315" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="dv">1</span>, </span>
<span id="cb42-1316"><a href="#cb42-1316" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_condition =</span> <span class="dv">0</span></span>
<span id="cb42-1317"><a href="#cb42-1317" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb42-1318"><a href="#cb42-1318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1319"><a href="#cb42-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1322"><a href="#cb42-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1323"><a href="#cb42-1323" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-1324"><a href="#cb42-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot515</span></span>
<span id="cb42-1325"><a href="#cb42-1325" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-1326"><a href="#cb42-1326" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-1327"><a href="#cb42-1327" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-1328"><a href="#cb42-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "100 realizations of an explosive AR1 process with φ = 1.1."</span></span>
<span id="cb42-1329"><a href="#cb42-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show code which generates figure"</span></span>
<span id="cb42-1330"><a href="#cb42-1330" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb42-1331"><a href="#cb42-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1332"><a href="#cb42-1332" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-1333"><a href="#cb42-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb42-1334"><a href="#cb42-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> iter_num)) <span class="sc">+</span></span>
<span id="cb42-1335"><a href="#cb42-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-1336"><a href="#cb42-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(iter_num) <span class="sc">+</span> </span>
<span id="cb42-1337"><a href="#cb42-1337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-1338"><a href="#cb42-1338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Realizations Drawn: {closest_state}'</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Value"</span>)</span>
<span id="cb42-1339"><a href="#cb42-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1340"><a href="#cb42-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(plot, <span class="at">end_pause =</span> <span class="dv">30</span>)</span>
<span id="cb42-1341"><a href="#cb42-1341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1342"><a href="#cb42-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1343"><a href="#cb42-1343" aria-hidden="true" tabindex="-1"></a>Two special cases of the AR1 process worth mentioning arise when $\phi \in<span class="sc">\{</span>-1, 0, 1<span class="sc">\}</span>$. If $\phi = 0$ then </span>
<span id="cb42-1344"><a href="#cb42-1344" aria-hidden="true" tabindex="-1"></a>$$ X_t = c + 0\cdot X_{t-1} + \varepsilon_t = c + \varepsilon_t$$ which leaves us with Gaussian white noise shifted by some constant $c$. If $\phi = 1$, then the process actually becomes a random walk with drift. </span>
<span id="cb42-1345"><a href="#cb42-1345" aria-hidden="true" tabindex="-1"></a>$$X_t = \phi^tX_0 + c\sum_{j=0}^{t-1}\phi^j + \sum_{j=0}^{t-1}\phi^j\varepsilon_{t-j}</span>
<span id="cb42-1346"><a href="#cb42-1346" aria-hidden="true" tabindex="-1"></a> = X_0 + c\cdot\frac{t(t+1)}{2} + \sum_{j=0}^{t-1}\varepsilon_{t-j}$$</span>
<span id="cb42-1347"><a href="#cb42-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1348"><a href="#cb42-1348" aria-hidden="true" tabindex="-1"></a>Since $\varepsilon_t\iid N(0, \sigma^2)$, we have a random walk with Gaussian steps. A similar result arises where $\phi = -1$, but the signs differ slightly. The key takeaway from these two special cases is that they are consistent with the fact that $X$ is covariance stationary when $\abs{\phi}&lt;1$, since Gaussian white noise is covariance stationary, and random walks are not.  </span>
<span id="cb42-1349"><a href="#cb42-1349" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-1350"><a href="#cb42-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1351"><a href="#cb42-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ergodicity </span></span>
<span id="cb42-1352"><a href="#cb42-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1353"><a href="#cb42-1353" aria-hidden="true" tabindex="-1"></a>A second property that makes stochastic processes much easier to work with in statistical applications is ergodicity. Fully defining ergodicity, let alone understanding it fully, requires diving into the bowels of measure theory. Loosely speaking, ergodicity means that a stochastic process never gets "stuck" in one place and </span>
<span id="cb42-1354"><a href="#cb42-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1357"><a href="#cb42-1357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1358"><a href="#cb42-1358" aria-hidden="true" tabindex="-1"></a>ar1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, phi, t){</span>
<span id="cb42-1359"><a href="#cb42-1359" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb42-1360"><a href="#cb42-1360" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-1361"><a href="#cb42-1361" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb42-1362"><a href="#cb42-1362" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">accumulate</span>(<span class="dv">2</span><span class="sc">:</span>n, <span class="sc">~</span> phi <span class="sc">*</span> .x <span class="sc">+</span> u[.y], <span class="at">.init =</span> u[<span class="dv">1</span>]),</span>
<span id="cb42-1363"><a href="#cb42-1363" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter_num =</span> t</span>
<span id="cb42-1364"><a href="#cb42-1364" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-1365"><a href="#cb42-1365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-1366"><a href="#cb42-1366" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1367"><a href="#cb42-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1368"><a href="#cb42-1368" aria-hidden="true" tabindex="-1"></a>draw_N_ar1 <span class="ot">&lt;-</span> <span class="cf">function</span>(N, n, phi){</span>
<span id="cb42-1369"><a href="#cb42-1369" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="sc">%&gt;%</span> </span>
<span id="cb42-1370"><a href="#cb42-1370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(ar1, <span class="at">n =</span> n, <span class="at">phi =</span> phi) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1371"><a href="#cb42-1371" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb42-1372"><a href="#cb42-1372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb42-1373"><a href="#cb42-1373" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1374"><a href="#cb42-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1375"><a href="#cb42-1375" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">draw_N_ar1</span>(<span class="at">N =</span> <span class="fl">5e3</span>, <span class="at">n =</span> <span class="fl">5e3</span>, <span class="at">phi =</span> <span class="fl">0.5</span>)</span>
<span id="cb42-1376"><a href="#cb42-1376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1377"><a href="#cb42-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1378"><a href="#cb42-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1381"><a href="#cb42-1381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1382"><a href="#cb42-1382" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb42-1383"><a href="#cb42-1383" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-1384"><a href="#cb42-1384" aria-hidden="true" tabindex="-1"></a>fixed_i <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-1385"><a href="#cb42-1385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(iter_num <span class="sc">==</span><span class="dv">3</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1386"><a href="#cb42-1386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1387"><a href="#cb42-1387" aria-hidden="true" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">"t_to_infty"</span>,</span>
<span id="cb42-1388"><a href="#cb42-1388" aria-hidden="true" tabindex="-1"></a>    <span class="at">index =</span> time</span>
<span id="cb42-1389"><a href="#cb42-1389" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-1390"><a href="#cb42-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1391"><a href="#cb42-1391" aria-hidden="true" tabindex="-1"></a>fixed_t <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb42-1392"><a href="#cb42-1392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">==</span> <span class="fl">2.5e3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1393"><a href="#cb42-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1394"><a href="#cb42-1394" aria-hidden="true" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">"n_to_infty"</span>,</span>
<span id="cb42-1395"><a href="#cb42-1395" aria-hidden="true" tabindex="-1"></a>    <span class="at">index =</span> iter_num</span>
<span id="cb42-1396"><a href="#cb42-1396" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-1397"><a href="#cb42-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1398"><a href="#cb42-1398" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> fixed_i <span class="sc">%&gt;%</span> </span>
<span id="cb42-1399"><a href="#cb42-1399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb42-1400"><a href="#cb42-1400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb42-1401"><a href="#cb42-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> fixed_t, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb42-1402"><a href="#cb42-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb42-1403"><a href="#cb42-1403" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1404"><a href="#cb42-1404" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> fixed_i <span class="sc">%&gt;%</span> </span>
<span id="cb42-1405"><a href="#cb42-1405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb42-1406"><a href="#cb42-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"#4280FC"</span>) <span class="sc">+</span></span>
<span id="cb42-1407"><a href="#cb42-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb42-1408"><a href="#cb42-1408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Realizations of X_i(t) for Fixed t = 500"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb42-1409"><a href="#cb42-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1410"><a href="#cb42-1410" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> fixed_t <span class="sc">%&gt;%</span> </span>
<span id="cb42-1411"><a href="#cb42-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb42-1412"><a href="#cb42-1412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"#FC4242"</span>) <span class="sc">+</span></span>
<span id="cb42-1413"><a href="#cb42-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb42-1414"><a href="#cb42-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Realizations of X_i(t) for Fixed i = 1"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb42-1415"><a href="#cb42-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1416"><a href="#cb42-1416" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb42-1417"><a href="#cb42-1417" aria-hidden="true" tabindex="-1"></a>  plot1,</span>
<span id="cb42-1418"><a href="#cb42-1418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggarrange</span>(plot2, plot3, <span class="at">ncol =</span> <span class="dv">2</span>), </span>
<span id="cb42-1419"><a href="#cb42-1419" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb42-1420"><a href="#cb42-1420" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-1421"><a href="#cb42-1421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1422"><a href="#cb42-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1425"><a href="#cb42-1425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1426"><a href="#cb42-1426" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.7</span></span>
<span id="cb42-1427"><a href="#cb42-1427" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb42-1428"><a href="#cb42-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1429"><a href="#cb42-1429" aria-hidden="true" tabindex="-1"></a>fixed_i <span class="sc">%&gt;%</span> </span>
<span id="cb42-1430"><a href="#cb42-1430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(fixed_t) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1431"><a href="#cb42-1431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(g) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1432"><a href="#cb42-1432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(index) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1433"><a href="#cb42-1433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">cummean</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-1434"><a href="#cb42-1434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(index, value, <span class="at">color =</span> g)) <span class="sc">+</span> </span>
<span id="cb42-1435"><a href="#cb42-1435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb42-1436"><a href="#cb42-1436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span> </span>
<span id="cb42-1437"><a href="#cb42-1437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb42-1438"><a href="#cb42-1438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>